// ZIM js Interactive Media framework http://zimjs.com by Dan Zen http://danzen.com (c) 2018
// Also see http://zimjs.com/distill to minify only the functions in your app
// free to use - donations welcome of course! http://zimjs.com/donate

"undefined"==typeof zon&&(zon=!0),"undefined"==typeof zns&&(zns=!1);var zog=console.log.bind(console);function zid(e){return z_d("1"),document.getElementById(e)}function zss(e){if(z_d("2"),document.getElementById(e))return document.getElementById(e).style;zon&&zog("zim wrap - zss(): id not found")}function zgo(e,t,o,n,i,r){if(z_d("3"),!(zot(t)&&""!=t||"_self"==t)){var a="";return o&&(a+="width="+o+","),n&&(a+="height="+n+","),i&&(a+="fullscreen=yes,"),r&&(a+="modal=yes,alwaysRaised=yes"),window.open(e,t,a)}window.location.href=e}function zum(e){if(z_d("4"),!zot(e))return Number(String(e).replace(/[^\d\.\-]/g,""))}function zot(e){return null==e}function zop(e){z_d("5"),zot(e)||(e.stopImmediatePropagation&&e.stopImmediatePropagation(),window.event&&(window.event.cancelBubble=!0))}function zil(){z_d("6");var e=function(e){e||(e=event),e.keyCode&&32<=e.keyCode&&e.keyCode<=40&&e.preventDefault()},t=function(e){e||(e=event),e.preventDefault()},o=t;return window.addEventListener("keydown",e),window.addEventListener("wheel",t),window.addEventListener("DOMMouseScroll",o),[e,t,o]}function zet(i){return z_d("6.1"),new function(){var a=this;this.on=function(e,t){if(!(zot(i)||zot(e)||zot(t)))for(var o=a.tags,n=0;n<o.length;n++)o[n].addEventListener(e,t)},this.off=function(e,t){if(!(zot(i)||zot(e)||zot(t)))for(var o=a.tags,n=0;n<o.length;n++)o[n].removeEventListener(e,t)},Object.defineProperty(a,"tags",{get:function(){return zot(i)?[]:"string"==typeof i||i instanceof String?document.querySelectorAll(i):"string"==typeof i.innerHTML?[i]:[]},set:function(e){}}),this.css=function(e,t){for(var o=a.tags,n=0;n<o.length;n++)if(1==arguments.length&&e.constructor==={}.constructor)for(var i in e)o[n].style[i]=e[i];else{if(1==arguments.length)return a.tags[0].style[e];o[n].style[e]=t}},this.prop=function(e,t){if(!zot(e)){for(var o=a.tags,n=[],i=0;i<o.length;i++)if(zot(t))if(e.constructor==={}.constructor)for(var r in e)o[i][r]=e[r];else n.push(o[i][e]);else o[i][e]=t;return zot(t)?n:void 0}}}}function isDUO(e){return 1==e.length&&null!=e[0]&&e[0].constructor==={}.constructor}function zob(e,t,o,n){if(isDUO(t)){z_d("7");var i,r,a,s=t[0],l=zot(o)?e.toString().split(/\n/,1)[0].match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","):o.replace(/\s+/g,"").split(","),c=[];for(i=0;i<l.length;i++)r=l[i].split("=")[0],l[i]=r,c.push(s[r]);for(i in s)l.indexOf(i)<0&&zon&&zog(e,"bad argument "+i);return!(a=e.prototype.isPrototypeOf(n)?new(e.bind.apply(e,[null].concat(c))):e.apply(null,c))||a}}function zik(e){if(z_d("7.5"),!zot(e)){if(e.constructor==={}.constructor||Array.isArray(e)||"function"==typeof e){if(Array.isArray(e))return zik(e[Math.floor(Math.random()*e.length)]);if(e.constructor==={}.constructor)return zot(e.noZik)?zot(e.max)?e:(zot(e.integer)&&(e.integer=!1),zim.rand(e.min,e.max,e.integer,e.negative)):e.noZik;if("function"==typeof e)return zik(e())}return e}}var zta=console.table.bind(console);function z_d(e){zim&&(zim.DISTILL||window.DISTILL)&&zim.distillery.push(e)}function zimify(e,t){z_d("83.3");var o={drag:function(e,t,o,n,i,r,a,s,l,c,d,u,h,f,g){return isDUO(arguments)?(e.obj=this,zim.drag(e)):zim.drag(this,e,t,o,n,i,r,a,s,l,c,d,u,h,f,g)},noDrag:function(){return zim.noDrag(this)},dragBoundary:function(e){return zim.dragBoundary(this,e)},dragRect:function(e){return zim.dragBoundary(this,e)},transform:function(e,t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w){return isDUO(arguments)?(e.obj=this,zim.transform(e)):zim.transform(this,e,t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w)},setSwipe:function(e){return zim.setSwipe(this,e)},gesture:function(e,t,o,n,i,r,a,s,l,c,d,u,h,f,g){return isDUO(arguments)?(e.obj=this,zim.gesture(e)):zim.gesture(this,e,t,o,n,i,r,a,s,l,c,d,u,h,f,g)},noGesture:function(e,t,o){if(isDUO(arguments))return e.obj=this,zim.noGesture(e);zim.noGesture(this,e,t,o)},gestureBoundary:function(e,t){return zim.gestureBoundary(this,e,t)},gestureRect:function(e,t){return zim.gestureBoundary(this,e,t)},hitTestPoint:function(e,t,o){return zim.hitTestPoint(this,e,t,o)},hitTestReg:function(e,t){return zim.hitTestReg(this,e,t)},hitTestRect:function(e,t,o){return zim.hitTestRect(this,e,t,o)},hitTestCircle:function(e,t,o){return zim.hitTestCircle(this,e,t,o)},hitTestCircles:function(e,t){return zim.hitTestCircles(this,e,t)},hitTestBounds:function(e,t,o){return zim.hitTestBounds(this,e,t,o)},boundsToGlobal:function(e,t,o){return zim.boundsToGlobal(this,e,t,o)},resetBounds:function(e,t,o,n){return zim.resetBounds(this,e,t,o,n)},hitTestGrid:function(e,t,o,n,i,r,a,s,l,c,d,u){return zim.hitTestGrid(this,e,t,o,n,i,r,a,s,l,c,d,u)},animate:function(e,t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A,E,M,I,S,j,B,O,P,D){return isDUO(arguments)?(e.target=this,zim.animate(e)):zim.animate(this,e,t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A,E,M,I,S,j,B,O,P,D)},pauseAnimate:function(){return this},stopAnimate:function(){return this},wiggle:function(e,t,o,n,i,r,a,s,l,c,d,u,h){return isDUO(arguments)?(e.target=this,zim.wiggle(e)):zim.wiggle(this,e,t,o,n,i,r,a,s,l,c,d,u,h)},loop:function(e,t,o,n,i){return zim.loop(this,e,t,o,n,i)},copyMatrix:function(e){return zim.copyMatrix(this,e)},cur:function(e){return zim.cur(this,e)},sha:function(e,t,o,n){return zim.sha(this,e,t,o,n)},pos:function(e,t,o,n,i){return isDUO(arguments)?(e.obj=this,zim.pos(e)):zim.pos(this,e,t,o,n,i)},mov:function(e,t){return zim.mov(this,e,t)},top:function(){return zim.top(this)},bot:function(){return zim.bot(this)},dep:function(e){return zim.dep(this,e)},alp:function(e){return zim.alp(this,e)},rot:function(e){return zim.rot(this,e)},siz:function(e,t,o){return zim.siz(this,e,t,o)},ske:function(e,t){return zim.ske(this,e,t)},reg:function(e,t){return zim.reg(this,e,t)},sca:function(e,t){return zim.sca(this,e,t)},scaleTo:function(e,t,o,n,i){return isDUO(arguments)?(e.obj=this,zim.scaleTo(e)):zim.scaleTo(this,e,t,o,n,i)},fit:function(e,t,o,n,i){return isDUO(arguments)?(e.obj=this,zim.fit(e)):zim.fit(this,e,t,o,n,i)},outline:function(e,t){return isDUO(arguments)?(e.obj=this,zim.outline(e)):zim.outline(this,e,t)},addTo:function(e,t,o){return zim.addTo(this,e,t,o)},removeFrom:function(e){return zim.removeFrom(this,e)},added:function(e,t,o){return zim.added(this,e,t,o)},centerReg:function(e,t,o){return isDUO(arguments)?(e.obj=this,zim.centerReg(e)):zim.centerReg(this,e,t,o)},center:function(e,t,o){return isDUO(arguments)?(e.obj=this,zim.center(e)):zim.center(this,e,t,o)},place:function(e){return zim.place(this,e)},placeReg:function(e){return zim.placeReg(this,e)},expand:function(e,t){return zim.expand(this,e,t)},setMask:function(e,t){return zim.setMask(this,e,t)},cloneProps:function(e){return e.alpha=this.alpha,e.rotation=this.rotation,e.mouseEnabled=this.mouseEnabled,e.tickEnabled=this.tickEnabled,e.name=this.name,e.regX=this.regX,e.regY=this.regY,e.visible=this.visible,e.shadow=this.shadow,zim.copyMatrix(e,this),e.compositeOperation=this.compositeOperation,e.snapToPixel=this.snapToPixel,e.filters=null==this.filters?null:this.filters.slice(0),e.mask=this.mask,e.hitArea=this.hitArea,this._bounds&&e.setBounds(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height),e},cloneChildren:function(e){e.children.length&&e.removeAllChildren();for(var t=e.children,o=0,n=this.children.length;o<n;o++){var i=this.children[o].clone();i.parent=e,t.push(i)}return e}};if(!zot(t)){t=[];for(var n in o)t.push(n);return t}for(var i in o)o.hasOwnProperty(i)&&(e[i]=o[i]);return Object.defineProperty(e,"width",{enumerable:!0,get:function(){var e=this.getBounds();return zot(e)?null:e.width*this.scaleX},set:function(e){var t=this.getBounds();if(zot(t)||0==t.width)zog("width needs bounds set with setBounds()");else{var o=e/t.width;this.scaleX=this.scaleY=o}}}),Object.defineProperty(e,"height",{enumerable:!0,get:function(){var e=this.getBounds();return zot(e)?null:e.height*this.scaleY},set:function(e){var t=this.getBounds();if(zot(t)||0==t.height)zog("height needs bounds set with setBounds()");else{var o=e/t.height;this.scaleX=this.scaleY=o}}}),Object.defineProperty(e,"widthOnly",{enumerable:!0,get:function(){var e=this.getBounds();return zot(e)?null:e.width*this.scaleX},set:function(e){var t=this.getBounds();if(zot(t)||0==t.width)zog("widthOnly needs bounds set with setBounds()");else{var o=e/t.width;this.scaleX=o}}}),Object.defineProperty(e,"heightOnly",{enumerable:!0,get:function(){var e=this.getBounds();return zot(e)?null:e.height*this.scaleY},set:function(e){var t=this.getBounds();if(zot(t)||0==t.height)zog("heightOnly needs bounds set with setBounds()");else{var o=e/t.height;this.scaleY=o}}}),Object.defineProperty(e,"depth",{enumerable:!0,get:function(){return this._depth},set:function(e){if(this._depth=e,!zot(this.vrChannel)){var t=this.vrParallaxDistance?e*this.vrParallax*this.vrParallaxDistance:0;"left"==this.vrChannel?this.x=this.vrStartX+e+t:"right"==this.vrChannel&&(this.x=this.vrStartX-e+t)}}}),Object.defineProperty(e,"blendMode",{enumerable:!0,get:function(){return this.compositeOperation},set:function(e){this.compositeOperation=e}}),e}function zimplify(e){z_d("83.35"),document.Window=Window,document.Blob=Blob,zot(e)&&(e=[]),Array.isArray(e)||(e=[e]);var t=zimify(null,!0),o=["loop","stopAnimate","pauseAnimate","animate","wiggle"];for(var n in zim)(-1==t.indexOf(n)||0<=o.indexOf(n))&&-1==e.indexOf(n)&&(window[n]=zim[n])}var zim=function(m){return m.Wonder=function(n,i,r,a,e){var t;if(t=zob(m.Wonder,arguments,"wid, client, app, notes, server",this))return t;if(z_d("82"),zot(n))zog("zim.Wonder() - please provide Wonder ID (see http://zimjs.com/wonder/)");else{zot(e)&&(e="http://54.237.229.197:3001/wonder");var o=this;zot(m.wonderSession)&&(m.wonderSession="W"+m.rand(1e5,999999));var s,l=[],c=setInterval(g,1e3),d=0,u=setInterval(function(){28<d&&(l.push({id:n,c:i,a:r,n:a,k:s,t:"e",v:"frequency max - terminated",s:m.wonderSession}),zog("zim.Wonder() - frequency max - terminated"),o.dispose()),d=0},3e4);this.countsOff={},this.timesOff={},this.ordersOff={},this.count=function(e){p(e,"count")&&(s=e,l.push({id:n,c:i,a:r,n:a,k:e,t:"c",v:1,s:m.wonderSession}))};var h={};this.timeStart=function(e){p(e,"time")&&(o.timeEnd(e),h[s=e]=(new Date).getTime())};var f={};this.timePause=function(e){p(e,"time")&&(f[e]||(f[e]=(new Date).getTime()))},this.timeUnpause=function(e){if(p(e,"time")&&f[e]){var t=(new Date).getTime()-f[e];h[e]&&(h[e]+=t),delete f[e]}},this.timeEnd=function(e){if(p(e,"time")&&h[e]){var t=f[e]?f[e]:(new Date).getTime(),o=Math.round((t-h[e])/1e3);delete f[e],delete h[e],l.push({id:n,c:i,a:r,n:a,k:e,t:"t",v:o,s:m.wonderSession})}},this.order=function(e,t){p(e,"order")&&(s=e,zot(t)?zog("zim.Wonder order() - please provide an item"):l.push({id:n,c:i,a:r,n:a,k:e,t:"o",v:t,s:m.wonderSession}))},this.countOff=function(e){o.countsOff[e]=1},this.countOn=function(e){delete o.countOff[e]},this.timeOff=function(e){o.timesOff[e]=1},this.timeOn=function(e){delete o.timesOff[e]},this.orderOff=function(e){o.ordersOff[e]=1},this.orderOn=function(e){delete o.ordersOff[e]},this.dispose=function(){return g(),clearInterval(c),clearInterval(u),!0}}function g(){0<l.length&&(m.async(e+"?wonder="+JSON.stringify(l)),l=[],d++)}function p(e,t){return zot(e)?(zog("zim.Wonder "+t+" - please provide a keyword"),!1):!o[t+"sOff"][e]}},m}((zim=function(Je){if(Je.orange="#f58e25",Je.green="#acd241",Je.pink="#e472c4",Je.blue="#50c4b7",Je.brown="#d1a170",Je.yellow="#ebcb35",Je.purple="#993399",Je.red="#fb4758",Je.silver="#999999",Je.tin="#777777",Je.grey="#555555",Je.gray="#555555",Je.lighter="#eeeeee",Je.light="#cccccc",Je.dark="#333333",Je.darker="#111111",Je.black="#000000",Je.white="#ffffff",Je.clear="rgba(0,0,0,0)",Je.faint="rgba(0,0,0,.01)",Je.shuffle=function(e){if(z_d("8"),!zot(e)){var t,o,n=e.length;if(0==n)return e;for(;--n;)t=Math.floor(Math.random()*(n+1)),o=e[n],e[n]=e[t],e[t]=o;return e}},Je.rand=function(e,t,o,n){return z_d("9"),zot(e)&&zot(t)?Math.random():((zot(e)||isNaN(e))&&(e=0),(zot(t)||isNaN(t))&&(t=0),e%1==0&&t%1==0||(o=!1),zot(o)&&(o=!0),n&&.5<Math.random()&&(e*=-1,t*=-1),o&&(t<e?e++:e<t&&t++),0==e&&0==t?0:(i=0==t?Math.random()*e:Math.min(e,t)+Math.random()*(Math.max(e,t)-Math.min(e,t)),o?Math.floor(i):i));var i},Je.loop=function(e,t,o,n,i,r){var a;if(a=zob(Je.loop,arguments,"obj, call, reverse, step, start, end"))return a;if(z_d("9.5"),!zot(e)&&!zot(t)){zot(o)&&(o=!1),(zot(n)||n<=0)&&(n=1);var s="number"==typeof e?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":"invalid";if("invalid"!=s)if("number"==s||"array"==s||"nodelist"==s){if(0==(d=f((u="number"==s?e:e.length)-1)))return;if(o)for(var l=i;r<=l;l-=n){if("number"==s)var c=t(l,d,i,r,e);else if("array"==s)c=t(e[l],l,d,i,r,e);else c=t(e.item(l),l,d,i,r,e);if(void 0!==c)return c}else for(l=i;l<=r;l+=n){if("number"==s)c=t(l,d,i,r,e);else if("array"==s)c=t(e[l],l,d,i,r,e);else c=t(e.item(l),l,d,i,r,e);if(void 0!==c)return c}}else if("object"==s){var d,u=0,h=[];for(var l in e)u++,h.push(l);if(0==(d=f(u-1)))return;if(o)for(l=i;r<=l;l-=n){if(void 0!==(c=t(h[l],e[h[l]],l,d,i,r,e)))return c}else for(l=i;l<=r;l+=n){if(void 0!==(c=t(h[l],e[h[l]],l,d,i,r,e)))return c}}}function f(e){return zot(i)&&(i=o?e:0),zot(r)&&(r=o?0:e),o&&i<r||!o&&r<i?0:(i<0&&r)<0||e<i&&e<r?0:(i=Math.max(0,Math.min(i,e)),r=Math.max(0,Math.min(r,e)),Math.floor((o?i-r:r-i)/n)+1)}},Je.timeout=function(t,o){if(z_d("9.7"),!zot(o)&&"function"==typeof o){zot(t)&&(t=1e3),t=zik(t);var n={startTime:Date.now(),time:0,paused:!1,done:!1},i=n.startTime;return n.pause=function(e){zot(e)&&(e=!0),e?cancelAnimationFrame(n.rid):(i=Date.now(),r()),n.paused=e},n.clear=function(){for(var e in n&&cancelAnimationFrame(n.rid),n)delete n[e];n.pause=function(){},n.clear=function(){}},r(),n}function r(){var e=Date.now();if(n.time+=e-i,i=e,n.time>=t)return n.done=!0,o(n),void n.clear();n.rid=requestAnimationFrame(r)}},Je.interval=function(e,o,t,n){if(z_d("9.8"),!zot(o)&&"function"==typeof o&&(zot(e)&&(e=1e3),zot(n)&&(n=!1),zot(t)||!(isNaN(t)||t<=0))){zot(t)&&(t=-1);var i,r={count:0,total:t,paused:!1,time:e,active:!0};return n&&setTimeout(function(){o(r),s()},10),r.pause=function(e,t){zot(e)&&(e=!0),e?(clearTimeout(i),clearTimeout(r.id),cancelAnimationFrame(r.rid),r.pauseTimeLeft=r.interval-(Date.now()-r.startTime)):(i=setTimeout(function(){r.count++,o(r),a(),s()},t?0:r.pauseTimeLeft),r.pauseTimeLeft=null),r.paused=e},r.clear=function(){r.active=!1,clearTimeout(i),cancelAnimationFrame(r.rid),clearTimeout(r.id);var e=r.count;for(var t in r)delete r[t];r.active=!1,r.count=e,r.pause=function(){},r.clear=function(){}},a(),r}function a(){r.startTime=Date.now(),r.interval=zik(r.time),r.id=setTimeout(function(){r.paused||r.active&&(r.rid=requestAnimationFrame(a),r.count++,o(r),s())},r.interval)}function s(){-1!=t&&r.count>=(n?r.total-1:r.total)&&r.clear()}},Je.copy=function(e,t){if(z_d("10"),zot(t)&&(t=!1),null==e||!(e instanceof Array||e.constructor=={}.constructor))return t&&e.clone?e.clone():e;if(e instanceof Array){for(var o=[],n=0;n<e.length;n++)o[n]=Je.copy(e[n],t);return o}if(e.constructor=={}.constructor){var i={};for(var r in e){var a=Je.copy(e[r],t);e.hasOwnProperty(r)&&(i[r]=a)}return i}},Je.arraysEqual=function(e,t,o){if(z_d("11"),zot(e)||zot(t))return!1;if(zot(o)&&(o=!0),e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]instanceof Array&&t[n]instanceof Array){if(!Je.arraysEqual(e[n],t[n],o))return!1}else{if(o&&e[n]!=t[n])return!1;if(!o)return Je.arraysEqual(e.sort(),t.sort(),!0)}return!0},Je.isEmpty=function(e){if(z_d("11.5"),!zot(e)){var t=0;for(var o in e){t++;break}return 0==t}},Je.isJSON=function(e){z_d("11.6");try{return JSON.parse(e).constructor=={}.constructor}catch(e){return!1}},Je.merge=function(){z_d("12");var e,t,o={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&(o[t]=arguments[e][t]);return o},Je.zut=function(e){if(zot(e)||"object"==typeof e)return!0},Je.decimals=function(e,t,o,n,i,r,a){if(z_d("13"),zot(e))return 0;zot(t)&&(t=1),zot(o)&&(o=0),zot(n)&&(n=0),zot(n)&&(n=0),zot(i)&&(i=!0),zot(r)&&(r=!1);var s=Math.round(e*Math.pow(10,t))/Math.pow(10,t),l=Je.sign(s);if(0<o){var c=String(s).indexOf("."),d=String(s).length;c<0&&(c=d++,s+=".");for(var u=0;u<o-(d-c-1);u++)s+="0"}if(0<n){-1==l&&(s=s.substr(1,s.length-1));c=String(s).indexOf("."),d=String(s).length;var h=c<0?d:c;for(u=0;u<n-h;u++)s="0"+s;-1==l&&(s="-"+s)}return 0<o+n&&!i&&0==Number(s)&&(s=0),r&&(s=String(s).replace(".",":")),Je.zut(a)?s:null},Je.sign=function(e){return z_d("13.1"),e?e<0?-1:1:0},Je.constrain=function(e,t,o,n){if(z_d("13.2"),!zot(e))return zot(t)&&(t=0),zot(o)&&(o=Number.MAX_VALUE),o<t&&(o=max2=t,t=max2),zot(n)&&(n=!1),n&&e<0?Math.max(-o,Math.min(e,-t)):Math.max(t,Math.min(e,o))},Je.dist=function(e,t,o,n){if(z_d("13.3"),!zot(e)&&!zot(t))return zot(o)&&(o=0),zot(n)&&(n=0),Math.sqrt(Math.pow(o-e,2)+Math.pow(n-t,2))},Je.angle=function(e,t,o,n){if(z_d("13.4"),!zot(e)&&!zot(t))return zot(o)&&(o=e,e=0),zot(n)&&(n=t,t=0),(180*Math.atan2(n-t,o-e)/Math.PI+360)%360},Je.Point=function(e,t,o,n){z_d("13.45"),zot(e)&&(e=0),zot(t)&&(t=0),zot(o)&&(o=0),zot(n)&&(n=0),this.x=e,this.y=t,this.z=o,this.w=n},Je.Boundary=function(e,t,o,n){z_d("13.46"),zot(e)||zot(t)||zot(o)||zot(n)||(this.x=e,this.y=t,this.width=o,this.height=n,this.contract=function(e,t,o,n){return zot(e)||(zot(t)&&(t=e),zot(o)?o=2*e:o+=e,zot(n)?n=2*t:n+=t,this.x+=e,this.y+=t,this.width-=o,this.height-=n),this})},Je.makeID=function(e,t,o){var n;z_d("13.5"),zot(e)&&(e="mixed"),zot(t)&&(t=5),zot(o)&&(o="uppercase");var i=[2,3,4,5,6,7,8,9],r="abcdefghjkmnpqrstuvwxyz".split("");n=e.constructor===Array?e:"numbers"==e?i:"letters"==e?r:i.concat(r);for(var a,s,l="",c=0;c<t;c++)a=n[Math.floor(Math.random()*n.length)],s=Math.random(),"uppercase"==o||"mixed"==o&&.5<s?a.toUpperCase&&(a=a.toUpperCase()):a.toLowerCase&&(a=a.toLowerCase()),l+=String(a);return l},Je.makeSeries=function(e){if(z_d("13.6"),zot(e))return function(){};var t=0,o=function(){return e[t++%e.length]};return o.array=e,o},Je.smoothStep=function(e,t,o){z_d("13.7");var n=Je.constrain((e-t)/(o-t),0,1);return n*n*n*(n*(6*n-15)+10)},Je.Noise=function(e){"use strict";z_d("13.9"),zot(e)&&(e=1e6*Math.random());var t=e;this.seed=e;var W=this,N={};function o(e){var t=new Uint32Array(1);return t[0]=1664525*e[0]+1013904223,t}function n(e,t,o){this.dx=-t-e*N.SQUISH_2D,this.dy=-o-e*N.SQUISH_2D,this.xsb=t,this.ysb=o}function i(e,t,o,n){this.dx=-t-e*N.SQUISH_3D,this.dy=-o-e*N.SQUISH_3D,this.dz=-n-e*N.SQUISH_3D,this.xsb=t,this.ysb=o,this.zsb=n}function r(e,t,o,n,i){this.dx=-t-e*N.SQUISH_4D,this.dy=-o-e*N.SQUISH_4D,this.dz=-n-e*N.SQUISH_4D,this.dw=-i-e*N.SQUISH_4D,this.xsb=t,this.ysb=o,this.zsb=n,this.wsb=i}N.NORM_2D=1/47,N.NORM_3D=1/103,N.NORM_4D=1/30,N.SQUISH_2D=(Math.sqrt(3)-1)/2,N.SQUISH_3D=(Math.sqrt(4)-1)/3,N.SQUISH_4D=(Math.sqrt(5)-1)/4,N.STRETCH_2D=(1/Math.sqrt(3)-1)/2,N.STRETCH_3D=(1/Math.sqrt(4)-1)/3,N.STRETCH_4D=(1/Math.sqrt(5)-1)/4,N.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],N.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],N.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],N.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],N.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],N.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],N.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],N.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],N.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],N.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],N.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],N.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];for(var a=[],s=0;s<N.p2D.length;s+=4){for(var l=N.base2D[N.p2D[s]],c=null,d=null,u=0;u<l.length;u+=3)d=new n(l[u],l[u+1],l[u+2]),null===c?a[s/4]=d:c.next=d,c=d;d.next=new n(N.p2D[s+1],N.p2D[s+2],N.p2D[s+3])}this.lookup2D=[];for(s=0;s<N.lookupPairs2D.length;s+=2)this.lookup2D[N.lookupPairs2D[s]]=a[N.lookupPairs2D[s+1]];var h=[];for(s=0;s<N.p3D.length;s+=9){for(l=N.base3D[N.p3D[s]],c=null,d=null,u=0;u<l.length;u+=4)d=new i(l[u],l[u+1],l[u+2],l[u+3]),null===c?h[s/9]=d:c.next=d,c=d;d.next=new i(N.p3D[s+1],N.p3D[s+2],N.p3D[s+3],N.p3D[s+4]),d.next.next=new i(N.p3D[s+5],N.p3D[s+6],N.p3D[s+7],N.p3D[s+8])}this.lookup3D=[];for(s=0;s<N.lookupPairs3D.length;s+=2)this.lookup3D[N.lookupPairs3D[s]]=h[N.lookupPairs3D[s+1]];var f=[];for(s=0;s<N.p4D.length;s+=16){for(l=N.base4D[N.p4D[s]],c=null,d=null,u=0;u<l.length;u+=5)d=new r(l[u],l[u+1],l[u+2],l[u+3],l[u+4]),null===c?f[s/16]=d:c.next=d,c=d;d.next=new r(N.p4D[s+1],N.p4D[s+2],N.p4D[s+3],N.p4D[s+4],N.p4D[s+5]),d.next.next=new r(N.p4D[s+6],N.p4D[s+7],N.p4D[s+8],N.p4D[s+9],N.p4D[s+10]),d.next.next.next=new r(N.p4D[s+11],N.p4D[s+12],N.p4D[s+13],N.p4D[s+14],N.p4D[s+15])}this.lookup4D=[];for(s=0;s<N.lookupPairs4D.length;s+=2)this.lookup4D[N.lookupPairs4D[s]]=f[N.lookupPairs4D[s+1]];this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);var g=new Uint8Array(256);for(s=0;s<256;s++)g[s]=s;(e=new Uint32Array(1))[0]=t,e=o(o(o(e)));for(s=255;0<=s;s--){e=o(e);var p=new Uint32Array(1);p[0]=(e[0]+31)%(s+1),p[0]<0&&(p[0]+=s+1),this.perm[s]=g[p[0]],this.perm2D[s]=14&this.perm[s],this.perm3D[s]=this.perm[s]%24*3,this.perm4D[s]=252&this.perm[s],g[p[0]]=g[s]}this.simplex1D=function(e){return W.simplex2D(e,1)},this.simplex2D=function(e,t){var o=(e+t)*N.STRETCH_2D,n=[e+o,t+o],i=n[0],r=n[1],a=[Math.floor(i),Math.floor(r)],s=a[0],l=a[1],c=(s+l)*N.SQUISH_2D,d=[e-(s+c),t-(l+c)],u=d[0],h=d[1],f=[i-s,r-l],g=f[0],p=f[1],m=g+p,z=new Uint32Array(4);z[0]=g-p+1,z[1]=m,z[2]=m+p,z[3]=m+g;for(var v=z[0]|z[1]<<1|z[2]<<2|z[3]<<4,b=W.lookup2D[v],y=0;void 0!==b;){var w=[u+b.dx,h+b.dy],x=w[0],C=w[1],T=2-x*x-C*C;if(0<T){var k=[s+b.xsb,l+b.ysb],A=k[0],E=k[1],M=W.perm2D[W.perm[255&A]+E&255];y+=(T*=T)*T*(N.gradients2D[M]*x+N.gradients2D[M+1]*C)}b=b.next}return y*N.NORM_2D},this.simplex3D=function(e,t,o){var n=(e+t+o)*N.STRETCH_3D,i=[e+n,t+n,o+n],r=i[0],a=i[1],s=i[2],l=[Math.floor(r),Math.floor(a),Math.floor(s)],c=l[0],d=l[1],u=l[2],h=(c+d+u)*N.SQUISH_3D,f=[e-(c+h),t-(d+h),o-(u+h)],g=f[0],p=f[1],m=f[2],z=[r-c,a-d,s-u],v=z[0],b=z[1],y=z[2],w=v+b+y,x=new Uint32Array(7);x[0]=b-y+1,x[1]=v-b+1,x[2]=v-y+1,x[3]=w,x[4]=w+y,x[5]=w+b,x[6]=w+v;for(var C=x[0]|x[1]<<1|x[2]<<2|x[3]<<3|x[4]<<5|x[5]<<7|x[6]<<9,T=W.lookup3D[C],k=0;void 0!==T;){var A=[g+T.dx,p+T.dy,m+T.dz],E=A[0],M=A[1],I=A[2],S=2-E*E-M*M-I*I;if(0<S){var j=[c+T.xsb,d+T.ysb,u+T.zsb],B=j[0],O=j[1],P=j[2],D=W.perm3D[W.perm[W.perm[255&B]+O&255]+P&255];k+=(S*=S)*S*(N.gradients3D[D]*E+N.gradients3D[D+1]*M+N.gradients3D[D+2]*I)}T=T.next}return k*N.NORM_3D},this.simplex4D=function(e,t,o,n){var i=(e+t+o+n)*N.STRETCH_4D,r=[e+i,t+i,o+i,n+i],a=r[0],s=r[1],l=r[2],c=r[3],d=[Math.floor(a),Math.floor(s),Math.floor(l),Math.floor(c)],u=d[0],h=d[1],f=d[2],g=d[3],p=(u+h+f+g)*N.SQUISH_4D,m=e-(u+p),z=t-(h+p),v=o-(f+p),b=n-(g+p),y=[a-u,s-h,l-f,c-g],w=y[0],x=y[1],C=y[2],T=y[3],k=w+x+C+T,A=new Uint32Array(11);A[0]=C-T+1,A[1]=x-C+1,A[2]=x-T+1,A[3]=w-x+1,A[4]=w-C+1,A[5]=w-T+1,A[6]=k<<6,A[7]=k+T,A[8]=k+C,A[9]=k+x,A[10]=k+w;for(var E=A[0]|A[1]<<1|A[2]<<2|A[3]<<3|A[4]<<4|A[5]<<5|A[6]<<6|A[7]<<8|A[8]<<11|A[9]<<14|A[10]<<17,M=W.lookup4D[E],I=0;void 0!==M;){var S=[m+M.dx,z+M.dy,v+M.dz,b+M.dw],j=S[0],B=S[1],O=S[2],P=S[3],D=2-j*j-B*B-O*O-P*P;if(0<D){var L=[u+M.xsb,h+M.ysb,f+M.zsb,g+M.wsb],Y=L[0],X=L[1],_=L[2],R=L[3],F=W.perm4D[W.perm[W.perm[W.perm[255&Y]+X&255]+_&255]+R&255];I+=(D*=D)*D*(N.gradients4D[F]*j+N.gradients4D[F+1]*B+N.gradients4D[F+2]*O+N.gradients4D[F+3]*P)}M=M.next}return I*N.NORM_4D}},Je.Damp=function(e,t){z_d("14");var o;if(o=zob(Je.Damp,arguments,"startValue, damp",this))return o;this.lastValue=zot(e)?0:e,this.damp=zot(t)?.1:t},Je.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp},Je.Damp.prototype.immediate=function(e){return this.lastValue=e,this},Je.Proportion=function(t,o,n,i,r,a){var e,s,l;if(e=zob(Je.Proportion,arguments,"baseMin, baseMax, targetMin, targetMax, factor, targetRound",this))return e;z_d("15"),zot(n)&&(n=0),zot(i)&&(i=1),zot(r)&&(r=1),zot(a)&&(a=!1),this.convert=function(e){if(!isNaN(e))return e=Math.max(e,t),e=Math.min(e,o),s=(e-t)/(o-t),l=0<r?n+(i-n)*s:i-(i-n)*s,a&&(l=Math.round(l)),l}},Je.ProportionDamp=function(e,t,o,n,i,r,a){var s;if(s=zob(Je.ProportionDamp,arguments,"baseMin, baseMax, targetMin, targetMax, damp, factor, targetRound",this))return s;z_d("16"),zot(o)&&(o=0),zot(n)&&(n=1),zot(i)&&(i=.1),zot(r)&&(r=1),zot(a)&&(a=!1),this.damp=i;var l,c,d,u,h=this,f=0;l=e,f=o;var g=setInterval(p,20);function p(){isNaN(l)||(l=Math.max(l,e),l=Math.min(l,t),c=(l-e)/(t-e),d=n-o,f+=((u=0<r?o+d*c:n-d*c)-f)*h.damp)}this.immediate=function(e){return h.convert(e),p(),f=u,a&&(f=Math.round(f)),h},this.convert=function(e){return l=e,a?Math.round(f):f},this.dispose=function(){return clearInterval(g),!0}},Je.Dictionary=function(e){z_d("17"),this.length=0,this.unique=e;var o=this.objects=[],n=this.values=[];this.add=function(e,t){zot(e)||(zot(t)&&(t=!0),this.unique&&this.remove(e),o.push(e),n.push(t),this.length++)},this.at=function(e){if(!zot(e)){var t=o.indexOf(e);return-1<t?n[t]:null}},this.remove=function(e){if(zot(e))return!1;var t=o.indexOf(e);return-1<t&&(o.splice(t,1),n.splice(t,1),this.length--,!0)},this.dispose=function(){return n=o=null,!(this.length=null)}},Je.swapProperties=function(e,t,o){if(z_d("17.1"),zot(t)||zot(o)||zot(t[e])||zot(o[e]))return!1;var n=o[e];return o[e]=t[e],t[e]=n,!0},Je.swapHTML=function(e,t){return z_d("17.2"),Je.swapProperties("innerHTML",zid(e),zid(t))},Je.scrollX=function(e,t){return z_d("18"),Je.abstractScroll("X","Left",e,t)},Je.scrollY=function(e,t){return z_d("19"),Je.abstractScroll("Y","Top",e,t)},Je.abstractScroll=function(e,t,o,n){z_d("20");var i="X"==e?"Y":"X";if(zot(o)){var r=navigator.applicationName;if(-1!=navigator.userAgent.indexOf("Safari")||"Safari"==r);return document.documentElement&&document.documentElement["scroll"+t]||document.body["scroll"+t]}if(zot(n))window.scrollTo(Je["scroll"+i](),o);else{n<50&&(n=50);var a=n/50,s=Je["scroll"+e](),l=(o-s)/a,c=0,d=setInterval(function(){c++,s+=l,window.scrollTo(Je["scroll"+i](),s),a<=c&&(window.scrollTo(Je["scroll"+i](),o),clearInterval(d))},50)}return o},Je.windowWidth=function(){return z_d("21"),isNaN(window.innerWidth)?window.clientWidth:window.innerWidth},Je.windowHeight=function(){return z_d("22"),isNaN(window.innerHeight)?window.clientHeight:window.innerHeight},Je.getQueryString=function(e){if(z_d("22.5"),zot(e)&&(e=location.search.replace("?","")),""!=e){for(var t=e.split("&"),o={},n=0;n<t.length;n++){var i=t[n].split("=");void 0===o[i[0]]?o[i[0]]=decodeURIComponent(i[1]):"string"==typeof o[i[0]]?o[i[0]]=[o[i[0]],decodeURIComponent(i[1])]:o[i[0]].push(decodeURIComponent(i[1]))}return o}},Je.urlEncode=function(e){z_d("23");e=(e+"").toString();return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},Je.urlDecode=function(e){return z_d("24"),decodeURIComponent((e+"").replace(/\+/g,"%20"))},Je.setCookie=function(e,t,o){if(z_d("25"),!zot(e)&&!zot(t)){if(o){var n=new Date;n.setTime(n.getTime()+24*o*60*60*1e3);var i="; expires="+n.toGMTString()}else i="";return document.cookie=e+"="+escape(t)+i+"; path=/",!0}},Je.getCookie=function(e){z_d("26");var t,o=document.cookie.split(/;\s*/),n=new Array;for(s=0;s<o.length;s++)n[(t=o[s].split("="))[0]]=t[1];if(void 0!==n[e])return unescape(n[e])},Je.deleteCookie=function(e){return z_d("27"),!zot(Je.getCookie(e))&&(Je.setCookie(e,"",-1),!0)},Je.convertColor=function(e,t,o){if(z_d("27.5"),zot(t)&&(t="hex"),zot(o),"rgba"==t){function n(e){var t;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)?(3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),"rgba("+[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t].join(",")+","+o+")"):"rgba(0,0,0,1)"}return"#"==e.charAt(0)?n(e):n(Je.convertColor(e))}if("hex"==t){if("#"==e.charAt(0))return e}else"#"==e.charAt(0)&&3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2));var i=["black","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],r=["000000","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"];return"string"==t?i[-1!=r.indexOf(e.toLowerCase())?r.indexOf(e):0]:"#"+r[-1!=i.indexOf(e.toLowerCase())?i.indexOf(e):0]},Je.mobile=function(e){return z_d("28"),zot(e)&&(e=!0),/ip(hone|od|ad)/i.test(navigator.userAgent)?"ios":/android|nexus/i.test(navigator.userAgent)?"android":/blackberry/i.test(navigator.userAgent)?"blackberry":/nokia|phone|mobile/i.test(navigator.userAgent)?"windows":/opera mini|webos/i.test(navigator.userAgent)?"other":!(!e||void 0===window.orientation)},Je.async=function(e,t){if(z_d("29"),!zot(e)){var o,n=document.createElement("script");if(t){var i=t.toString().split(/\n/,1)[0].match(/^function\s?([^\s(]*)/)[1];Je.async[i]=(o=n,function(e){o&&o.parentNode.removeChild(o),o=null,t(e)})}else Je.async.z_s&&Je.async.z_s.parentNode&&Je.async.z_s.parentNode.removeChild(Je.async.z_s),Je.async.z_s=n;e.match(/\?/)||(e+="?"),n.setAttribute("src",e+"&r="+Math.random()),document.getElementsByTagName("head")[0].appendChild(n)}},Je.extend=function(e,t,o,n,i){var r;if(r=zob(Je.extend,arguments,"subclass, superclass, override, prefix, prototype"))return r;if(!zot(e)&&!zot(t)||!zon){zot(n)&&(n="super"),zot(o)&&(o=[]),Array.isArray(o)||(o=[o]),zot(i)&&(i=!0);var a={};for(var s in e.prototype)Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(e.prototype,s));for(s in h.prototype=t.prototype,e.prototype=new h,a)Object.defineProperty(e.prototype,s,Object.getOwnPropertyDescriptor(a,s));var l=e.prototype,c=Object.getPrototypeOf&&Object.getPrototypeOf(l)||l.__proto__;if(c){var d;l[(n+="_")+"constructor"]=c.constructor;for(var u=0;u<o.length;u++)"function"==typeof c[d=o[u]]&&(l[n+d]=c[d]);if(i)for(d in c)l.hasOwnProperty(d)&&"function"==typeof c[d]&&(l[n+d]=c[d])}return e}function h(){this.constructor=e}zog("zim.extend() - please supply a class and its superclass")},"undefined"==typeof createjs)return zon&&zog("ZIM >= 4.3.0 requires createjs namespace to be loaded (import createjs before zim)"),Je;function be(e,t){t?(e.mouseChildren=!0,e.mouseEnabled=!0,e._enabled=!0):(e.mouseChildren=!1,e.mouseEnabled=!1,e._enabled=!1)}Je.Stage=function(e){z_d("50.44"),this.cjsStage_constructor(e),this.type="Stage",this.cache=function(e,t,o,n,i,r){if(zot(o))if(zot(e)){var a=this.getBounds();if(!zot(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,o=a.width+2*s,n=a.height+2*s}}else o=e,n=t,t=e=0;return this.cjsStage_cache(e,t,o,n,i,r),this},this.loop=function(e,t,o,n,i){return Je.loop(this,e,t,o,n,i)},this.hitTestGrid=function(e,t,o,n,i,r,a,s,l,c,d,u){return Je.hitTestGrid(this,e,t,o,n,i,r,a,s,l,c,d,u)},this.clone=function(){return this.cloneChildren(this.cloneProps(new Je.Stage(e)))}},Je.extend(Je.Stage,createjs.Stage,["cache","clone"],"cjsStage",!1),Je.StageGL=function(e,t){z_d("50.45"),this.cjsStageGL_constructor(e,t),this.type="StageGL",this.cache=function(e,t,o,n,i,r){if(zot(o))if(zot(e)){var a=this.getBounds();if(!zot(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,o=a.width+2*s,n=a.height+2*s}}else o=e,n=t,t=e=0;return this.cjsStageGL_cache(e,t,o,n,i,r),this},this.loop=function(e,t,o,n,i){return Je.loop(this,e,t,o,n,i)},this.hitTestGrid=function(e,t,o,n,i,r,a,s,l,c,d,u){return Je.hitTestGrid(this,e,t,o,n,i,r,a,s,l,c,d,u)},this.clone=function(){return this.cloneChildren(this.cloneProps(new Je.StageGL(e)))}},Je.extend(Je.StageGL,createjs.StageGL,["cache","clone"],"cjsStageGL",!1),Je.Container=function(e,t,o,n){z_d("50.5"),this.cjsContainer_constructor(),this.type="Container";var i=r(e,t,o,n);function r(e,t,o,n){var i=[];return zot(o)?(i[0]=0,i[2]=e,i[1]=0,i[3]=t):(i[0]=e,i[2]=o,i[1]=t,i[3]=n),zot(i[3])&&(i[3]=i[2]),i}zot(e)||this.setBounds(i[0],i[1],i[2],i[3]),this.cache=function(e,t,o,n,i,r){var a=this.getBounds();if(zot(o))if(zot(e)){if(!zot(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,o=a.width+2*s,n=a.height+2*s}}else o=e,n=t,t=e=0;return this.cjsContainer_cache(e,t,o,n,i,r),a&&this.setBounds(a.x,a.y,a.width,a.height),this},this.setBounds=function(e,t,o,n){var i=r(e,t,o,n);return this.cjsContainer_setBounds(i[0],i[1],i[2],i[3]),this},this.clone=function(){return this.cloneChildren(this.cloneProps(new Je.Container(i[0],i[1],i[2],i[3])))}},Je.Container.prototype.dispose=function(){return function e(t){t.removeAllEventListeners();if(t.numChildren)for(var o=t.numChildren-1;0<=o;o--)e(t.getChildAt(o));t.parent&&t.parent.removeChild(t)}(this),!0},zimify(Je.Container.prototype),Je.extend(Je.Container,createjs.Container,["cache","setBounds","clone"],"cjsContainer",!1),Je.Shape=function(e,t,o,n,i){z_d("50.6"),this.cjsShape_constructor(i),this.type="Shape";var r=this;if(zot(o))a=0,s=e,l=0,c=t;else var a=e,s=o,l=t,c=n;zot(c)&&(c=s),zot(e)||this.setBounds(a,l,s,c),this.cache=function(e,t,o,n,i,r){if(zot(o))if(zot(e)){var a=this.getBounds();if(!zot(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,o=a.width+2*s,n=a.height+2*s}}else o=e,n=t,t=e=0;return this.cjsShape_cache(e,t,o,n,i,r),this},this.clone=function(e){zot(e)&&(e=!0);var t=r.cloneProps(new Je.Shape(s,c,a,l,i));return t.graphics=e?r.graphics.clone():r.graphics,t},this.dispose=function(){this.graphics.c(),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},Je.extend(Je.Shape,createjs.Shape,["cache","clone"],"cjsShape",!1),zimify(Je.Shape.prototype),Je.Bitmap=function(s,l,c,e){z_d("50.7"),this.cjsBitmap_constructor(s);var d=this;this.type="Bitmap",this.id=d.fileID=e,zot(l)||zot(c)||d.setBounds(0,0,l,c),zot(l)&&(l=100),zot(c)&&(c=100),zimDefaultFrame&&(zimDefaultFrame.canvas.getContext("2d")?this.imageData=zimDefaultFrame.canvas.getContext("2d").createImageData(l,c):this.imageData=document.createElement("canvas").getContext("2d").createImageData(l,c),this.drawImageData=function(e,t,o,n,i,r){if(zot(e)&&(e=0),zot(t)&&(t=0),zot(o)&&(o=0),zot(n)&&(n=0),zot(i)&&(i=l),zot(r)&&(r=c),!d.proxyCanvas){var a=d.proxyCanvas=document.createElement("canvas");a.setAttribute("width",l),a.setAttribute("height",c),d.proxyContext=a.getContext("2d"),s=d.image=a}d.proxyContext&&d.proxyContext.putImageData(d.imageData,e,t,o,n,i,r)},zot(s)&&d.drawImageData(),s.match&&s.match(/data:image/i)&&setTimeout(function(){d.stage&&d.stage.update(),setTimeout(function(){d.stage&&d.stage.update()},50)},50)),this.clone=function(){return this.cloneProps(new Je.Bitmap(s,l,c,d.fileID))},this.dispose=function(){this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},Je.Bitmap.fromData=function(e,t){var o=new Je.Bitmap(e);setTimeout(function(){t(o)},50)},Je.extend(Je.Bitmap,createjs.Bitmap,"clone","cjsBitmap",!1),zimify(Je.Bitmap.prototype),Je.Sprite=function(e,t,o,n,i,r,a,s,l,c,d,u,h,f,g){var p;if(p=zob(Je.Sprite,arguments,"image, cols, rows, count, offsetX, offsetY, spacingX, spacingY, width, height, animations, json, id, globalControl, spriteSheet",this))return p;this.type="Sprite",z_d("50.8");var m,P=this;if(zot(u)&&!zot(e)){zot(t)&&(t=1),zot(o)&&(o=1),zot(n)&&(n=t*o),zot(i)&&(i=0),zot(r)&&(r=0),zot(a)&&(a=0),zot(s)&&(s=0),zot(l)&&(l=e.width),zot(c)&&(c=e.height);var z=(l-i+a)/t-a,v=(c-r+s)/o-s,b=[],y=0;e:for(var w=0;w<o;w++)for(var x=0;x<t;x++){if(++y>n)break e;b.push([i+x*(z+a),r+w*(v+s),z,v])}k(e,b,d)}else if(g)d=(m=g).animations;else{if(!u)return;if(b=u.frames,d=u.animations,zot(e)){var C=u.images?u.images[0]:null,T=C.split("/").pop();if("EmptyAsset"!=frame.asset(T).type)k(frame.asset(T),b,d);else if("EmptyAsset"!=frame.asset(C).type){frame.asset(C);k(frame.asset(C),b,d)}else m=new createjs.SpriteSheet(u)}else k(e,b,d)}function k(e,t,o){var n={images:[e.image],frames:t,animations:o||[]};m=new createjs.SpriteSheet(n)}this.animations=d,this.cjsSprite_constructor(m),zot(h)&&(h=Je.makeID()),this.id=h,zot(f)&&(f=!0),P.globalControl=f;var D,L=0;this.parseFrames=function(e,t,o,n){var r=[],a=Number.MAX_VALUE,s=0;if(zot(e))zot(t)&&(t=0),zot(o)&&(o=P.totalFrames-1),l(t,o);else{if(zot(P.animations)||zot(P.animations[e]))return[];i(P.animations[e])}function i(e){var t;Array.isArray(e)?(l((t=e)[0],t[1],t[3]),t[2]&&!zot(P.animations[t[2]])&&i(P.animations[t[2]])):e.constructor=={}.constructor?function(e){if(zot(e.frames))return;zot(e.speed)&&(e.speed=1);for(var t=0;t<e.frames.length;t++)e.speed<a&&(a=e.speed),e.speed>s&&(s=e.speed),r.push({f:e.frames[t],s:e.speed});e.next&&!zot(P.animations[e.next])&&i(P.animations[e.next])}(e):isNaN(e)||r.push({f:Math.floor(e),s:1})}function l(e,t,o){if(zot(o)&&(o=1),e<t)for(var n=e;n<=t;n++)i(n);else for(n=t;n<=e;n++)i(e-n);function i(e){o<a&&(a=o),s<o&&(s=o),r.push({f:e,s:o})}}if(n)return r;a=Je.constrain(Je.decimals(a),.1),s=Je.constrain(Je.decimals(s),.1);for(var c,d=[],u=a!=s,h=0;h<r.length;h++)if(c=r[h],u)for(var f=0;f<Je.constrain(Math.round(a<1?c.s/a:c.s),.1);f++)d.push(c.f);else d.push(c.f);return d},this.run=function(e,t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T){var k,A;if(k=zob(this.run,arguments,"time, label, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, startFrame, endFrame, tweek, id, globalControl"))return k;if(zot(x)&&(x=1),zot(C)||(P.id=C),zot(T)||(P.globalControl=T),Array.isArray(t)){var E,M;A=[];for(var I,S=0,j=0;j<t.length;j++){(E=t[j]).lookup=P.parseFrames(E.label,E.startFrame,E.endFrame),0==j&&(I=E.lookup[0]),delete E.startFrame,delete E.endFrame,E.obj=Je.merge(E.obj,{normalizedFrame:E.lookup.length-1}),E.set=Je.merge(E.set,{normalizedFrames:{noZik:E.lookup},normalizedFrame:0}),zot(E.wait)&&(E.wait=S*x),M=E.label,delete E.label,A.push(E),S=0;var B=zot(E.time)?e:E.time;0<w-y&&(S=B/(w-y)/2)}if(0==A.length)return this;1==A.length?(e=A[0].time,t=M,O()):P.gotoAndStop(I)}else O();function O(){D=P.parseFrames(t,y,w),L=0,P.gotoAndStop(D[L]),y=w=null,A={normalizedFrame:D.length-1}}if(zot(e)&&(e=1e3),P.running&&P.stopAnimate(P.id),P.running=!0,!Array.isArray(A)){S=0;0<w-y&&(S=e/Math.abs(w-y)/2),D&&0<D.length&&(S=e/D.length/2),zot(c)&&(c=S*x),zot(p)&&(p=S*x)}return Je.animate({target:P,obj:A,time:e,ease:"linear",call:function(){o&&"function"==typeof o&&o(n),P.running=!1},params:n,wait:i,waitedCall:r,waitedParams:a,loop:s,loopCount:l,loopWait:c,loopCall:d,loopParams:u,loopWaitCall:h,loopWaitParams:f,rewind:g,rewindWait:p,rewindCall:m,rewindParams:z,rewindWaitCall:v,rewindWaitParams:b,override:!1,id:P.id}),P.runPaused=!1,P},this.runPaused=!0,this.pauseRun=function(e){return zot(e)&&(e=!0),P.runPaused=e,P.globalControl?Je.pauseAnimate(e,P.id):P.pauseAnimate(e,P.id),P},this.stopRun=function(){return P.runPaused=!0,P.running=!1,P.globalControl?Je.stopAnimate(P.id):P.stopAnimate(P.id),P},Object.defineProperty(this,"frame",{get:function(){return this.currentFrame},set:function(e){e=Math.round(e),this.paused?this.gotoAndStop(e):this.gotoAndPlay(e)}}),Object.defineProperty(this,"normalizedFrame",{get:function(){return L},set:function(e){L=Math.round(e),this.gotoAndStop(D[L])}}),Object.defineProperty(this,"normalizedFrames",{get:function(){return D},set:function(e){D=e}}),Object.defineProperty(this,"totalFrames",{get:function(){return m.getNumFrames()},set:function(e){zog("zim.Sprite - totalFrames is read only")}}),this.clone=function(){return this.cloneProps(new Je.Sprite(e,t,o,n,i,r,a,s,l,c,d,u,null,f,g))},this.dispose=function(){this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},Je.extend(Je.Sprite,createjs.Sprite,"clone","cjsSprite",!1),zimify(Je.Sprite.prototype),Je.MovieClip=function(e,t,o,n){var i;if(i=zob(Je.MovieClip,arguments,"mode, startPosition, loop, labels",this))return i;this.type="MovieClip",z_d("50.9"),this.cjsMovieClip_constructor(e,t,o,n),this.clone=function(){return this.cloneProps(new Je.MovieClip(e,t,o,n))},this.dispose=function(){this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},Je.extend(Je.MovieClip,createjs.MovieClip,"clone","cjsMovieClip",!1),zimify(Je.MovieClip.prototype),Je.Circle=function(e,t,o,n,i){var r;if(r=zob(Je.Circle,arguments,"radius, color, borderColor, borderWidth, dashed",this))return r;z_d("51"),this.zimContainer_constructor(),this.type="Circle",zot(e)&&(e=50),zot(i)&&(i=!1),!zot(o)&&zot(n)?n=1:!zot(n)&&zot(o)&&(o="black"),zot(t)&&(t=0<n?"rgba(0,0,0,0)":"black");var a=this,s=e,l=t,c=o,d=n;this.mouseChildren=!1;var u=this.shape=new createjs.Shape;this.addChild(u);var h,f,g,p,m=u.graphics;function z(){m.c(),a.colorCommand=h=m.f(l).command,(zot(d)||0<d)&&(zot(c)&&zot(d)||(zot(c)&&(c="black"),a.borderColorCommand=f=m.s(c).command,a.borderWidthCommand=g=m.ss(d).command,i&&(a.borderDashedCommand=p=m.sd([10,10],5).command))),m.dc(0,0,s),a.setBounds(-s,-s,2*s,2*s)}z(),Object.defineProperty(a,"color",{get:function(){return l},set:function(e){zot(e)&&(e="black"),l=e,h.style=l}}),Object.defineProperty(a,"borderColor",{get:function(){return c},set:function(e){c=e,f?f.style=c:z()}}),Object.defineProperty(a,"borderWidth",{get:function(){return d},set:function(e){0<e||(e=0),d=e,g&&0!=d?(g.width=d,i&&(p.segments=[20,10],p.offset=5)):z()}}),Object.defineProperty(a,"radius",{get:function(){return s},set:function(e){s=e,z()}}),this.clone=function(){return a.cloneProps(new Je.Circle(a.radius,a.color,a.borderColor,a.borderWidth,i))}},Je.extend(Je.Circle,Je.Container,"clone","zimContainer",!1),Je.Rectangle=function(e,t,o,n,i,r,a,s){var l;if(l=zob(Je.Rectangle,arguments,"width, height, color, borderColor, borderWidth, corner, flatBottom, dashed",this))return l;z_d("52"),this.zimContainer_constructor(),this.type="Rectangle",zot(e)&&(e=100),zot(t)&&(t=100),zot(r)&&(r=0),zot(a)&&(a=!1),zot(s)&&(s=!1),!zot(n)&&zot(i)?i=1:!zot(i)&&zot(n)&&(n="black"),zot(o)&&(o=0<i?"rgba(0,0,0,0)":"black");var c=this,d=o,u=n,h=i;this.mouseChildren=!1;var f=this.shape=new createjs.Shape;this.addChild(f);var g,p,m,z=f.graphics;function v(){z.c(),c.colorCommand=g=z.f(d).command,(zot(h)||0<h)&&(zot(u)&&zot(h)||(zot(u)&&(u="black"),c.borderColorCommand=p=z.s(u).command,c.borderWidthCommand=m=z.ss(h).command,s&&(c.borderDashedCommand=borderDashedObj=z.sd([10,10],5).command))),a?z.rc(0,0,e,t,r,r,0,0):0<r?z.rr(0,0,e,t,r):z.r(0,0,e,t),c.setBounds(0,0,e,t)}v(),Object.defineProperty(c,"color",{get:function(){return d},set:function(e){zot(e)&&(e="black"),d=e,g.style=d}}),Object.defineProperty(c,"borderColor",{get:function(){return u},set:function(e){u=e,p?p.style=u:v()}}),Object.defineProperty(c,"borderWidth",{get:function(){return h},set:function(e){0<e||(e=0),h=e,m&&0!=h?(m.width=h,s&&(borderDashedObj.segments=[20,10],borderDashedObj.offset=5)):v()}}),this.clone=function(){return c.cloneProps(new Je.Rectangle(e,t,c.color,c.borderColor,c.borderWidth,r,a,s))}},Je.extend(Je.Rectangle,Je.Container,"clone","zimContainer",!1),Je.Triangle=function(l,c,e,t,o,n,d,u,h){var i;if(i=zob(Je.Triangle,arguments,"a, b, c, color, borderColor, borderWidth, center, adjust, dashed",this))return i;z_d("53"),this.zimContainer_constructor(),this.type="Triangle",zot(l)&&(l=100),zot(c)&&(c=l),zot(e)&&(e=c),-1==e&&(e=Math.sqrt(Math.pow(l,2)+Math.pow(c,2))),zot(d)&&(d=!0),zot(u)&&(u=0),!zot(o)&&zot(n)?n=1:!zot(n)&&zot(o)&&(o="black"),zot(t)&&(t=0<n?"rgba(0,0,0,0)":"black");var f=this,g=t,p=o,m=n;this.mouseChildren=!1;var r=[l,c,e];r.sort(function(e,t){return t-e}),aa=r[0],bb=r[1],cc=r[2];var z=[r.indexOf(l),r.indexOf(c),r.indexOf(e)];if(aa>bb+cc)zog("zim display - Triangle(): invalid triangle lengths");else{var v=this.shape=new createjs.Shape;this.addChild(v);var b,y,w,x=v.graphics;a(),Object.defineProperty(f,"color",{get:function(){return g},set:function(e){zot(e)&&(e="black"),g=e,b.style=g}}),Object.defineProperty(f,"borderColor",{get:function(){return p},set:function(e){p=e,y?y.style=p:a()}}),Object.defineProperty(f,"borderWidth",{get:function(){return m},set:function(e){0<e||(e=0),m=e,w&&0!=m?(w.width=m,h&&(borderDashedObj.segments=[20,10],borderDashedObj.offset=5)):a()}}),this.clone=function(){return f.cloneProps(new Je.Triangle(l,c,e,f.color,f.borderColor,f.borderWidth,d,u,h))}}function a(){x.c(),f.colorCommand=b=x.f(g).command,(zot(m)||0<m)&&(zot(p)&&zot(m)||(zot(p)&&(p="black"),f.borderColorCommand=y=x.s(p).command,f.borderWidthCommand=w=x.ss(m).command,h&&(f.borderDashedCommand=borderDashedObj=x.sd([10,10],5).command))),x.mt(0,0),f.one={x:0,y:0},x.lt(l,0),f.two={x:l,y:0};var e=180*Math.acos((Math.pow(bb,2)+Math.pow(cc,2)-Math.pow(aa,2))/(2*bb*cc))/Math.PI,t=180*Math.asin(bb*Math.sin(e*Math.PI/180)/aa)/Math.PI,o=[e,t,180-e-t];f.angles=[o[z[1]],o[z[2]],o[z[0]]];var n=f.angles[1],i=Math.cos(n*Math.PI/180)*c,r=Math.sin(n*Math.PI/180)*c,a=Math.max(l,l-i),s=r;f.setBounds(0,0,a,s),v.y=s,x.lt(l-i,0-r),f.three={x:l-i,y:0-r},x.cp(),d&&(f.regX=a/2,f.regY=s/2),u&&(f.shape.y+=u)}},Je.extend(Je.Triangle,Je.Container,"clone","zimContainer"),Je.Squiggle=function(e,A,E,M,I,S,j,B,O,P,t,o,n,D,L){var i;if(i=zob(Je.Squiggle,arguments,"color, thickness, points, length, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, toggle, move, ctrlclick, dashed, onTop",this))return i;z_d("53.2"),zot(A)&&(A=6),zot(M)&&(M=300),zot(E)&&(E=5);var Y="number"==typeof E?E:E.length;if(0!=Y){zot(I)&&(I=M/Y),this.zimContainer_constructor(M,I),this.type="Squiggle",zot(D)&&(D=!1),zot(e)&&(e=frame.blue),e.style&&(this.colorCommand=e,e="black"),zot(S)&&(S="mirror"),zot(j)&&(j=!1),zot(B)&&(B=!0);var X=B;zot(O)&&(O=!1),zot(P)&&(P=Je.mobile()?20:10),zot(t)&&(t=!0),zot(o)&&(o=!0),zot(n)&&(n=!1),this.toggle=t,this.move=o,this.lockControlType=j,this.ctrlclick=n,this.num=Y,zot(L)&&(L=!0);var _,R,F,W,N,G,V,H,U,Z=this,K=(this.types=["mirror","straight","free","none"],e),q=A,r=Z.move;s(),Object.defineProperty(Z,"move",{get:function(){return o},set:function(e){o!=e&&((o=e)?Q():J())}}),Object.defineProperty(Z,"toggle",{get:function(){return t},set:function(e){t!=e&&((t=e)?Z.move&&Q():!X&&Z.move&&J())}});var a=O;Object.defineProperty(Z,"lockControls",{get:function(){return a},set:function(e){(a=e)?(Z.controls.mouseChildren=!1,Z.controls.mouseEnabled=!1):(Z.controls.mouseChildren=!0,Z.controls.mouseEnabled=!0)}}),Z.lockControls=a,Object.defineProperty(Z,"controlsVisible",{get:function(){return X},set:function(e){(X=e)?Z.showControls():Z.hideControls()}}),Object.defineProperty(Z,"color",{get:function(){return K},set:function(e){zot(e)&&(e="black"),K=e,R.style=K}}),Object.defineProperty(Z,"thickness",{get:function(){return q},set:function(e){0<e||(e=0),q=e,F&&0!=q?(F.width=q,D&&(W.segments=[20,10],W.offset=5)):drawShape()}}),Object.defineProperty(Z,"points",{get:function(){for(var e,t,o=[],n=0;n<_.length;n++)t=_[n],e=[Je.decimals(t[0].x),Je.decimals(t[0].y),Je.decimals(t[1].x),Je.decimals(t[1].y),Je.decimals(t[2].x),Je.decimals(t[2].y),Je.decimals(t[3].x),Je.decimals(t[3].y)],t[4]&&"straight"!==t[4]&&e.push(t[4]),o.push(e);return o},set:function(e){Z.dispose(),E=e,Z.shape&&(Z.shape.graphics.clear(),Z.sticks.graphics.clear(),Z.controls.noDrag(),Z.removeAllChildren(),delete Z.shape,delete Z.sticks,delete Z.controls),s(),Z.lockControls=a}}),Object.defineProperty(Z,"pointObjects",{get:function(){return _},set:function(e){zon&&zog("Squiggle() - pointObjects is read only - but its contents can be manipulated - use squiggle.update() after changes")}}),this.dispose=function(){return Z.toggleStageEvent&&Z.stage.off("stagemousedown",Z.toggleStageEvent),this.zimContainer_dispose(),!0}}function s(){Z.num=Y="number"==typeof E?E:E.length,Y=Math.max(2,Y),I=M/Y,G=Z.shape=(new Je.Shape).addTo(Z);var o=Z.sticks=(new Je.Shape).addTo(Z),m=G.graphics;m.c();var z=o.graphics;z.c();var e,t,n,i,r,a,s,l,c=P/10*8,d=P,u=Je.mobile(),h=Z.controls=(new Je.Container).addTo(Z).drag({onTop:!u});_=[],N=[];for(var f=0;f<Y;f++){if(n=(new Je.Container).addTo(h),"number"==typeof E){var g=zik(I);t=new Je.Container(g,A).pos(f*M/(Y-1)-g/2,f%2*g).addTo(Z),a=new Je.Circle(c,frame.light,frame.dark,2).centerReg(t).pos(g/2,0),i=new Je.Rectangle(d,d,T(S),frame.dark,2).centerReg(t).pos(0,0),r=new Je.Rectangle(d,d,T(S),frame.dark,2).centerReg(t).pos(g,0);var p=t.localToLocal(a.x,a.y,h);a.x=p.x,a.y=p.y,a.addTo(n,null,!1);var v=t.localToLocal(i.x,i.y,h);i.x="none"==S?0:v.x-a.x,i.y="none"==S?0:v.y-a.y,i.addTo(n,null,!1);var b=t.localToLocal(r.x,r.y,h);r.x="none"==S?0:b.x-a.x,r.y="none"==S?0:b.y-a.y,r.addTo(n,null,!1),n.pos(a.x,a.y),a.x=0,a.y=0,"none"==S&&a.addTo(n,null,!1)}else s=(l=E[f])[8]?l[8]:S,n=(new Je.Container).addTo(h).pos(l[0],l[1]),a=new Je.Circle(c,frame.light,frame.dark,2).centerReg(n).pos(l[2],l[3]),i=new Je.Rectangle(d,d,T(s),frame.dark,2).centerReg(n,0).pos(l[4],l[5]),r=new Je.Rectangle(d,d,T(s),frame.dark,2).centerReg(n,0).pos(l[6],l[7]);N.push(a),a.mySet=n,a.rect1=i,a.rect2=r,a.index=f,u?a.on("mousedown",x):a.on("dblclick",C),i.ball=a,(i.other=r).ball=a,r.other=i,u&&(a.expand(),i.expand(),r.expand()),e=[n,a,i,r,l?l[8]:S],_.push(e)}var y,w=!1;function x(e){w?(e.preventDefault(),C(e)):(w=!0,setTimeout(function(){w=!1},300))}function C(e){if(!Z.lockControlType){var t=e.target,o=_[t.index][4]?_[t.index][4]:S;Math.abs(t.rect1.x)<=2&&Math.abs(t.rect1.y)<=2&&Math.abs(t.rect2.x)<=2&&Math.abs(t.rect2.y)<=2&&(o="none"),"none"==o&&t.parent.addChildAt(t,0),"none"==(o=Z.types[(Z.types.indexOf(o)+(frame.shiftKey?-1:1)+Z.types.length)%Z.types.length])&&(t.rect1.x=t.rect1.y=t.rect2.x=t.rect2.y=0,t.parent.addChild(t),e.stopImmediatePropagation()),_[t.index][4]=o,t.rect1.color=T(o),t.rect2.color=T(o),k();var n=new createjs.Event("change");n.controlType="bezierSwitch",Z.dispatchEvent(n),t.stage.update()}}function T(e){var t={mirror:frame.purple,free:frame.yellow,none:frame.blue};return t[e]?t[e]:frame.pink}function k(){m.c();var e=Je.mobile()?10:6;if(A<e){m.s("rgba(0,0,0,.01)").ss(e);var t=(r=_[0][0]).localToLocal(_[0][1].x,_[0][1].y,G);m.mt(t.x,t.y);for(var o=0;o<_.length;o++){var n=o,i=(o+1)%_.length,r=_[n][0],a=_[n][1],s=_[n][2],l=_[n][3],c=_[i][0],d=_[i][1],u=_[i][2],h=(_[i][3],r.localToLocal(l.x,l.y,G)),f=c.localToLocal(u.x,u.y,G),g=c.localToLocal(d.x,d.y,G);o!=_.length-1&&m.bt(h.x,h.y,f.x,f.y,g.x,g.y)}}Z.colorCommand||(Z.colorCommand=R=m.s(K).command),Z.thicknessCommand||(Z.thicknessCommand=F=m.ss(q).command),D&&(Z.dashedCommand||(Z.dashedCommand=W=m.sd([10,10],5).command)),t=(r=_[0][0]).localToLocal(_[0][1].x,_[0][1].y,G),m.mt(t.x,t.y),z.c().s(frame.darker).ss(1);for(o=0;o<_.length;o++){n=o,i=(o+1)%_.length,r=_[n][0],a=_[n][1],s=_[n][2],l=_[n][3],c=_[i][0],d=_[i][1],u=_[i][2],_[i][3],h=r.localToLocal(l.x,l.y,G),f=c.localToLocal(u.x,u.y,G),g=c.localToLocal(d.x,d.y,G);o!=_.length-1&&m.bt(h.x,h.y,f.x,f.y,g.x,g.y);t=r.localToLocal(a.x,a.y,G);var p=r.localToLocal(s.x,s.y,G);0==o&&(s.visible=0),0!=o&&z.mt(t.x,t.y).lt(p.x,p.y),o!=_.length-1&&z.mt(t.x,t.y).lt(h.x,h.y),o==_.length-1&&(l.visible=0)}D&&m.append(Z.dashedCommand),m.append(Z.thicknessCommand),m.append(Z.colorCommand)}k(),h.on("mousedown",function(e){if(!Z.lockControls)if(y={x:e.target.x,y:e.target.y},e.target.rect1){(t=e.target).startX=t.x,t.startY=t.y,t.rect1.startX=t.rect1.x,t.rect1.startY=t.rect1.y,t.rect2.startX=t.rect2.x,t.rect2.startY=t.rect2.y}else{var t,o=e.target,n=(t=o.ball).index,i=S;if(zot(_[n][4])||(i=_[n][4]),"straight"==i){var r=o.other,a=r.x-t.x,s=r.y-t.y;r.stickLength=Math.sqrt(Math.pow(a,2)+Math.pow(s,2))}}}),h.on("pressmove",function(e){if(!Z.lockControls){if(e.target.rect1){var t=(n=e.target).x-n.startX,o=n.y-n.startY;n.rect1.x=n.rect1.startX+t,n.rect1.y=n.rect1.startY+o,n.rect2.x=n.rect2.startX+t,n.rect2.y=n.rect2.startY+o}else{var n,i=e.target,r=i.other,a=(n=i.ball).index,s=S;if(zot(_[a][4])||(s=_[a][4]),"straight"==s||"mirror"==s){var l=i.x-n.x,c=i.y-n.y;if("mirror"==s)r.x=n.x-l,r.y=n.y-c;else{var d=Math.atan2(c,l),u=-r.stickLength*Math.cos(d+Math.PI),h=-r.stickLength*Math.sin(d+Math.PI);r.x=n.x-u,r.y=n.y-h}}}k()}}),h.on("pressup",function(e){if(!Z.lockControls){var t=e.target.x!=y.x||e.target.y!=y.y,o=new createjs.Event("change");if(e.target.rect1){o.controlType="bezierPoint";var n=e.target,i=n.mySet,r=n.rect1,a=n.rect2;r.x-=n.x,r.y-=n.y,a.x-=n.x,a.y-=n.y,i.x+=n.x,i.y+=n.y,n.x=0,n.y=0}else o.controlType="bezierHandle";t&&Z.dispatchEvent(o)}}),Z.changeControl=function(e,t,o,n,i,r,a,s,l){var c;if(c=zob(Z.changeControl,arguments,"index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY"))return c;if(zot(e))for(var d=0;d<_.length;d++)Z.changeControl(d,t,o,n,i,r,a,s);else{var u=_[e];"none"==(u[4]=t)?(zot(a)||(u[2].x=a),zot(s)||(u[2].y=s),u[2].pos(u[1].x,u[1].y),u[3].pos(u[1].x,u[1].y),u[1].parent.addChild(u[1])):(zot(o)||(u[2].x=o),zot(n)||(u[2].y=n),zot(i)||(u[3].x=i),zot(r)||(u[3].y=r),zot(a)||(u[1].x=a),zot(s)||(u[1].y=s),u[1].parent.addChildAt(u[1],0)),l&&(Z.update(),Z.stage&&Z.stage.update())}},Z.update=function(){return k(),Z},G.drag({onTop:!1}),V=G.on("mousedown",function(){y={x:G.x,y:G.y},function(){if(L){var e=Z.parent.numChildren-1;"Keyboard"==Z.parent.getChildAt(e).type&&e--,Z.parent.setChildIndex(Z,e)}}()}),H=G.on("pressmove",function(){h.x=G.x,h.y=G.y,o.x=G.x,o.y=G.y}),U=G.on("pressup",function(){var e=G.x!=y.x||G.y!=y.y;if(Z.x+=G.x,Z.y+=G.y,h.x=h.y=o.x=o.y=G.x=G.y=0,e){var t=new createjs.Event("change");t.controlType="move",Z.dispatchEvent(t)}Z.stage.update()}),Z.move||J(!0);Z.on("mousedown",function(){Z.toggle&&(X||(Z.showControls(),Z.dispatchEvent("controlsshow")))});Z.added(function(){Z.toggleStageEvent=Z.stage.on("stagemousedown",function(e){Z.toggle&&Z.stage&&X&&!Z.hitTestPoint(e.stageX,e.stageY,!1)&&(Z.hideControls(),Z.dispatchEvent("controlshide"))})}),Z.on("click",function(){Z.ctrlclick&&zimDefaultFrame.ctrlKey&&setTimeout(function(){Z.clone(!0).addTo(Z.stage).mov(0,100),Z.toggle&&(Z.hideControls(),Z.dispatchEvent("controlshide"));var e=new createjs.Event("change");e.controlType="move",Z.dispatchEvent(e),Z.stage.update()},50)}),Z.hideControls=function(){return h.visible=!1,o.visible=!1,X=!1,Z.stage&&Z.stage.update(),!Z.toggle&&Z.move&&J(),Z},B||Z.hideControls(),Z.showControls=function(){return h.visible=!0,o.visible=!0,X=!0,h.pos(G.x,G.y),o.pos(G.x,G.y),Z.addChildAt(G,0),Z.move&&!Z.toggle&&Q(),Z.stage&&Z.stage.update(),Z},Z.recordData=function(e){zot(e)&&(e=!1);var t={type:"Blob",index:Z.parent?Z.parent.getChildIndex(Z):-1,x:Z.x,y:Z.y,points:Z.recordPoints(),color:Z.color,thickness:Z.thickness,move:Z.move,toggle:Z.toggle,controlsVisible:X};return e?JSON.stringify(t):t},Z.setData=function(e,t){if(!zot(e)){if(t)try{e=JSON.parse(e)}catch(e){return}var o=e.index;zot(o)&&(o=-1),delete e.index;var n=e.points;for(var i in zot(n)||Z.setPoints(n),delete e.points,Z.num=n.length,e)Z[i]=e[i];return Z.parent&&Z.parent.setChildIndex(Z,o),Z.update(),Z}},Z.recordPoints=function(e){zot(e)&&(e=!1);var t=Z.points;if(e){if(!o){var o=new Je.Pane({container:Z.stage,width:500,height:500,drag:!0}),n=new Je.TextArea(400,400);n.centerReg(o)}n.text=JSON.stringify(t),o.show()}return t},Z.setPoints=function(e){for(var t,o,n=0;n<e.length;n++)t=_[n],o=e[n],zot(t)||(t[0].x=o[0],t[0].y=o[1],t[1].x=o[2],t[1].y=o[3],t[2].x=o[4],t[2].y=o[5],t[3].x=o[6],t[3].y=o[7],t[4]=o[8]);return Z.update(),Z},Z.clone=function(e){e?Z.colorCommand:Z.color,e?Z.colorCommand:Z.color;return Z.cloneProps(new Je.Squiggle(e?Z.colorCommand:Z.color,Z.lineWidth,Z.recordPoints(),M,I,S,j,h.visible,O,P,Z.toggle,Z.move,Z.ctrlclick,D))}}function Q(){r||(r=!0,G.drag({onTop:!1}),V=G.on("mousedown",V),H=G.on("pressmove",H),U=G.on("pressup",U))}function J(e){(e||r)&&(r=!1,G.noDrag(),G.off("mousedown",V),G.off("pressmove",H),G.off("pressup",U))}},Je.extend(Je.Squiggle,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Blob=function(e,t,o,A,E,M,I,S,j,B,O,n,P,i,D,L){var r;if(r=zob(Je.Blob,arguments,"color, borderColor, borderWidth, points, radius, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, toggle, move, ctrlclick, dashed, onTop",this))return r;z_d("53.5"),zot(E)&&(E=100),this.zimContainer_constructor(-E,-E,2*E,2*E),this.type="Blob",zot(D)&&(D=!1),!zot(t)&&zot(o)?o=1:!zot(o)&&zot(t)&&(t="black"),zot(e)&&(e=0<o?"rgba(0,0,0,0)":frame.green),e.style&&(this.colorCommand=e,e="black"),t&&t.style&&(this.borderColorCommand=t,t="black"),zot(A)&&(A=4);var Y="number"==typeof A?A:A.length;zot(M)&&(M=4*E/Y),zot(I)&&(I="straight"),zot(S)&&(S=!1),zot(j)&&(j=!0);var X=j;zot(B)&&(B=!1),zot(O)&&(O=Je.mobile()?20:10),zot(n)&&(n=!0),zot(P)&&(P=!0),zot(i)&&(i=!1),this.toggle=n,this.move=P,this.lockControlType=S,this.ctrlclick=i,this.num=Y,zot(L)&&(L=!0);var _,R,F,W,N,G,V,H,U,Z,K=this,q=(this.types=["mirror","straight","free","none"],e),Q=t,J=o,a=K.move;function s(){if(!((Y="number"==typeof A?A:A.length)<=0)){M=4*E/Y,V=K.shape=(new Je.Shape).addTo(K);var o=K.sticks=(new Je.Shape).addTo(K),p=V.graphics;p.c();var m=o.graphics;m.c();var e,t,n,i,r,a,s,l,c=O/10*8,d=O,u=Je.mobile(),h=K.controls=(new Je.Container).addTo(K).drag({onTop:!u});_=[],G=[];for(var f=0;f<Y;f++){if(n=(new Je.Container).addTo(h),"number"==typeof A){var g=zik(M);(t=new Je.Container(g,E).reg(g/2,E).addTo(K)).rotation=f/Y*360,a=new Je.Circle(c,frame.light,frame.dark,2).centerReg(t).pos(g/2,0),i=new Je.Rectangle(d,d,T(I),frame.dark,2).centerReg(t).pos(0,0),r=new Je.Rectangle(d,d,T(I),frame.dark,2).centerReg(t).pos(g,0);var z=t.localToLocal(a.x,a.y,h);a.x=z.x,a.y=z.y,a.addTo(n,null,!1);var v=t.localToLocal(i.x,i.y,h);i.x="none"==I?0:v.x-a.x,i.y="none"==I?0:v.y-a.y,i.addTo(n,null,!1);var b=t.localToLocal(r.x,r.y,h);r.x="none"==I?0:b.x-a.x,r.y="none"==I?0:b.y-a.y,r.addTo(n,null,!1),n.pos(a.x,a.y),a.x=0,a.y=0,"none"==I&&a.addTo(n,null,!1)}else s=(l=A[f])[8]?l[8]:I,n=(new Je.Container).addTo(h).pos(l[0],l[1]),a=new Je.Circle(c,frame.light,frame.dark,2).centerReg(n).pos(l[2],l[3]),i=new Je.Rectangle(d,d,T(s),frame.dark,2).centerReg(n,0).pos(l[4],l[5]),r=new Je.Rectangle(d,d,T(s),frame.dark,2).centerReg(n,0).pos(l[6],l[7]);G.push(a),a.mySet=n,a.rect1=i,a.rect2=r,a.index=f,u?a.on("mousedown",x):a.on("dblclick",C),i.ball=a,(i.other=r).ball=a,r.other=i,u&&(a.expand(),i.expand(),r.expand()),e=[n,a,i,r,l?l[8]:I],_.push(e)}var y,w=!1;k(),h.on("mousedown",function(e){if(!K.lockControls)if(y={x:e.target.x,y:e.target.y},e.target.rect1){(t=e.target).startX=t.x,t.startY=t.y,t.rect1.startX=t.rect1.x,t.rect1.startY=t.rect1.y,t.rect2.startX=t.rect2.x,t.rect2.startY=t.rect2.y}else{var t,o=e.target,n=(t=o.ball).index,i=I;if(zot(_[n][4])||(i=_[n][4]),"straight"==i){var r=o.other,a=r.x-t.x,s=r.y-t.y;r.stickLength=Math.sqrt(Math.pow(a,2)+Math.pow(s,2))}}}),h.on("pressmove",function(e){if(!K.lockControls){if(e.target.rect1){var t=(n=e.target).x-n.startX,o=n.y-n.startY;n.rect1.x=n.rect1.startX+t,n.rect1.y=n.rect1.startY+o,n.rect2.x=n.rect2.startX+t,n.rect2.y=n.rect2.startY+o}else{var n,i=e.target,r=i.other,a=(n=i.ball).index,s=I;if(zot(_[a][4])||(s=_[a][4]),"straight"==s||"mirror"==s){var l=i.x-n.x,c=i.y-n.y;if("mirror"==s)r.x=n.x-l,r.y=n.y-c;else{var d=Math.atan2(c,l),u=-r.stickLength*Math.cos(d+Math.PI),h=-r.stickLength*Math.sin(d+Math.PI);r.x=n.x-u,r.y=n.y-h}}}k()}}),h.on("pressup",function(e){if(!K.lockControls){var t=e.target.x!=y.x||e.target.y!=y.y,o=new createjs.Event("change");if(e.target.rect1){o.controlType="bezierPoint";var n=e.target,i=n.mySet,r=n.rect1,a=n.rect2;r.x-=n.x,r.y-=n.y,a.x-=n.x,a.y-=n.y,i.x+=n.x,i.y+=n.y,n.x=0,n.y=0}else o.controlType="bezierHandle";t&&K.dispatchEvent(o)}}),K.changeControl=function(e,t,o,n,i,r,a,s,l){var c;if(c=zob(K.changeControl,arguments,"index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY"))return c;if(zot(e)){for(var d=0;d<_.length;d++)K.changeControl(d,t,o,n,i,r,a,s);return K}var u=_[e];return"none"==(u[4]=t)?(zot(a)||(u[1].x=a),zot(s)||(u[1].y=s),u[2].pos(u[1].x,u[1].y),u[3].pos(u[1].x,u[1].y),u[1].parent.addChild(u[1])):(zot(a)||(u[1].x=a),zot(s)||(u[1].y=s),zot(o)||(u[2].x=o),zot(n)||(u[2].y=n),zot(i)||(u[3].x=i),zot(r)||(u[3].y=r),u[1].parent.addChildAt(u[1],0)),l&&(K.update(),K.stage&&K.stage.update()),K},K.update=function(){return k(),K},V.drag({onTop:!1}),H=V.on("mousedown",function(){y={x:V.x,y:V.y},function(){if(L){var e=K.parent.numChildren-1;"Keyboard"==K.parent.getChildAt(e).type&&e--,K.parent.setChildIndex(K,e)}}()}),U=V.on("pressmove",function(){h.x=V.x,h.y=V.y,o.x=V.x,o.y=V.y}),Z=V.on("pressup",function(){var e=V.x!=y.x||V.y!=y.y;if(K.x+=V.x,K.y+=V.y,h.x=h.y=o.x=o.y=V.x=V.y=0,e){var t=new createjs.Event("change");t.controlType="move",K.dispatchEvent(t)}K.stage.update()}),P||ee(!0);K.on("mousedown",function(){K.toggle&&(X||(K.showControls(),K.dispatchEvent("controlsshow")))});K.added(function(){K.toggleStageEvent=K.stage.on("stagemousedown",function(e){K.toggle&&K.stage&&X&&!K.hitTestPoint(e.stageX,e.stageY,!1)&&(K.hideControls(),K.dispatchEvent("controlshide"))})}),K.on("click",function(){K.ctrlclick&&zimDefaultFrame.ctrlKey&&setTimeout(function(){K.clone(!0).addTo(K.stage).mov(100),K.toggle&&(K.hideControls(),K.dispatchEvent("controlshide"));var e=new createjs.Event("change");e.controlType="move",K.dispatchEvent(e),K.stage.update()},50)}),K.hideControls=function(){return h.visible=!1,o.visible=!1,X=!1,K.stage&&K.stage.update(),!K.toggle&&K.move&&ee(),K},j||K.hideControls(),K.showControls=function(){return h.visible=!0,o.visible=!0,X=!0,h.pos(V.x,V.y),o.pos(V.x,V.y),K.addChildAt(V,0),K.move&&!K.toggle&&$(),K.stage&&K.stage.update(),K},K.recordData=function(e){zot(e)&&(e=!1);var t={type:"Blob",index:K.parent?K.parent.getChildIndex(K):-1,x:K.x,y:K.y,points:K.recordPoints(),color:K.color,borderColor:K.borderColor,borderWidth:K.borderWidth,move:K.move,toggle:K.toggle,controlsVisible:X};return e?JSON.stringify(t):t},K.setData=function(e,t){if(!zot(e)){if(t)try{e=JSON.parse(e)}catch(e){return}var o=e.index;zot(o)&&(o=-1),delete e.index;var n=e.points;for(var i in zot(n)||K.setPoints(n),delete e.points,this.num=n.length,e)K[i]=e[i];return K.parent&&K.parent.setChildIndex(K,o),K}},K.recordPoints=function(e){zot(e)&&(e=!1);var t=K.points;if(e){if(!o){var o=new Je.Pane({container:K.stage,width:500,height:500,drag:!0}),n=new Je.TextArea(400,400);n.centerReg(o)}n.text=JSON.stringify(t),o.show()}return t},K.setPoints=function(e){for(var t,o,n=0;n<e.length;n++)t=_[n],o=e[n],zot(t)||(t[0].x=o[0],t[0].y=o[1],t[1].x=o[2],t[1].y=o[3],t[2].x=o[4],t[2].y=o[5],t[3].x=o[6],t[3].y=o[7],t[4]=o[8]);return K.update(),K},K.clone=function(e){e?K.colorCommand:K.color,e?K.colorCommand:K.color;return K.cloneProps(new Je.Blob(e?K.colorCommand:K.color,e?K.borderColorCommand:K.borderColor,K.borderWidth,K.recordPoints(),E,M,I,S,h.visible,B,O,K.toggle,K.move,K.ctrlclick,D))}}function x(e){w?(e.preventDefault(),C(e)):(w=!0,setTimeout(function(){w=!1},300))}function C(e){if(!K.lockControlType){var t=e.target,o=_[t.index][4]?_[t.index][4]:I;Math.abs(t.rect1.x)<=2&&Math.abs(t.rect1.y)<=2&&Math.abs(t.rect2.x)<=2&&Math.abs(t.rect2.y)<=2&&(o="none"),"none"==o&&t.parent.addChildAt(t,0),"none"==(o=K.types[(K.types.indexOf(o)+(frame.shiftKey?-1:1)+K.types.length)%K.types.length])&&(t.rect1.x=t.rect1.y=t.rect2.x=t.rect2.y=0,t.parent.addChild(t),e.stopImmediatePropagation()),_[t.index][4]=o,t.rect1.color=T(o),t.rect2.color=T(o),k();var n=new createjs.Event("change");n.controlType="bezierSwitch",K.dispatchEvent(n),t.stage.update()}}function T(e){var t={mirror:frame.purple,free:frame.yellow,none:frame.blue};return t[e]?t[e]:frame.pink}function k(){p.c(),K.colorCommand||(K.colorCommand=R=p.f(q).command),(zot(J)||0<J)&&(zot(Q)&&zot(J)||(zot(Q)&&(Q="black"),K.borderColorCommand||(K.borderColorCommand=F=p.s(Q).command),K.borderWidthCommand||(K.borderWidthCommand=W=p.ss(J).command),D&&(K.borderDashedCommand||(K.borderDashedCommand=N=p.sd([10,10],5).command))));var e=(i=_[0][0]).localToLocal(_[0][1].x,_[0][1].y,V);p.mt(e.x,e.y),m.c().s(frame.darker).ss(1);for(var t=0;t<_.length;t++){var o=t,n=(t+1)%_.length,i=_[o][0],r=_[o][1],a=_[o][2],s=_[o][3],l=_[n][0],c=_[n][1],d=_[n][2],u=(_[n][3],i.localToLocal(s.x,s.y,V)),h=l.localToLocal(d.x,d.y,V),f=l.localToLocal(c.x,c.y,V);p.bt(u.x,u.y,h.x,h.y,f.x,f.y);e=i.localToLocal(r.x,r.y,V);var g=i.localToLocal(a.x,a.y,V);m.mt(e.x,e.y).lt(g.x,g.y),m.mt(e.x,e.y).lt(u.x,u.y)}p.append(K.colorCommand),D&&p.append(K.borderDashedCommand),K.borderWidthCommand&&p.append(K.borderWidthCommand),K.borderColorCommand&&p.append(K.borderColorCommand)}}function $(){a||(a=!0,V.drag({onTop:!1}),H=V.on("mousedown",H),U=V.on("pressmove",U),Z=V.on("pressup",Z))}function ee(e){(e||a)&&(a=!1,V.noDrag(),V.off("mousedown",H),V.off("pressmove",U),V.off("pressup",Z))}s(),Object.defineProperty(K,"move",{get:function(){return P},set:function(e){P!=e&&((P=e)?$():ee())}}),Object.defineProperty(K,"toggle",{get:function(){return n},set:function(e){n!=e&&((n=e)?K.move&&$():!X&&K.move&&ee())}}),Object.defineProperty(K,"controlsVisible",{get:function(){return X},set:function(e){(X=e)?K.showControls():K.hideControls()}});var l=B;Object.defineProperty(K,"lockControls",{get:function(){return l},set:function(e){(l=e)?(K.controls.mouseChildren=!1,K.controls.mouseEnabled=!1):(K.controls.mouseChildren=!0,K.controls.mouseEnabled=!0)}}),K.lockControls=l,Object.defineProperty(K,"color",{get:function(){return q},set:function(e){zot(e)&&(e="black"),q=e,R.style=q}}),Object.defineProperty(K,"borderColor",{get:function(){return Q},set:function(e){Q=e,F?F.style=Q:drawShape()}}),Object.defineProperty(K,"borderWidth",{get:function(){return J},set:function(e){0<e||(e=0),J=e,W&&0!=J?(W.width=J,D&&(N.segments=[20,10],N.offset=5)):drawShape()}}),Object.defineProperty(K,"points",{get:function(){for(var e,t,o=[],n=0;n<_.length;n++)t=_[n],e=[Je.decimals(t[0].x),Je.decimals(t[0].y),Je.decimals(t[1].x),Je.decimals(t[1].y),Je.decimals(t[2].x),Je.decimals(t[2].y),Je.decimals(t[3].x),Je.decimals(t[3].y)],t[4]&&"straight"!==t[4]&&e.push(t[4]),o.push(e);return o},set:function(e){K.dispose(),A=e,K.shape&&(K.shape.graphics.clear(),K.sticks.graphics.clear(),K.controls.noDrag(),K.removeAllChildren(),delete K.shape,delete K.sticks,delete K.controls),s(),K.lockControls=l}}),Object.defineProperty(K,"pointObjects",{get:function(){return _},set:function(e){zon&&zog("Blob() - pointObjects is read only - but its contents can be manipulated - use blob.update() after changes")}}),this.dispose=function(){return K.toggleStageEvent&&K.stage.off("stagemousedown",K.toggleStageEvent),this.zimContainer_dispose(),!0}},Je.extend(Je.Blob,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Label=function(e,n,t,o,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T){var k;if(k=zob(Je.Label,arguments,"text, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, lineWidth, lineHeight, fontOptions, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, backgroundCorner, backgroundDashed, padding, paddingHorizontal, paddingVertical, shiftHorizontal, shiftVertical",this))return k;z_d("54"),this.zimContainer_constructor(),this.type="Label";var A=Je.getDefaultFont();zot(e)&&(e=A.text?A.text:"LABEL");var E=!1;""===e&&(e=" ",E=!0),zot(n)&&(n=A.size?A.size:36),zot(t)&&(t=A.font?A.font:"arial"),zot(o)&&(o=A.color?A.color:"black"),zot(i)&&(i=A.rollColor?A.rollColor:o),zot(r)&&(r=A.shadowColor?A.shadowColor:-1),zot(a)&&(a=A.shadowBlur?A.shadowBlur:14),zot(s)&&(s=A.align?A.align:"left"),zot(l)&&(l=A.valign?A.valign:"top"),zot(u)&&(u=A.fontOptions?A.fontOptions:""),zot(f)&&zot(A.outlineColor)||!zot(g)||(g=A.outlineWidth?A.outlineWidth:Math.round(.2*n)),zot(g)&&zot(A.outlineWidth)||!zot(f)||(f=A.outlineColor?A.outlineColor:"#000000"),zot(g)&&(g=A.outlineWidth?A.outlineWidth:0),zot(y)&&(y=A.padding?A.padding:10),zot(w)&&(w=y),zot(x)&&(x=y),zot(C)&&(C=A.shiftHorizontal?A.shiftHorizontal:0),zot(T)&&(T=A.shiftVertical?A.shiftVertical:0);var M=this;this.mouseChildren=!1;var I=this.label=new createjs.Text(String(e),u+" "+n+"px "+t,o);if(I.textAlign=s,I.lineWidth=c,I.lineHeight=d,I.textBaseline="alphabetic",0<g){var S=this.outlineLabel=I.clone();S.color=f,S.outline=g,this.addChild(S)}function j(){var e,t=I.getBounds();if("top"==l?(I.y=n-n/6,S&&(S.y=n-n/6),e=0):"center"==l||"middle"==l?(e=-t.height/2,I.y=.3*n,S&&(S.y=.3*n)):e=-t.height,h){var o=h.getBounds();M.setBounds(o.x,o.y,o.width,o.height)}else zot(p)?(M.setBounds(t.x,e,t.width,t.height),B.graphics.c().f("black").r(M.getBounds().x,M.getBounds().y,M.getBounds().width,M.getBounds().height)):(M.setBounds(t.x,e,t.width,t.height),M.removeChild(M.background),M.background=new Je.Rectangle(M.getBounds().width+2*w,M.getBounds().height+2*x,p,m,z,v,null,b),Je.center(M.background,M,0));Je.center(I,M),I.y+=n/32,S&&(Je.center(S,M,M.numChildren-2),S.y+=n/32),I.x+=C,I.y+=T}if(-1!=r&&0<a&&(I.shadow=new createjs.Shadow(r,3,3,a)),this.addChild(I),zot(h)&&zot(p)){var B=new createjs.Shape;M.hitArea=B}j(),zot(h)||(this.backing=h,Je.center(h,this,0)),Object.defineProperty(M,"text",{get:function(){return" "==I.text&&E?"":I.text},set:function(e){E=!1,""===e&&(e=" ",E=!0),I.text=String(e),S&&(S.text=String(e)),j()}}),Object.defineProperty(M,"color",{get:function(){return o},set:function(e){i==o&&(i=e),o=e,I.color=o,Je.OPTIMIZE||!zns&&OPTIMIZE||!M.stage||M.stage.update()}}),Object.defineProperty(M,"outlineColor",{get:function(){return f},set:function(e){f=e,S&&(S.color=f),Je.OPTIMIZE||!zns&&OPTIMIZE||!M.stage||M.stage.update()}}),Object.defineProperty(M,"rollColor",{get:function(){return i},set:function(e){i=e}}),this._enabled=!0,Object.defineProperty(M,"enabled",{get:function(){return M._enabled},set:function(e){be(M,e),I.color=o,M.mouseChildren=!1,Je.OPTIMIZE||!zns&&OPTIMIZE||!M.stage||M.stage.update()}}),this.showRollColor=function(e){return zot(e)&&(e=!0),I.color=e?i:o,M.stage&&M.stage.update(),M},this.on("mouseover",function(e){M.showRollColor()}),this.on("mouseout",function(e){M.showRollColor(!1)}),this.clone=function(){return M.cloneProps(new Je.Label(M.text,n,t,o,i,r,a,s,l,c,d,u,zot(h)?null:h.clone(),f,g,p,m,z,v,b,y,w,x,C,T))}},Je.extend(Je.Label,Je.Container,"clone","zimContainer"),Je.Button=function(n,i,t,r,a,o,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A,E,M,I,S,j,B,O,P,D,L,Y,X,_){var e;if(e=zob(Je.Button,arguments,"width, height, label, color, rollColor, borderColor, borderRollColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, flatBottom, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, wait, waitTime, waitColor, rollWaitColor, waitTextColor, rollWaitTextColor, waitModal, waitEnabled, waitBacking, rollWaitBacking, waitIcon, rollWaitIcon",this))return e;z_d("55");var R=Je.getDefaultFont();zot(n)&&(n=200),zot(i)&&(i=60),this.zimContainer_constructor(n,i),this.type="Button",zot(r)&&(r="#C60"),zot(a)&&(a="#F93"),zot(S)&&(S=r),zot(j)&&(j=a),zot(l)&&(l=null),0<l&&zot(o)&&(o="#333"),zot(s)&&(s=o),zot(c)&&(c=20),zot(d)&&(d="rgba(0,0,0,.3)"),zot(u)&&(u=14),zot(h)&&(h=0),zot(f)&&(f=0),zot(g)&&(g=0),zot(p)&&(p=!1),zot(t)&&(t=zot(y)?"PRESS":"");var F=(!zot(x)||!zot(C)||!zot(T)||!zot(k)||!zot(A))&&zot(M)&&zot(L)&&zot(Y);F&&zot(E)&&(E=Je.mobile()?"mousedown":"click"),"string"!=typeof t&&"number"!=typeof t||(t=new Je.Label(t,R.size?R.size:36,null,R.color?R.color:"white",null,null,null,"center","middle")),zot(b)&&(b=!1),this.rollPersist=b,zot(m)&&(m=!1),zot(x)||"Label"!=x.type||zon&&zog("ZIM Button() - do not pass Label to toggle parameter - just pass a String");var W=this;this.mouseChildren=!1,this.cursor="pointer",W.focus=!1,W.rolled=!1,zot(z)?W.backing=new Je.Rectangle(n,i,r,null,null,c,p,m).centerReg(null,null,!1):W.backing=z,W.rollBacking=v,W.waitBacking=L,W.rollWaitBacking=Y,W.toggleBacking=C,W.rollToggleBacking=T;for(var N,G,V=["backing","rollBacking","toggleBacking","rollToggleBacking","waitBacking","rollWaitBacking"],H=0;H<V.length;H++)N=V[H],(G=W[N])&&("Pattern"==G.type?G=U(N,G):-1!=d&&0<u&&(G.shadow=new createjs.Shadow(d,3,3,u)),G.x=n/2,G.y=i/2);function U(e,t){(W[e]=new Container(n,i).centerReg(null,null,!1),-1!=d&&0<u)&&(new Je.Rectangle(n-2,i-2,"#666",null,null,c,p).center(W[e]).shadow=new createjs.Shadow(d,3,3,u));var o=new Je.Rectangle(n,i,0<=e.indexOf("roll")?a:r,null,null,c,p).addTo(W[e]);return t.centerReg(o),t.setMask(o.shape),W[e].pattern=t,W[e]}W.addChild(W.backing),l&&(W.border=new Je.Rectangle(n,i,"rgba(0,0,0,0)",o,l,c,p),W.addChild(W.border)),W.icon=y,W.rollIcon=w,W.waitIcon=X,W.rollWaitIcon=_,W.toggleIcon=k,W.rollToggleIcon=A;var Z=["icon","rollIcon","toggleIcon","rollToggleIcon","waitIcon","rollWaitIcon"];for(H=0;H<Z.length;H++){var K=Z[H],q=W[K];q&&(q.x=n/2,q.y=i/2)}W.icon&&W.addChild(W.icon);var Q,J,$=p?0:c;if(0<f){var ee=new createjs.Shape;ee.graphics.lf(["rgba(255,255,255,"+f+")","rgba(0,0,0,"+f+")"],[0,1],0,0,0,i-l),ee.graphics.rc(l/2,l/2,n-l,i-l,c,c,$,$),this.addChild(ee)}if(0<g){var te=new createjs.Shape;te.graphics.f("rgba(255,255,255,"+g+")"),te.graphics.rc(l/2,l/2,n-l,(i-l)/2,c,c,0,0),te.graphics.f("rgba(0,0,0,"+g+")"),te.graphics.rc(l/2,i/2,n-l,(i-l)/2,0,0,$,$),this.addChild(te)}function oe(){(J=new createjs.Shape).graphics.f("#000").r(-h,-h,n+2*h,i+2*h),W.hitArea=Q=J}if(0<h&&oe(),this.addChild(t),t.center(this),t.y+=1,this.label=t,this.toggled=!1,F){var ne=t.text;this.on(E,function(){W.toggled=!W.toggled,ie()})}function ie(){W.toggled?(zot(x)||(W.text=x),W.rolled?(W.rollToggleBacking?me("rollToggleBacking",W.rollToggleBacking):W.toggleBacking&&me("toggleBacking",W.toggleBacking),W.rollToggleIcon?me("rollToggleIcon",W.rollToggleIcon):W.toggleIcon&&me("toggleIcon",W.toggleIcon)):(W.toggleBacking&&me("toggleBacking",W.toggleBacking),W.toggleIcon&&me("toggleIcon",W.toggleIcon))):(W.text=ne,re()),W.stage&&W.stage.update()}function re(){W.rolled?(zot(z)&&!W.rollBacking&&(W.backing.color=a),W.rollBacking?me("rollBacking",W.rollBacking):W.backing&&me("backing",W.backing),W.rollIcon?me("rollIcon",W.rollIcon):W.icon?me("icon",W.icon):me("icon",null)):(zot(z)&&(W.backing.color=r),W.backing&&me("backing",W.backing),W.icon?me("icon",W.icon):me("icon",null))}var ae,se,le,ce,de=!(this.toggle=function(e){return F?(zot(e)?W.toggled=!W.toggled:W.toggled=e,ie()):zon&&zog("zim.Button() - can't toggle with wait parameters provided"),W}),ue=W.waiting=!1,he=W.label.color,fe=W.label.rollColor,ge=this.on("mousedown",function(){de=!0,pe()});function pe(){zot(M)&&zot(L)&&zot(Y)||W.waiting||(ue=!0,zot(D)&&(D=!0),P&&(ce=W.stage.on("stagemousedown",function(e){W.hitTestPoint(e.stageX,e.stageY)||W.clearWait()},null,!0)),setTimeout(function(){W.waiting=!0},50),se=t.text,zot(B)||(W.label.color=B),zot(O)||(W.label.rollColor=O),le=W.enabled,!D&&W.enabled&&(W.enabled=!1),zot(M)||(W.text=M),W.rolled?(zot(z)&&!W.rollWaitBacking&&(W.backing.color=j),W.rollWaitBacking?me("rollWaitBacking",W.rollWaitBacking):W.waitBacking&&me("waitBacking",W.waitBacking),W.rollWaitIcon?me("rollWaitIcon",W.rollWaitIcon):W.waitIcon&&me("waitIcon",W.waitIcon)):(zot(z)&&!W.waitBacking&&(W.backing.color=S),W.waitBacking&&me("waitBacking",W.waitBacking),W.waitIcon&&me("waitIcon",W.waitIcon)),zot(I)&&(I=3e4),ae&&ae.clear(),ae=timeout(I,function(){W.enabled||(W.enabled=le),W.clearWait(),W.dispatchEvent("waited")}),W.stage&&W.stage.update())}function me(e,t){if(0<=e.indexOf("con")){for(var o=0;o<Z.length;o++){var n=Z[o],i=W[n];W.removeChild(i)}W[e]&&W.addChildAt(W[e],1)}else{if(!W[e])return;for(o=0;o<V.length;o++){var r=V[o],a=W[r];W.removeChild(a)}W[e]&&W.addChildAt(W[e],0)}}function ze(){W.rolled=!1,ue||W.waiting?(zot(z)&&zot(W.waitBacking)&&(W.backing.color=zot(S)?r:S),W.waitBacking?me("waitBacking",W.waitBacking):me("backing",W.backing),W.waitIcon?me("waitIcon",W.waitIcon):W.icon?me("icon",W.icon):me("icon")):W.toggled&&F?(zot(z)&&zot(W.toggleBacking)&&(W.backing.color=r),W.toggleBacking?me("toggleBacking",W.toggleBacking):me("backing",W.backing),W.toggleIcon?me("toggleIcon",W.toggleIcon):W.icon?me("icon",W.icon):me("icon")):(zot(z)&&(W.backing.color=r),me("backing",W.backing),W.icon?me("icon",W.icon):me("icon")),W.border&&(W.border.borderColor=o),W.label.showRollColor(!1),W.stage&&W.stage.update()}function ve(e,t){return zot(e)||(W.contains(W[e])&&(W.removeChild(W[e]),t&&W.addChildAt(t,0<=e.indexOf("con")?W.numChildren-1:0),W.stage&&W.stage.update()),t?(zot(z)&&"backing"==e&&(z=t),"Pattern"==t.type&&(t=U(e,t)),W[e]=t,W[e].x=n/2,W[e].y=i/2):W[e]=null),W}this.wait=function(){pe()},this.clearWait=function(){return ae&&(ce&&W.stage.off("stagemousedown",ce),ae.clear(),W.text=se,re(),W.label.color=he,W.label.rollColor=fe,setTimeout(function(){W.waiting=!1},55),ue=!1,W.stage&&W.stage.update()),W},this.removeWait=function(){return W.clearWait(),M=null,W.waitBacking=null,W.rollWaitBacking=null,W.off("mousedown",ge),W},this.on("pressup",function(){de=!1,W.rollPersist&&!W.rolled&&ze()}),this.on("mouseover",function(e){W.rolled=!0,ue?(zot(z)&&zot(W.rollWaitBacking)&&(W.backing.color=zot(j)?a:j),me("rollWaitBacking",W.rollWaitBacking),W.rollWaitIcon&&me("rollWaitIcon",W.rollWaitIcon)):F&&W.toggled?(zot(z)&&zot(W.rollToggleBacking)&&(W.backing.color=a),me("rollToggleBacking",W.rollToggleBacking),W.rollToggleIcon&&me("rollToggleIcon",W.rollToggleIcon)):(zot(z)&&(W.backing.color=a),me("rollBacking",W.rollBacking),W.rollIcon&&me("rollIcon",W.rollIcon));W.border&&(W.border.borderColor=s);W.label.showRollColor(),W.stage&&W.stage.update()}),this.on("mouseout",function e(t){W.off("mouseout",e);W.rollPersist&&de||ze()}),Object.defineProperty(W,"text",{get:function(){return" "==t.text?"":t.text},set:function(e){t.text=e,t.center(this),t.y+=1}}),Object.defineProperty(W,"color",{get:function(){return r},set:function(e){r=e,W.backing.color?W.backing.color=r:zon&&zog("zim.Button - backing has no color property"),Je.OPTIMIZE||!zns&&OPTIMIZE||!W.stage||W.stage.update()}}),Object.defineProperty(W,"rollColor",{get:function(){return a},set:function(e){a=e,W.rollBacking&&(W.rollBacking.color=e)}}),Object.defineProperty(W,"borderColor",{get:function(){return o},set:function(e){o=e,W.backing.borderColor&&(W.backing.borderColor=e,W.border&&(W.border.borderColor=e))}}),Object.defineProperty(W,"borderRollColor",{get:function(){return s},set:function(e){s=e}}),Object.defineProperty(W,"hitPadding",{get:function(){return h},set:function(e){0==(h=e)?Q&&(this.hitArea=null):oe()}}),this._enabled=!0,Object.defineProperty(W,"enabled",{get:function(){return W._enabled},set:function(e){be(W,e),W.mouseChildren=!1,t.color=t.color,Je.OPTIMIZE||!zns&&OPTIMIZE||!W.stage||W.stage.update()}}),this.setBacking=function(e,t){ve(e,t)},this.setIcon=function(e,t){ve(e,t)},this.clone=function(){var e=new Je.Button(n,i,t.clone(),r,a,o,s,l,c,d,u,h,f,g,p,m,zot(z)?null:W.backing.clone(),zot(v)?null:W.rollBacking.clone(),b,zot(y)?null:y.clone(),zot(w)?null:w.clone(),x,zot(C)?null:C.clone(),zot(T)?null:T.clone(),zot(k)?null:k.clone(),zot(A)?null:A.clone(),E,M,I,S,j,B,O,P,D,zot(L)?null:L.clone(),zot(Y)?null:Y.clone(),zot(X)?null:X.clone(),zot(_)?null:_.clone());return W.cloneProps(e)}},Je.extend(Je.Button,Je.Container,"clone","zimContainer",!1),Je.CheckBox=function(t,o,e,n,i,r){var a;if(a=zob(Je.CheckBox,arguments,"size, label, startChecked, color, margin, indicatorType",this))return a;z_d("56"),this.zimContainer_constructor(),this.type="CheckBox";var s=Je.getDefaultFont();zot(t)&&(t=60),zot(o)&&(o=null),"string"!=typeof o&&"number"!=typeof o||(o=new Je.Label({text:o,size:s.size?s.size:5*t/6,color:s.color?s.color:n,valign:"center"}));var l=!zot(e)&&e;zot(n)&&(n="#111"),zot(i)&&(i=10),"box"!=r&&"square"!=r&&"x"!=r&&(r="check"),this.setBounds(-i,-i,t+2*i,t+2*i);var c=this;this.cursor="pointer";var d=new Je.Shape,u=d.graphics;u.f("rgba(255,255,255,.5)").r(0,0,t,t),u.s(n).ss(t/10).r(t/7,t/7,t-t/7*2,t-t/7*2),this.addChild(d);var h=t;o&&(this.addChild(o),o.x=1.3*t+i,o.y=t/2,this.label=o,this.setBounds(-i,-i,t+3*i+o.getBounds().width,Math.max(t+2*i,o.getBounds().height)),h=o.x+o.width);var f=new Je.Shape;(u=f.graphics).f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,h+2*i,this.getBounds().height),this.hitArea=f;var g=new Je.Shape,p=g.graphics,m="#000";"check"==r?p.f(m).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"):"box"==r||"square"==r?p.f(m).dr(-35,-35,70,70):p.f(m).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg");g.setBounds(-47.5,-47.5,95,95);var z=t/161;g.scaleX=g.scaleY=z,g.alpha=.9,g.x=t/2,g.y=t/2,l&&this.addChild(g),this.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(e){l=!l,c.setChecked(l),c.dispatchEvent("change")}),Object.defineProperty(c,"checked",{get:function(){return l},set:function(e){c.setChecked(e)}}),Object.defineProperty(c,"text",{get:function(){if(o)return o.text},set:function(e){o&&(o.text=e,Je.OPTIMIZE||!zns&&OPTIMIZE||!c.stage||c.stage.update())}}),Object.defineProperty(g,"color",{get:function(){return m},set:function(e){l&&c.removeChild(g),g=new createjs.Shape,p=g.graphics,m=e,p.f(m).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"),g.scaleX=g.scaleY=z,g.alpha=.9,g.x=t/2,g.y=t/2,l&&c.addChild(g),Je.OPTIMIZE||!zns&&OPTIMIZE||!c.stage||c.stage.update()}}),Object.defineProperty(c,"check",{get:function(){return g},set:function(e){zog("ZIM CheckBox - check is read only")}}),this._enabled=!0,Object.defineProperty(c,"enabled",{get:function(){return c._enabled},set:function(e){be(c,e)}}),this.setChecked=function(e){return zot(e)&&(e=!0),(l=e)?c.addChild(g):c.removeChild(g),Je.OPTIMIZE||!zns&&OPTIMIZE||!c.stage||c.stage.update(),c},this.clone=function(){return c.cloneProps(new Je.CheckBox(t,o?o.clone():"",e,n,i,r))}},Je.extend(Je.CheckBox,Je.Container,"clone","zimContainer",!1),Je.RadioButtons=function(l,a,s,c,d,u,o){var e;if(e=zob(Je.RadioButtons,arguments,"size, buttons, vertical, color, spacing, margin, always",this))return e;z_d("57"),this.zimContainer_constructor(),this.type="RadioButtons";var h=Je.getDefaultFont();zot(l)&&(l=60),l=Math.max(5,l),zot(a)&&(a=["A","B","C"]),zot(s)&&(s=!0),zot(c)&&(c="#111"),zot(d)&&(d=s?.2*l:l),zot(u)&&(u=l/5);var f,g=this;if(this.cursor="pointer",this.labels=[],this.dots=[],"string"==typeof a){var t=a;a=[];for(var n=0;n<t.length;n++)a.push({label:t[n]})}var p=new Je.Container;function i(e){var t=p.getChildIndex(e.target);o&&g.selectedIndex==t||(g.setSelected(t),g.dispatchEvent("change"))}this.addChild(p),function(){for(var e,t,o=!1,n=a.length-1;0<=n;n--)(e=a[n]).selected&&!0===e.selected&&(o?e.selected="false":(o=!0,g.id=e.id));p.removeAllChildren(),g.buttons=[];for(var i=0,n=0;n<a.length;n++){if("string"==typeof(e=a[n])||"number"==typeof e){var r={selected:!1,label:new Je.Label({text:e,size:h.size?h.size:5*l/6,color:h.color?h.color:c,valign:"center"})};e=r}(e.label&&"string"==typeof e.label||"number"==typeof e.label)&&(e.label=new Je.Label({text:e.label,size:h.size?h.size:5*l/6,color:h.color?h.color:c,valign:"center"})),g.labels.push(e.label),e.index=n,a[n]=e,(t=m(e.selected,e.label)).type="RadioButton",(t.obj=e).selected&&(f=t.obj),p.addChild(t),s?(t.y=i,i+=t.getBounds().height+d):(t.x=i,i+=t.getBounds().width+d)}}();for(var r=0;r<p.numChildren;r++)p.getChildAt(r).on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",i);function m(e,t){var o=new Je.Container;g.buttons.push(o),o.mouseChildren=!1,o.setBounds(-u,-u,l+2*u,l+2*u);var n=new Je.Shape,i=n.graphics;i.f("rgba(255,255,255,.5)").dc(l/2,l/2,l/1.85),i.s(c).ss(l/9).dc(l/2,l/2,l/2-l/2/5),o.addChild(n);var r=o.check=new Je.Circle(l/5.2,"rgba(0,0,0,.7)");g.dots.push(r),r.mouseEnabled=!1,r.alpha=.95,r.regX=r.regY=-l/2;var a=l;t&&(o.addChild(t),t.x=o.getBounds().width,t.y=l/2,o.setBounds(-u,-u,l+2*u+t.getBounds().width,Math.max(l+2*u,t.getBounds().height)),a=t.x+t.width,o.text=t.text),e&&(o.addChild(r),g.label=t,g.label&&(g.text=t.text));var s=new Je.Shape;return(i=s.graphics).f("rgba(0,0,0,.01)").r(o.getBounds().x,o.getBounds().y,a+2*u,o.getBounds().height),o.hitArea=s,o}this.getBounds()||this.setBounds(0,0,l,l),this.setBounds(-u,-u,this.getBounds().width+u,this.getBounds().height+u),this.setSelected=function(e){if(zot(e)&&(e=-1),-1==e||p.getChildAt(e)){for(var t,o=0;o<p.numChildren;o++)(t=p.getChildAt(o)).removeChild(t.check);if(0<=e){t=p.getChildAt(e);var n=-2;f&&(n=f.index),f=t.obj}return-1==e||n==f.index?(f=null,g.id=null,g.label=null,g.text=""):(t.addChild(t.check),g.id=f.id,g.label=f.label,g.label&&(g.text=g.label.text)),Je.OPTIMIZE||!zns&&OPTIMIZE||!g.stage||g.stage.update(),g}},Object.defineProperty(g,"selected",{get:function(){return f},set:function(e){zog("ZIM RadioButton - selected is read only")}}),Object.defineProperty(g,"selectedIndex",{get:function(){return f?f.index:-1},set:function(e){var t=e;o&&g.selectedIndex==t||g.setSelected(t)}}),this._enabled=!0,Object.defineProperty(g,"enabled",{get:function(){return g._enabled},set:function(e){be(g,e)}}),this.clone=function(){for(var e=Je.copy(a),t=0;t<e.length;t++)e[t].label=e[t].label.clone();return g.cloneProps(new Je.RadioButtons(l,e,s,c,d,u,o))}},Je.extend(Je.RadioButtons,Je.Container,"clone","zimContainer",!1),Je.Pane=function(a,s,n,i,r,l,c,d,u,h,f,g,p,m,z,v,e,b,y,w,x,C){var t;if(t=zob(Je.Pane,arguments,"width, height, label, color, drag, resets, modal, corner, backdropColor, shadowColor, shadowBlur, center, displayClose, backdropClose, backing, fadeTime, container, titleBar, titleBarColor, titleBarHeight, close, closeColor",this))return t;z_d("58"),this.zimContainer_constructor(),this.type="Pane";var o=Je.getDefaultFont(),T="zim display - Pane(): Please pass in a reference to a container with bounds set as first parameter";if(zot(e)){if(!zimDefaultFrame)return void zog(T);e=zimDefaultFrame.stage}else{if(!e.getBounds)return void zog(T);if(zot(e.getStage))return void zog("zim display - Pane(): The container must have a stage property")}zot(a)&&(a=200),zot(s)&&(s=200),zot(n)&&(n=null),"string"!=typeof n&&"number"!=typeof n||(n=new Je.Label(n,o.size?o.size:40,null,o.color?o.color:"black")),zot(i)&&(i="white"),zot(r)&&(r=!1),zot(l)&&(l=!0),zot(c)&&(c=!0),zot(d)&&(d=20),zot(u)&&(u="rgba(0,0,0,.2)"),zot(h)&&(h="rgba(0,0,0,.3)"),zot(f)&&(f=20),zot(g)&&(g=!0),zot(p)&&(p=!0),r&&(p=!1),zot(m)&&(m=!0),zot(v)&&(v=0);var k=this.backdrop=new Je.Shape;k.type="CreateJS_Shape";var A=k.graphics;A.f(u),A.drawRect(-5e3,-5e3,1e4,1e4),this.setBounds(-a/2,-s/2,a,s);var E=this;E.container=e,k.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",m?O:function(e){e.stopImmediatePropagation()});var M,I,S,j,B=new Je.Dictionary(!0);function O(e){D(),E.container.stage.update(),E.dispatchEvent("close"),e.stopImmediatePropagation()}if(k.on("mousedown",function(e){e.stopImmediatePropagation()}),c&&this.addChild(k),zot(z))M=this.display=new Je.Rectangle({width:a,height:s,color:i,corner:d});else{if("Pattern"==z.type){var P=z;M=new Je.Rectangle(a,s,i,null,null,d),P.centerReg(M),P.setMask(M.shape)}else M=z;E.display=M}(p&&(M.cursor="pointer",M.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",O)),-1!=h&&0<f&&(M.shadow=new createjs.Shadow(h,8,8,f)),M.on("click",function(e){e.stopImmediatePropagation()}),this.resetX,this.resetY,r)&&(M.cursor="pointer",M.on("mousedown",function(e){isNaN(E.resetX)&&(E.resetX=E.x),isNaN(E.resetY)&&(E.resetY=E.y),I=e.stageX-E.x,S=e.stageY-E.y,M.cursor="pointer"}),M.on("pressmove",function(e){var t,o,n,i=(t=e.stageX-I,o=e.stageY-S,t=Math.max(a/2,Math.min(E.container.getBounds().width-a/2,t)),o=Math.max(s/2,Math.min(E.container.getBounds().height-s/2,o)),{x:t,y:o});E.x=i.x,E.y=i.y;for(var r=0;r<E.numChildren;r++)(n=E.getChildAt(r)).constructor!=Je.TextArea&&n.constructor!=Je.Loader||n.resize();E.container.stage.update()}),this.on("pressup",function(e){M.cursor="pointer",E.container.stage.update()}));if(M.centerReg(this),n&&(this.addChild(n),Je.center(n,this),this.label=n,this.text=n.text,n.mouseEnabled=!1),!zot(b)){"string"==typeof b&&(b=new Je.Label(b)),titleBarLabel=E.titleBarLabel=b,zot(w)&&(w=1.5*titleBarLabel.height),zot(y)&&(y="rgba(0,0,0,.2)"),E.titleBar=b=new Je.Container(a,w).centerReg(E).mov(0,-s/2+w/2),b.mouseEnabled=!1,b.mouseChildren=!1;E.titleBar.backing=new Je.Rectangle(a,w,y,null,null,.95*d,!0).addTo(b);titleBarLabel.center(b).pos(Math.max(d/2,10))}x&&(zot(C)&&(C="#555"),(x=E.close=new Je.Shape(-40,-40,80,80)).graphics.f(C).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),b?x.addTo(E).scaleTo(b,null,50).mov(a/2-Math.max(d/2,10)-x.width/2,-s/2+w/2).expand(40):x.addTo(E).sca(.3).mov(a/2-x.width-3,-s/2+x.height).expand(40),x.cursor="pointer",x.expand(),x.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",O));function D(){function e(){var e;E.container.removeChild(E);for(var t=0;t<E.numChildren;t++)if((e=E.getChildAt(t)).constructor==Je.TextArea||e.constructor==Je.Loader){var o={obj:e,depth:E.getChildIndex(e)};B.add(e,o)}for(t=E.numChildren-1;0<=t;t--)(e=E.getChildAt(t)).constructor!=Je.TextArea&&e.constructor!=Je.Loader||E.removeChild(e);if(Je.OPTIMIZE||!zns&&OPTIMIZE||E.container.stage.update(),l&&(isNaN(E.resetX)||(E.x=E.resetX),isNaN(E.resetY)||(E.y=E.resetY)),E.zimAccessibility){var n=E.zimAccessibility;n.resize(E),j?j.focus():E.zimTabTag.nextSibling.focus(),setTimeout(function(){n.talk("Pane has been closed.")},50)}}0<v?E.animate({obj:{alpha:0},time:v,call:e}):e()}Object.defineProperty(E,"text",{get:function(){return" "==n.text?"":n.text},set:function(e){n.text=e}}),this._enabled=!0,Object.defineProperty(E,"enabled",{get:function(){return E._enabled},set:function(e){be(E,e)}}),this.hide=function(){return D(),E.toggled=!1,E},this.show=function(){g&&isNaN(E.resetX)&&(E.x=E.container.getBounds().width/2,E.y=E.container.getBounds().height/2),E.container.addChild(E);for(var e=0;e<B.length;e++)E.addChildAt(B.values[e].obj,B.values[e].depth);if(0<v?(E.alpha=0,E.animate({alpha:1},v)):E.container.stage&&E.container.stage.update(),E.zimAccessibility){var t=E.zimAccessibility;setTimeout(function(){t.activatedObject&&(j=t.activatedObject.zimTabTag)},50),t.resize(E),t.tabIndex=E.zimTabIndex}return E.toggled=!0,E},this.toggle=function(e){return!0===e?E.show():!1===e?E.hide():E.container.contains(E)?E.hide():E.show(),E},this.clone=function(){var e=n.x,t=n.y,o=E.cloneProps(new Je.Pane(a,s,n.clone(),i,r,l,c,d,u,h,f,g,p,m,zot(z)?z.clone():null,v,E.container,b,y,w,x,C));return o.label.x=e,o.label.y=t,o}},Je.extend(Je.Pane,Je.Container,"clone","zimContainer",!1),Je.Window=function(d,u,o,n,h,i,f,g,p,m,e,r,a,z,v,s,l,c,b,y,w,x,C,t,T,k,A,E,M,I,S,j){var B;if(B=zob(Je.Window,arguments,"width, height, color, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, slide, slideDamp, slideSnap, interactive, shadowColor, shadowBlur, paddingHorizontal, paddingVertical, scrollWheel, damp, titleBar, titleBarColor, titleBarHeight, drag, boundary, close, closeColor",this))return B;z_d("58.1"),this.zimContainer_constructor(),this.type="Window";var O=Je.getDefaultFont();zot(d)&&(d=300),zot(u)&&(u=200),zot(o)&&(o="#333"),zot(n)&&(n="#999"),zot(h)&&(h=1),zot(i)&&(i=0),zot(f)&&(f=0),zot(g)&&(g=!0),zot(p)&&(p=!0),zot(m)&&(m=!1),zot(e)&&(e=n),zot(r)&&(r=.3),zot(a)&&(a=!0),zot(z)&&(z=!0),zot(v)&&(v=!0),m&&(a=!1),zot(s)&&(s=!0),zot(l)&&(l=.6),zot(c)&&(c="vertical"),zot(b)&&(b=!0),zot(y)&&(y="rgba(0,0,0,.3)"),zot(w)&&(w=20),zot(C)&&(C=i),zot(x)&&(x=i),zot(t)&&(t=!0);var P=this;this.scrollX=this.scrollY=this.scrollXMax=this.scrollYMax=0;var D=this.backing=new Je.Shape;this.addChild(D);var L=new createjs.Shape,Y=L.graphics;this.addChild(L);var X=this.content=new Je.Container;if(this.addChild(X),X.mask=L,!b)var _=new createjs.Shape;if(0<h){var R=new createjs.Shape;this.addChild(R)}var F=k?0:f;function W(){P.setBounds(0,0,d,u),D.graphics.c().f(o).rc(0,0,d,u,F,F,f,f),-1!=y&&0<w&&(D.shadow=new createjs.Shadow(y,8,8,w)),0<h&&R.graphics.c().s(n).ss(h).rc(0,0,d,u,F,F,f,f)}W();var N,G,V,H,U,Z,K,q,Q,J,$=this.scrollBar={};if($.color=e,$.size=6,$.minSize=2*$.size,$.spacing=3.5+h/2,$.margin=0,$.corner=$.size/2,$.showTime=500,$.fadeTime=3e3,p){var ee=$.horizontal=new Je.Shape,te=ee.graphics;ee.alpha=r,this.addChild(ee),m&&ee.drag({localBounds:!0});var oe=$.vertical=new Je.Shape,ne=oe.graphics;oe.alpha=r,this.addChild(oe),m&&oe.drag({localBounds:!0})}if(this.update=function(){p&&(te.clear(),ne.clear()),U=p?$.size+2*$.spacing:0,Z=X.getBounds()?X.getBounds().width:0,K=X.getBounds()?X.getBounds().height:0,V=z&&d-x<Z&&(p||!0===g||"auto"==g||"horizontal"==g),H=v&&u-C<K&&(p||!0===g||"auto"==g||"vertical"==g),P.scrollXMax=Z+2*x-d+(H?U+$.margin:0),P.scrollYMax=K+2*C-u+(V?U+$.margin:0),Y.clear();var e=h/2,t=h/2,o=d-(H&&p?$.size+2*$.spacing:0)-(H?0:h),n=u-(V&&p?$.size+2*$.spacing:0)-(V?0:h);Y.f("rgba(0,0,0,.01)").rc(e,t,o,n,F,F,f,f),b||(_.graphics.c().f("red").dr(e,t,o,n),X.hitArea=_);var i=Math.max(f,Math.min($.corner,$.spacing)),r=i+h/2,a=i+(H?U:0)+h/2,s=i+h/2,l=i+(V?U:0)+h/2;if(V&&p&&(scrollBarLength=Math.max($.minSize,(d-r-a)*(d-r-a)/(Z+x+$.margin)),te.f($.color).rr(0,0,scrollBarLength,$.size,$.corner),ee.x=r,ee.y=u-$.size-$.spacing,N=new Je.Proportion(-P.scrollXMax,0,r,d-scrollBarLength-a,-1),m)){ee.setBounds(0,0,scrollBarLength,$.size);var c=new createjs.Rectangle(r,ee.y,d-scrollBarLength-r-a,0);ee.dragBoundary(c),ee.proportion=new Je.Proportion(c.x,c.x+c.width,0,-P.scrollXMax),ee.off("pressmove",q),q=ee.on("pressmove",function(){P.dispatchEvent("scrolling"),X.x=ee.proportion.convert(ee.x)})}if(H&&p&&(scrollBarLength=Math.max($.minSize,(u-s-l)*(u-s-l)/(K+C+$.margin)),ne.f($.color).rr(0,0,$.size,scrollBarLength,$.corner),oe.x=d-$.size-$.spacing,oe.y=s,G=new Je.Proportion(-P.scrollYMax,0,s,u-scrollBarLength-l,-1),m)){oe.setBounds(0,0,$.size,scrollBarLength);c=new createjs.Rectangle(oe.x,s,0,u-scrollBarLength-s-l);oe.dragBoundary(c),oe.proportion=new Je.Proportion(c.y,c.y+c.height,0,-P.scrollYMax),oe.off("pressmove",Q),Q=oe.on("pressmove",function(){P.dispatchEvent("scrolling"),Ce=X.y=oe.proportion.convert(oe.y)})}de(),clearTimeout(J),J=setTimeout(function(){ie()},300)},this.resize=function(e,t){return zot(e)&&(e=d),zot(t)&&(t=u),d=e,u=t,W(),P.update(),Ce=X.y,T&&ke.immediate(Ce),P},!zot(k)){zot(M)&&(M=!0),zot(E)&&(E=30),"string"==typeof k&&(k=new Je.Label({text:k,size:O.size?O.size:20})),titleBarLabel=P.titleBarLabel=k,zot(A)&&(A="rgba(0,0,0,.2)"),P.titleBar=k=new Je.Container(d,E).centerReg(P).mov(0,-u/2-E/2);P.titleBar.backing=new Je.Rectangle(d,E,A,null,null,.95*f,!0).addTo(k);titleBarLabel.center(k).pos(Math.max(f/2,Math.max(10,i))),P.regX=0,P.regY=-E,P.setBounds(0,-E,d,u+E),M?(k.cursor="pointer",k.on("mousedown",function(){P.drag({rect:I,currentTarget:!0})}),k.on("pressup",function(){P.noDrag()})):(k.mouseEnabled=!1,k.mouseChildren=!1)}S&&(zot(j)&&(j="#555"),(S=P.close=new Je.Shape(-40,-40,80,80)).graphics.f(j).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),k?S.centerReg(P).scaleTo(k,null,50).pos(d-Math.max(f/2,Math.max(10,i))-S.width/2,-E/2).expand(40):S.centerReg(P).sca(.3).mov(d-Math.max(f/2,Math.max(10,i)),S.height).expand(40),S.cursor="pointer",S.expand(),S.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){P.removeFrom(),P.dispatchEvent("close")}));function ie(){Je.dragBoundary(X,new createjs.Rectangle(0,0,V?-P.scrollXMax:0,H?-P.scrollYMax:0))}this.add=function(e,t){if(Ee(e),e.getBounds())return t&&P.removeAll(),X.addChild(e),0==e.x&&(e.x=x),0==e.y&&(e.y=C),P.update(),P;zog("SwipeBox.add() - please add content with bounds set")},this.remove=function(e){return X.removeChild(e),P.update(),P};var re,ae,se,le=!(this.removeAll=function(){return zog("removing"),X.removeAllChildren(),P.update(),P});function ce(){Ce=X.y,T&&ke.immediate(Ce),p&&de()}function de(){P.dispatchEvent("scrolling"),_&&(_.x=-X.x,_.y=-X.y),V&&p&&(ee.x=N.convert(X.x)),H&&p&&(oe.y=G.convert(X.y))}function ue(e){Je.Ticker.remove(ce),le=!1,V&&a&&Je.animate(ee,{alpha:0},$.fadeTime),H&&a&&Je.animate(oe,{alpha:0},$.fadeTime)}if(g&&X.on("mousedown",function(){le||Je.Ticker.add(ce,X.stage),le=!0,V&&p&&a&&Je.animate(ee,{alpha:r},$.showTime),H&&p&&a&&Je.animate(oe,{alpha:r},$.showTime)}),this.on("added",function(){if(Ee(P),!g)return;Je.drag({obj:X,currentTarget:!0,localBounds:!0,slide:s,slideDamp:l,slideSnap:!(!v||!0!==g&&"auto"!=g&&"vertical"!=g)&&c}),X.getBounds()&&0<X.getBounds().width&&setTimeout(function(){ie()},300)},null,!0),s?X.on("slidestop",ue):X.on("mousedown",function(){X.stage.on("stagemouseup",ue,null,!0)}),b){var he,fe,ge;X.on("mousedown",function(e){he=e.stageX,fe=Date.now()}),X.on("click",function(e){Date.now()-fe<600&&Math.abs(e.stageX-he)<5&&(P.contentMouse=X.globalToLocal(e.stageX,e.stageY),P.dispatchEvent("select"))}),X.on("mouseover",function(){ge=Date.now(),Je.Ticker.add(xe,X.stage)}),X.on("mouseout",function(){we||(P.dispatchEvent("hoverout"),we=!0);Je.Ticker.remove(xe)});var pe=0,me=0,ze=0,ve=0,be=300,ye=2,we=!1;function xe(){if(!X.stage)return we||(P.dispatchEvent("hoverout"),we=!0),void Je.Ticker.remove(xe);Math.abs(pe-X.stage.mouseX)>ye||Math.abs(me-X.stage.mouseY)>ye?(we||(P.dispatchEvent("hoverout"),we=!0),ge=Date.now(),pe=X.stage.mouseX,me=X.stage.mouseY):Date.now()-ge>be&&((Math.abs(ze-X.stage.mouseX)>ye||Math.abs(ve-X.stage.mouseY)>ye)&&(P.contentMouse=X.globalToLocal(X.stage.mouseX,X.stage.mouseY),P.dispatchEvent("hoverover"),ze=X.stage.mouseX,ve=X.stage.mouseY,we=!1),ge=Date.now())}}var Ce=P.scrollY;if(t){function Te(e){if(P.dispatchEvent("scrolling"),H&&P.stage&&P.hitTestPoint(e.stageX,e.stageY)){zot(e)&&(e=event);var t=e.detail?-19*e.detail:e.wheelDelta;zot(t)&&(t=-19*e.deltaY),Ce+=t,Ce=Math.max(-P.scrollYMax,Math.min(0,Ce)),T||(P.scrollY=Ce,X.stage.update())}}re=window.addEventListener("mousewheel",Te),ae=window.addEventListener("wheel",Te),se=window.addEventListener("DOMMouseScroll",Te)}var ke,Ae=!1;function Ee(e){T&&!Ae&&e.stage&&(Ae=!0,ke=new Je.Damp(P.scrollY,T),Je.Ticker.add(function(){le||zot(Ce)||(P.scrollY=ke.convert(Ce))},e.stage))}Object.defineProperty(P,"scrollX",{get:function(){return X.x},set:function(e){X.x=e,de()}}),Object.defineProperty(P,"scrollY",{get:function(){return X.y},set:function(e){X.y=e,de()}}),this.clone=function(e){zot(e)&&(e=!0);var t=P.cloneProps(new Je.Window(d,u,o,n,h,i,f,g,p,m,$.color,r,a,z,v,s,l,c,b,y,w,x,C,k,A,E,M,I,S,j));return e&&(P.content.cloneChildren(t.content),t.update()),t},this.dispose=function(){return t&&(window.removeEventListener("mousewheel",re),window.removeEventListener("wheel",ae),window.removeEventListener("DOMMouseScroll",se)),Je.Ticker.remove(xe),Je.Ticker.remove(ce),this.zimContainer_dispose(),!0}},Je.extend(Je.Window,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Waiter=function(r,a,e,t,o,n,i,s){var l;if(l=zob(Je.Waiter,arguments,"container, speed, color, circleColor, corner, shadowColor, shadowBlur, fadeTime",this))return l;z_d("59"),this.zimContainer_constructor(),this.type="Waiter",zot(a)&&(a=600),zot(e)&&(e="orange"),zot(t)&&(t="white"),zot(o)&&(o=16),zot(n)&&(n="rgba(0,0,0,.3)"),zot(i)&&(i=14),zot(s)&&(s=0);this.setBounds(-52,-20,104,40);var c=this,d=this.display=new Je.Shape;this.addChild(d),d.setBounds(0,0,104,40),d.regX=52,d.regY=20;var u=d.graphics;u.f(e),u.rr(0,0,104,40,o),-1!=n&&0<i&&(d.shadow=new createjs.Shadow(n,3,3,i)),d.on("click",function(e){e.stopImmediatePropagation()});var h,f,g,p=new Je.Container;this.addChild(p);for(var m=0;m<3;m++)(h=new createjs.Shape).graphics.f(t).dc(0,0,12),h.x=32*(m-1),p.addChild(h),h.cache(-12,-12,24,24),h.alpha=0;this.hide=function(){function e(){c.parent&&c.parent.removeChild(c);var e=c.stage;if(e&&e.update(),c.zimAccessibility){var t=c.zimAccessibility;t.resize(c),f?f.focus():c.zimTabTag.nextSibling.focus(),setTimeout(function(){t.talk("Waiter has finished.")},50)}}return 0<s?c.animate({obj:{alpha:0},time:s,call:e}):e(),c},this.show=function(){var e,t="zim display - Waiter(): Please pass in a reference to a container with bounds set as first parameter to Waiter";if(zot(r)){if(!zimDefaultFrame)return void zog(t);r=zimDefaultFrame.stage}else{if(!r.getBounds)return void zog(t);if(zot(r.stage))return void zog("zim display - Waiter(): The container must have a stage property")}for(var o=0,n=0;n<p.numChildren;n++)c.alpha=0,createjs.Tween.get(c,{override:!0}).to({alpha:1},300),g=setTimeout(function(){p&&(e=p.getChildAt(o),createjs.Tween.get(e,{loop:!0}).to({alpha:1},a/3/2).wait(a/3).to({alpha:0},a/3).wait(a-a/3-a/3/2),o++)},n*a/3);if(c.ticker=createjs.Ticker.on("tick",function(){r.stage.update()}),c.x=r.getBounds().width/2,c.y=r.getBounds().height/2,r.addChild(c),0<s&&(c.alpha=0,c.animate({alpha:1},s)),c.zimAccessibility){var i=c.zimAccessibility;setTimeout(function(){i.activatedObject&&(f=i.activatedObject.zimTabTag)},50),i.resize(c),i.talk(c.zimTabTag.getAttribute("aria-label"))}return c},this.clone=function(){return c.cloneProps(new Je.Waiter(r,a,e,t,o,n,i,s))},this.dispose=function(){return c.ticker&&createjs.Ticker.off("tick",c.ticker),clearInterval(g),this.zimContainer_dispose(),!0}},Je.extend(Je.Waiter,Je.Container,["clone","dispose"],"zimContainer",!1),Je.ProgressBar=function(t,o,n,i,r,a,s,e,l,c,d,u,h,f,g,p,m){var z;if(z=zob(Je.ProgressBar,arguments,"barType, color, backingColor, borderColor, borderWidth, padding, label, labelPosition, percentage, corner, shadowColor, shadowBlur, backing, delay, fastClose, container, autoHide",this))return z;z_d("59.5"),this.zimContainer_constructor(),this.type="ProgressBar",zot(o)&&(o="#acd241"),zot(n)&&(n="#444"),zot(i)&&(i=n),zot(e)&&(e="bottom"),zot(t)&&(t="circle"),zot(a)&&(a="circle"==t?2:-.5),zot(c)&&(c=15),zot(d)&&(d="rgba(0,0,0,.3)"),zot(u)&&(u=14),zot(g)&&(g=!0),zot(r)&&(r="circle"==t?10:2),zot(f)&&(f=100),zot(m)&&(m=!0),"string"!=typeof s&&"number"!=typeof s||(s=new Je.Label(s));s&&s.text,!zot(l)&&zot(s)&&(s=new Je.Label("")),this.label=s;var v,b=30,y=this,w=0;if(y.visible=!1,setTimeout(function(){y.visible=!0,y.stage&&y.stage.update()},f),"circle"==t)var x=20,C=(h=this.backing=new Circle(x,"rgba(0,0,0,0)",n,r).addTo(this),this.bar=(new Je.Shape).addTo(y).pos(h.x,h.y).rot(-90));else{x=200;if(-1!=d&&0<u)new Je.Rectangle(x-2,b-2,n,null,null,c).addTo(this).shadow=new createjs.Shadow(d,3,3,u);h=k(h),C=this.bar=new Je.Rectangle(x-1.8*(a+r/2),b-1.8*(a+r/2),o,null,null,c-1.2*(a+r/2)).center(this);var T=this.mask=new Je.Rectangle(x-1.8*(a+r/2),b-1.8*(a+r/2)).center(this).alp(0).sca(0,1);C.setMask(T)}function k(e){if(y.backing){var t=y.getChildIndex(y.backing);y.removeChild(y.backing)}else t=y.numChildren;if(y.border&&y.removeChild(y.border),zot(e)||"Pattern"!=e.type)e=y.backing=zot(e)?new Je.Rectangle(x,b,n,i,r,c).addTo(y,t):h.addTo(y,t);else{var o=e;((e=y.backing=new Je.Rectangle(x,b,n,null,null,c).addTo(y,t)).pattern=o).center(e);e.getBounds();if(o.setMask(e.shape),r)y.border=new Je.Rectangle(x,b,"rgba(0,0,0,0)",i,r,c).addTo(y,t+1)}return e}function A(e){"circle"==t?C.graphics.c().mt(0,0).s(o).ss(r-2*a+.5).a(0,0,x,0,360*e/100*Math.PI/180):(T.sca(e/100,1),C.setMask(T)),zot(l)||(s.text=s.startText+" "+Math.min(Math.round(e),100)+"%"),m&&g&&100<=Math.round(e)&&(y.timeOut=setTimeout(function(){y.hide()},200)),y.stage&&y.stage.update()}y.setBacking=function(e){k(e),y.stage&&y.stage.update()},h.on("click",function(e){e.stopImmediatePropagation()}),zot(s)||(s.scaleX=s.scaleY=.8,s.startText=s.text,zot(l)||(s.text=s.startText+"  0%"),s.center(y),"above"==e?s.y-=60:s.y+=60,s.alpha=.8),this.hide=function(){var e=y.stage;if(y.parent&&y.parent.removeChild(y),"Pattern"==y.backing.type&&y.backing.pauseInterval&&y.backing.pauseInterval(),e&&e.update(),y.zimAccessibility){var t=y.zimAccessibility;t.resize(y),v?v.focus():y.zimTabTag.nextSibling.focus(),setTimeout(function(){t.talk("Progress Bar has finished.")},50)}return y},this.show=function(){var e="zim display - ProgressBar(): Please pass in a reference to a container with bounds set as first parameter of the ProgressBar";if(zot(p)){if(!zimDefaultFrame)return void zog(e);p=zimDefaultFrame.stage}else{if(!p.getBounds)return void zog(e);if(zot(p.stage))return void zog("zim display - Waiter(): The container must have a stage property")}if(y.timeOut&&clearTimeout(y.timeOut),A(0),y.zimActiveLoader&&y.zimActiveLoader.on("progress",function(e){A(w=100*e.progress)}),y.center(p),"Pattern"==y.backing.type&&y.backing.pauseInterval&&y.backing.pauseInterval(!1),y.zimAccessibility){var t=y.zimAccessibility;setTimeout(function(){t.activatedObject&&(v=t.activatedObject.zimTabTag)},50),t.resize(y),t.talk(y.zimTabTag.getAttribute("aria-label"))}return y},Object.defineProperty(y,"percent",{get:function(){return w},set:function(e){A(w=e)}}),this.clone=function(){return y.cloneProps(new Je.ProgressBar(t,o,n,i,r,a,s,e,l,c,d,u,h,f,g,p,m))},this.dispose=function(){return"Pattern"==y.backing.type&&y.backing.clearInterval&&y.backing.clearInterval(),this.zimContainer_dispose(),!0}},Je.extend(Je.ProgressBar,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Indicator=function(e,t,n,i,r,o,a,s,l,c,d,u,h,f){var g;if(g=zob(Je.Indicator,arguments,"width, height, num, color, offColor, borderColor, backingColor, indicatorType, fill, scale, lightScale, press, shadowColor, shadowBlur",this))return g;z_d("60"),this.zimContainer_constructor(),this.type="Indicator",zot(e)&&(e=300),zot(t)&&(t=50),zot(n)&&(n=6),zot(i)&&(i="#f58e25"),zot(r)&&(r="#666"),r<0&&(r="rgba(0,0,0,.01)"),o<0&&(o=null),zot(a)&&(a=-1),zot(s)&&(s="dot"),zot(l)&&(l=!1),zot(c)&&(c=1),zot(d)&&(d=1),zot(u)&&(u=!1),zot(h)&&(h="rgba(0,0,0,.3)"),zot(f)&&(f=5);var p,m=(zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",z=this;this.lights=[];new Je.Container;if(-1!=a){var v=new Je.Rectangle(e,t,a);this.addChild(v),this.backing=v}var b,y=this.lightsContainer=new Je.Container;this.addChild(y);var w=.5*t,x=e/(n+1),C=new createjs.Shape;"square"==s||"box"==s?C.graphics.f("black").dr(-x/2/d+w/2,-t/2+w/2,x/d,t):C.graphics.f("black").dr(-x/2/d,-t/2,x/d,t);for(var T=0;T<n;T++)"square"==s||"box"==s?((b=new Je.Rectangle(w,w,r,o)).regX=b.width/2,b.regY=b.height/2):b=new Je.Circle(w/2,r,o),this.lights.push(b),b.znum=T,b.scaleX=b.scaleY=d,b.hitArea=C,b.x=x+x*T,b.y=t/2,y.addChild(b);if(y.setBounds(0,0,e,t),y.regX=y.x=e/2,y.regY=y.y=t/2,this.addChild(y),-1!=h&&0<f&&(y.shadow=new createjs.Shadow(h,2,2,f)),u){y.cursor="pointer";y.on(m,function(e){p!=e.target.znum&&(k(p=e.target.znum),z.dispatchEvent("change"))})}function k(e){var t;n<=e&&(e=-1);for(var o=0;o<n;o++)t=l&&o<e?i:r,o==e&&(t=i),y.getChildAt(o).color=t;z.zimAccessibility&&z.zimAccessibility.changeTitle(z),Je.OPTIMIZE||!zns&&OPTIMIZE||!z.stage||z.stage.update()}y.scaleX=y.scaleY=c,Object.defineProperty(this,"selectedIndex",{get:function(){return p},set:function(e){p=Math.floor(e),k(p=Je.constrain(p,-1,n-1))}}),Object.defineProperty(this,"num",{get:function(){return n},set:function(e){zon&&zog("num is read only")}}),this._enabled=!0,Object.defineProperty(z,"enabled",{get:function(){return z._enabled},set:function(e){be(z,e)}}),this.clone=function(){return z.cloneProps(new Je.Indicator(e,t,n,i,r,o,a,s,l,c,d,u,h,f))}},Je.extend(Je.Indicator,Je.Container,"clone","zimContainer",!1),Je.Stepper=function(n,e,o,t,s,l,i,r,a,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A,E,M,I){var S;if(S=zob(Je.Stepper,arguments,"list, width, color, borderColor, label, vertical, arrows, corner, shadowColor, shadowBlur, continuous, display, press, hold, holdDelay, holdSpeed, drag, dragSensitivity, dragRange, stepperType, min, max, step, step2, arrows2, arrows2Scale, keyEnabled, keyArrows, rightForward, downForward",this))return S;z_d("61"),this.zimContainer_constructor(),this.type="Stepper";var j=Je.getDefaultFont();zot(n)&&(n=[0,1,2,3,4,5,6,7,8,9]),zot(e)&&(e=200),zot(o)&&(o="white"),zot(t)&&(t=null),zot(s)&&(s=""),"string"!=typeof s&&"number"!=typeof s||(s=new Je.Label(s,j.size?2*j.size:64,null,j.color?j.color:"#555",null,null,null,"center")),zot(l)&&(l=!1),zot(i)&&(i=!0),zot(r)&&(r=16),zot(a)&&(a="rgba(0,0,0,.3)"),zot(c)&&(c=14),zot(d)&&(d=!1),zot(u)&&(u=!0),zot(h)&&(h=!0),zot(f)&&(f=!0),zot(g)&&(g=400),zot(p)&&(p=200),zot(m)&&(m=!0),(zot(z)||z<=0)&&(z=.1),zot(v)&&(v=200),zot(b)&&(b="list"),zot(y)&&(y=0),zot(w)&&(w=100),zot(x)&&(x=1),zot(C)&&(C=x),zot(T)&&C!=x&&"number"==b&&(T=!0),zot(k)&&(k=.5),zot(A)&&(A=!0),zot(E)&&(E=!0),zot(M)&&(M=!0),zot(I)&&(I="number"!=b);var B,O,P,D,L=this,Y=100,X=x,_=1;if("number"==b){if(y=Number(y),w=Number(w),NaN==y&&(y=0),NaN==w&&(w=100),w<y){_=-1;var R=w;w=y,y=R,O=w}else O=y;this.min=y,this.max=w,y<0&&0<w&&(O=0),x=Math.abs(x),P=Math.max(N(x),N(C))}else if("letter"==b){n="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),"string"!=typeof y&&(y="A"),"string"!=typeof w&&(w="Z"),y=y.substr(0,1).toUpperCase(),w=w.substr(0,1).toUpperCase();var F=n.indexOf(y);F<0&&(y="A",F=0);var W=n.indexOf(w);W<0&&(w="Z",W=n.length),W<F&&(n.reverse(),F=n.length-1-F,W=n.length-1-W),n=n.splice(F,W-F+1)}else b="list";function N(e){var t=String(e).split(".")[1];return t=t?t.length:0}var G=0,V=0;m&&this.on("mousedown",function(e){L.zimAccessibility&&L.zimAccessibility.aria||(this.stage.mouseMoveOutside=!0,G=e.rawX,V=e.rawY,D=this.stage.on("stagemousemove",function(e){G=e.rawX,V=e.rawY}))},null,!0),(this.label=s).mouseChildren=!1;s.mouseEnabled=!1;var H,U,Z,K,q,Q,J,$,ee,te,oe,ne,ie,re=!1;if(i||T){var ae=new createjs.Shape;ae.graphics.f("rgba(255,255,255,.11)").r(0,0,150,150),ae.regX=75,ae.regY=87.5}if(i&&(K=this.containerPrev=new Je.Container,this.addChild(K),K.hitArea=ae,q=this.arrowPrev=new Je.Triangle(Y,80,80,o),-1!=a&&0<c&&(K.shadow=new createjs.Shadow(a,3,3,c)),K.addChild(q),K.cursor="pointer",K.on("mousedown",function(e){if(!L.zimAccessibility||!L.zimAccessibility.aria){X=x;var t=l?I?1:-1:M?-1:1;ue(t),ce(t)}}),f&&K.on("pressup",de),l?(K.rotation=180,K.x=e/2,K.y=u?K.height+25+Y+K.height/2+25:2*K.height):(K.rotation=-90,K.x=K.height/2,K.y=K.width/2)),u){var se,le=this.textBox=new Je.Shape;le.cursor="pointer",this.addChild(le),le.setBounds(0,0,e,Y),null!=t&&le.graphics.s(t).ss(1.5),le.graphics.f(o).rr(0,0,e,Y,r),-1!=a&&0<c&&(le.shadow=new createjs.Shadow(a,3,3,c)),i&&(l?i&&(le.y=q.height+25):i&&(le.x=q.height+25)),this.addChild(s),0<n.length&&(B=0,s.text=n[B]),s.x=50+le.x+le.getBounds().width/2,s.y=le.y+(le.getBounds().height-s.getBounds().height)/2,le.on("mousedown",function(e){L.zimAccessibility&&L.zimAccessibility.aria||(se=L.currentValue,h&&ue(1),ce(1,!0),"number"==b&&(clearTimeout(Z),re=!0,Z=setTimeout(function(){re=!1},200)))}),le.on("pressup",function(){L.zimAccessibility&&L.zimAccessibility.aria||re&&(fe(O=Math.round(O),O),L.currentValue!=se&&L.dispatchEvent("change"),se=L.currentValue)})}else 0<n.length&&(B=0);function ce(i,r,a){if(f){ne=L.stage.mouseX,holdY=L.stage.mouseY,0==ne&&(ne=1),0==holdY&&(holdY=1),m||(z=1),ie=new Je.Proportion(0,v,p,p*z);var s=p;H=setTimeout(function(){!0,function n(){U=setTimeout(function(){var e=i;if(m){var t=Math.abs(G-ne),o=Math.abs(V-holdY);l?(r||a||(t=0),a&&(o=0)):(r||a||(o=0),a&&(t=0)),(10<=t||10<=o)&&(o<t?(X=l?C:x,e=0<G-ne?1:-1,s=ie.convert(Math.abs(ne-G))):(X=l?x:C,e=0<V-holdY?1:-1,"number"!=b&&I||(e*=-1),s=ie.convert(Math.abs(holdY-V))))}ue(e),n()},s)}()},g)}}function de(){L.zimAccessibility&&L.zimAccessibility.aria||(!1,clearTimeout(H),clearTimeout(U))}function ue(e){var t;if("number"==b){var o=O;O+=X*e*_,O=Je.decimals(O,P),d?O>L.max?O=L.min:O<L.min&&(O=L.max):(O>L.max?(O=1==x?L.max:o,u&&(le.cursor="default")):u&&(le.cursor="pointer"),O<L.min&&(O=1==x?L.min:o))}else{if(t=B+e,d)t>n.length-1&&(t=0),t<0&&(t=n.length-1);else{if(t>n.length-1)return void(u&&(le.cursor="default"));if(u&&(le.cursor="pointer"),t<0)return}B=t}fe("number"==b?O:n[B],"number"==b?O:B),L.currentValue!=se&&L.dispatchEvent("change"),se=L.currentValue}function he(){L.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function fe(e,t){B=t,u&&("number"==b&&0!=e&&0<P&&(e=Je.decimals(e,P,!0)),s.text=e,s.x=le.x+le.getBounds().width/2,s.y=le.y+(le.getBounds().height-s.getBounds().height)/2),i&&(K.alpha=1,q.color=o,K.cursor="pointer",Q.alpha=1,J.color=o,Q.cursor="pointer",d||("number"==b?(B==L.min&&(0<_?ge():pe()),B==L.max&&(0<_?pe():ge())):(0==B&&(l?pe():ge()),B==n.length-1&&(l?ge():pe())))),!Q||Je.OPTIMIZE||!zns&&OPTIMIZE||!Q.stage?!s||Je.OPTIMIZE||!zns&&OPTIMIZE||!s.stage||s.stage.update():Q.stage.update(),L.zimAccessibility&&L.zimAccessibility.changeTitle(L,null,!0)}function ge(){i&&(K.alpha=.8,q.color="#aaa",K.cursor="default")}function pe(){i&&(Q.alpha=.8,J.color="#aaa",Q.cursor="default")}i&&(Q=this.containerNext=new Je.Container,this.addChild(Q),Q.hitArea=ae.clone(),J=this.arrowNext=new Je.Triangle(Y,80,80,o),-1!=a&&0<c&&(Q.shadow=new createjs.Shadow(a,3,3,c)),Q.addChild(J),Q.cursor="pointer",Q.on("mousedown",function(e){if(!L.zimAccessibility||!L.zimAccessibility.aria){X=x;var t=l?I?-1:1:M?1:-1;ue(t),ce(t)}}),f&&Q.on("pressup",de),l?(Q.rotation=0,Q.x=e/2,Q.y=Q.getBounds().height/2):(Q.rotation=90,Q.x=u?le.x+le.getBounds().width+Q.getBounds().height/2+25:K.x+K.getBounds().width,Q.y=Q.getBounds().width/2)),f&&u&&le.on("pressup",de),T&&(($=this.prev2=new Je.Container).hitArea=ae.clone(),ee=this.arrowPrev2=new Je.Triangle(Y,80,80,"rgba(0,0,0,.2)",o,2),$.addChild(ee),$.cursor="pointer",$.sca(k),$.alpha=.5,$.on("mousedown",function(e){if(!L.zimAccessibility||!L.zimAccessibility.aria){X=C;var t=l?M?-1:1:I?1:-1;ue(t),ce(t,null,!0)}}),f&&$.on("pressup",de),(te=this.next2=new Je.Container).hitArea=ae.clone(),oe=this.arrowNext2=new Je.Triangle(Y,80,80,"rgba(0,0,0,.2)",o,2),te.addChild(oe),te.cursor="pointer",te.sca(k),te.alpha=.5,te.on("mousedown",function(e){if(!L.zimAccessibility||!L.zimAccessibility.aria){X=C;var t=l?M?1:-1:I?-1:1;ue(t),ce(t,null,!0)}}),f&&te.on("pressup",de),l?($.y=this.height/2,$.x=-$.width/2-25*Math.max(.2,Math.min(1,k)),$.rotation=270,te.y=this.height/2,te.x=this.width+te.width/2+25*Math.max(.2,Math.min(1,k)),te.rotation=90):(te.x=this.width/2,te.y=-te.height/2-25*Math.max(.2,Math.min(1,k)),te.rotation=0,$.x=this.width/2,$.y=this.height+$.height/2+25*Math.max(.2,Math.min(1,k)),$.rotation=180),this.addChild($,te)),Object.defineProperty(this,"stepperArray",{get:function(){if("number"==b){n=[];for(var e=L.min;e<=L.max;e+=Math.min(x,C))n.push(Je.decimals(e,P,null,!1))}return n},set:function(e){n=e,L.selectedIndex=L.selectedIndex}}),fe("number"==b?O:n[B],"number"==b?O:B),Object.defineProperty(this,"selectedIndex",{get:function(){return"number"==b?L.stepperArray.indexOf(L.currentValue):B},set:function(e){zot(e)||("number"==b?(B=Math.min(L.stepperArray.length-1,Math.max(0,e)),fe(O=L.stepperArray[B],O)):(e=Math.min(n.length-1,Math.max(0,e)),fe(n[B=e],B)))}}),Object.defineProperty(this,"currentValue",{get:function(){return"number"==b?O:n[B]},set:function(e){if(!zot(e))if("number"==b){if(e=Number(e),L.max>L.min){if(e>L.max||e<L.min)return}else if(e<L.max||e>L.min)return;if(newIndex=L.stepperArray.indexOf(e),newIndex<0)return;B=newIndex,fe(O=L.stepperArray[B],O)}else{if(!(-1<n.indexOf(e)))return;if((e=n.indexOf(e))==L.selectedIndex)return;fe(n[B=e],B)}}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return L.currentValue},set:function(e){String(e)!=String(L.currentValue)&&(L.currentValue=e,L.dispatchEvent("change"))}}),Object.defineProperty(this,"continuous",{get:function(){return d},set:function(e){d=e,"number"==b?fe(O,O):fe(n[L.selectedIndex],L.selectedIndex)}}),this._enabled=!0,Object.defineProperty(L,"enabled",{get:function(){return L._enabled},set:function(e){be(L,e),e?("number"==b?fe(O,O):fe(n[L.selectedIndex],L.selectedIndex),window.addEventListener("keydown",L.keyDownEvent)):(ge(),pe(),window.removeEventListener("keydown",L.keyDownEvent),u&&(s.mouseChildren=!1),u&&(s.mouseEnabled=!1)),!Q||Je.OPTIMIZE||!zns&&OPTIMIZE||!Q.stage?!s||Je.OPTIMIZE||!zns&&OPTIMIZE||!s.stage||s.stage.update():Q.stage.update()}}),Object.defineProperty(this,"keyFocus",{get:function(){return zns?Je.KEYFOCUS==L:KEYFOCUS==L},set:function(e){zns?Je.KEYFOCUS=L:KEYFOCUS=L}}),(zns?Je.KEYFOCUS:KEYFOCUS)||he(),this.on("mousedown",function(){he()});var me=!1,ze=!1,ve=!1;this.on("mousedown",function(){L.zimAccessibility&&L.zimAccessibility.aria||(L.focus=!0,ve=ze=!(me=!0))}),this.keyDownEvent=function(e){if(L.stage&&(L.zimAccessibility&&L.focus||!L.zimAccessibility&&L.keyFocus)){e||(e=event);var t,o=e.keyCode;if(E&&37<=o&&o<=40){var n=I?40:38,i=M?39:37,r=I?38:40,a=M?37:39;o==n||o==i?(X=l&&o==n||!l&&o==i?x:C,ue(1)):o!=r&&o!=a||(X=l&&o==r||!l&&o==a?x:C,ue(-1))}if(A)if("number"==b)!e.shiftKey&&48<=o&&o<=57?t=o-48:96<=o&&o<=105?t=o-96:190==o?ze=!0:173==o||189==o?(L.currentValue=-1*L.currentValue,L.currentValue!=se&&L.dispatchEvent("change"),se=L.currentValue,ve=!ve):46==o&&(ze=!(me=!0)),me&&!zot(t)?(ze&&(t/=10),ve&&(t*=-1),L.currentValue=t,me=!1,L.currentValue!=se&&L.dispatchEvent("change"),se=L.currentValue):zot(t)||(ze&&(t=String(t/10).substr(1)),L.currentValue=Number(Math.floor(Number(s.text))+String(t)),L.currentValue!=se&&L.dispatchEvent("change"),se=L.currentValue);else L.currentValue=String.fromCharCode(e.keyCode),L.currentValue!=se&&L.dispatchEvent("change"),se=L.currentValue}},window.addEventListener("keydown",this.keyDownEvent),this.next=function(){ue(1)},this.prev=function(){ue(-1)},this.clone=function(){return L.cloneProps(new Je.Stepper(n,e,o,t,s.clone(),l,i,r,a,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A,E,M,I))},this.dispose=function(){return window.removeEventListener("keydown",L.keyDownEvent),L.stage&&L.stage.off(D),this.zimContainer_dispose(),!0}},Je.zut=function(e){if(zot(e)||!e.key)return!0;Je.async("https://zimjs.com/gamdata.php?id="+e.key+"&player="+e.player+"&score="+e.score+"&reverse="+e.info.reverse+"&total="+e.info.total+"&allowZero="+e.info.allowZero,e.info.type)},Je.extend(Je.Stepper,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Slider=function(a,s,t,l,e,o,n,c,i,r,d,u,h,f){var g;if(g=zob(Je.Slider,arguments,"min, max, step, button, barLength, barWidth, barColor, vertical, useTicks, inside, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV",this))return g;if(z_d("62"),this.zimContainer_constructor(),this.type="Slider",zot(a)&&(a=0),zot(s)&&(s=10),s-a!=0){if(zot(t)&&(t=0),zot(e)&&(e=300),zot(o)&&(o=3),zot(n)&&(n="#666"),zot(c)&&(c=!1),zot(i)&&(i=!1),zot(r)&&(r=!1),zot(d)&&(d=!0),zot(h)&&(h=!0),zot(f)&&(f=!0),zot(u)&&(u=(s-a)/100),zot(l)){var p=30,m=40;c&&(p=50,m=40),l=new Je.Button(p,m,"","#fff","#ddd","#666",null,1,0,null,null,30)}var z,v;l.rollPersist=!0,c?(z=l.width,r?(v=e,this.setBounds(0,0,z,v)):(v=e+l.height,this.setBounds(-l.width/2,-l.height/2,z,v))):(v=Math.max(l.height,o),r?(z=e,this.setBounds(0,0,z,v)):(z=e+l.width,this.setBounds(-l.width/2,-l.height/2,z,v)));var b,y,w,x,C,T,k,A=this,E=a,M=0;if(this.button=l,this.cursor="pointer",i&&0!=t){x=this.ticks=new Je.Shape,this.addChild(x),(C=x.graphics).ss(1).s(n);var I=Math.round((s-a)/t),S=(s-a)/I;if(S!=t&&zon&&zog("zim.Slider() : non-divisible step ("+t+") adjusted"),t=S,r)var j=(e-(c?l.height:l.width))/Math.abs(I);else j=e/Math.abs(I)}if(c){var B=r?l.height/2:0;if((b=this.bar=new Je.Rectangle(o,e,n)).expand(20,0),b.centerReg(this),l.centerReg(this),w=b.getBounds(),y=new createjs.Rectangle(b.x,w.y+B,0,w.height-2*B),i&&0!=t){for(var O=0;O<=Math.abs(I);O++)C.mt(0,B+j*O).lt(20,B+j*O);x.x=b.x+15}}else{B=r?l.width/2:0;if((b=this.bar=new Je.Rectangle(e,o,n)).expand(0,20),b.centerReg(this),l.centerReg(this),w=b.getBounds(),y=new createjs.Rectangle(w.x+B,b.y,w.width-2*B,0),i&&0!=t){for(O=0;O<=Math.abs(I);O++)C.mt(B+j*O,0).lt(B+j*O,-20);x.y=b.y-10}}l.x=y.x,l.y=y.y,l.on("mousedown",function(e){A.focus=!0;var t=A.globalToLocal(e.stageX,e.stageY);T=t.x-l.x,k=t.y-l.y,A.stage&&(A.stage.mouseMoveOutside=!0)}),l.on("pressmove",function(e){_(e)}),b.on("mousedown",function(e){k=T=0,A.zimAccessibility&&A.zimAccessibility.aria||_(e)}),Object.defineProperty(this,"currentValue",{get:function(){return E},set:function(e){zot(e)||(a<s?(e<a&&(e=a),s<e&&(e=s)):(a<e&&(e=a),e<s&&(e=s)),E=e=X(e),c?(l.y=(e-s)/(a-s)*y.height+B,M=l.y):(l.x=(e-a)/(s-a)*y.width+B,M=l.x),F(),Je.OPTIMIZE||!zns&&OPTIMIZE||!A.stage||A.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return E},set:function(e){e!=A.currentValue&&(A.currentValue=e,A.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return a},set:function(e){zon&&zog("min is read only")}}),Object.defineProperty(this,"max",{get:function(){return s},set:function(e){zon&&zog("max is read only")}}),Object.defineProperty(this,"step",{get:function(){return t},set:function(e){zon&&zog("step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return h},set:function(e){h=e}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return f},set:function(e){f=e}}),Object.defineProperty(this,"keyFocus",{get:function(){return zns?Je.KEYFOCUS==A:KEYFOCUS==A},set:function(e){zns?Je.KEYFOCUS=A:KEYFOCUS=A}}),(d&&zns?Je.KEYFOCUS:KEYFOCUS)||W(),this.on("mousedown",function(){d&&W()});var P=!1,D=!1,L=!1,Y=!1;this.keyDownEvent=function(e){A.stage&&(A.zimAccessibility&&A.focus||!A.zimAccessibility&&A.keyFocus)&&(37==e.keyCode&&h?P=!0:40==e.keyCode&&f?D=!0:39==e.keyCode&&h?L=!0:38==e.keyCode&&f&&(Y=!0),null==A.keyInterval&&(P||D||L||Y)&&(N(),A.keyTimeout=setTimeout(function(){null==A.keyInterval&&(P||D||L||Y)&&(A.keyInterval=setInterval(N,40))},140)))},window.addEventListener("keydown",this.keyDownEvent),A.keyUpEvent=function(e){37==e.keyCode?P=!1:40==e.keyCode?D=!1:39==e.keyCode?L=!1:38==e.keyCode&&(Y=!1),null==A.keyInterval||P||D||L||Y||(clearInterval(A.keyInterval),A.keyInterval=null)},window.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(A,"enabled",{get:function(){return A._enabled},set:function(e){be(A,e),e?(window.addEventListener("keydown",A.keyDownEvent),window.addEventListener("keyup",A.keyUpEvent)):(window.removeEventListener("keydown",A.keyDownEvent),window.removeEventListener("keyup",A.keyUpEvent))}}),this.clone=function(){return A.cloneProps(new Je.Slider(a,s,t,l.clone(),e,o,n,c,i,r,d,u,h,f))},this.dispose=function(){return window.removeEventListener("keydown",A.keyDownEvent),window.removeEventListener("keyup",A.keyUpEvent),this.zimContainer_dispose(),!0}}else zog("ZIM Slider range must not be 0");function X(e){return 0==t?e:Math.round(e/t)*t}function _(e){var t,o,n,i=A.globalToLocal(e.stageX,e.stageY),r=(t=i.x-T,o=i.y-k,n=y,t=Math.max(n.x,Math.min(n.x+n.width,t)),o=Math.max(n.y,Math.min(n.y+n.height,o)),{x:t,y:o});c?(l.x=r.x,E=X((r.y-y.y)/y.height*(a-s)),l.y=y.y+E*y.height/(a-s),E+=s,l.y!=M&&A.dispatchEvent("change"),M=l.y):(E=X((r.x-y.x)/y.width*(s-a)),l.x=y.x+E*y.width/(s-a),E+=a,l.y=r.y,l.x!=M&&A.dispatchEvent("change"),M=l.x),F(),Je.OPTIMIZE||!zns&&OPTIMIZE||!A.stage||A.stage.update()}function R(e){return 0<e?1:-1}function F(){A.zimAccessibility&&A.zimAccessibility.changeTitle(A,null,!0)}function W(){A.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function N(){(P||D)&&(A.currentValueEvent-=0<t?t*R(s-a):u*R(s-a)),(L||Y)&&(A.currentValueEvent+=0<t?t*R(s-a):u*R(s-a))}},Je.extend(Je.Slider,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Dial=function(n,i,r,e,t,o,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y){var w;if(w=zob(Je.Dial,arguments,"min, max, step, width, color, indicatorColor, indicatorScale, indicatorType, innerCircle, innerScale, useTicks, innerTicks, tickColor, limit, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, continuous, continuousMin, continuousMax",this))return w;if(z_d("63"),this.zimContainer_constructor(),this.type="Dial",zot(n)&&(n=0),zot(i)&&(i=10),i-n!=0){zot(r)&&(r=1),zot(e)&&(e=100),zot(t)&&(t="#666"),zot(o)&&(o="#222"),zot(a)&&(a=1),zot(s)&&(s="arrow"),zot(l)&&(l=!0),zot(c)&&(c=.5),zot(d)&&(d=!0),zot(u)&&(u=!1),zot(h)&&(h=o),zot(f)&&(f=!0),zot(g)&&(g=!0),zot(p)&&(p=(i-n)/100),zot(m)&&(m=!0),zot(z)&&(z=!0),zot(v)&&(v=!1),v&&(f=!1);var x=this;this.cursor="pointer";var C=e/2,T=n,k=0,A=this.backing=new Je.Circle(C,t);if(this.addChild(A),l){var E=u?"rgba(0,0,0,.2)":"rgba(0,0,0,.1)";"black"!=t&&"#000"!=t&&"#000000"!=t&&"#111"!=t&&"#111111"!=t||(E="#222");var M=this.inner=new Je.Circle(C*c,E);if(this.addChild(M),!u){var I=this.inner2=new Je.Circle(C*(c-.1),"rgba(0,0,0,.1)");this.addChild(I)}}var S,j,B,O,P=Math.abs(i-n)/r;if(d&&0!=r){ticks=this.ticks=new Je.Container,this.addChild(ticks);for(var D=0;D<(v?P:P+1);D++){var L;(L=new Je.Rectangle(1,.2*C,h)).regY=C*(u?c-.05:1.28),L.regX=.5,L.rotation=360/(v?P:P+1)*D,ticks.addChild(L)}}if(this.setBounds(-C,-C,e,e),"dot"==s||"circle"==s){var Y=this.indicator=new Je.Container,X=this.indicatorShape=new Je.Circle(.19*C,o);Y.addChild(X),Je.sca(Y,a),Y.regY=C-Y.getBounds().width*a/2-.07*C}else if("line"==s||"rectangle"==s){Y=this.indicator=new Je.Container,X=this.indicatorShape=new Je.Rectangle(.1*C,.3*C,o);Y.addChild(X),Je.sca(Y,a),Y.regY=C-Y.getBounds().width*a/2-.07*C,Y.regX=.05*C}else{Y=this.indicator=new Je.Container,X=this.indicatorShape=new Je.Triangle(.4*C,.4*C,.4*C,o);Y.addChild(X),Je.sca(Y,a),Y.regY=C-Y.getBounds().height*a*(u?.85:.75),u&&(X.rotation=180)}Y.regY/=a,this.addChild(Y);var _=0;if(v)var R=0,F=0,W=0,N=!1,G=!1,V=!0;else n;this.on("mousedown",function(e){if(!x.zimAccessibility||!x.zimAccessibility.aria){S=Y.rotation;var t=x.parent.globalToLocal(e.stageX,e.stageY),o=t.x-x.x,n=x.y-t.y;j=180*Math.atan2(o,n)/Math.PI;var i=(new Date).getTime();B=x.on("pressmove",function(e){if(N){var t=x.parent.globalToLocal(e.stageX,e.stageY),o=t.x-x.x,n=x.y-t.y;j=180*Math.atan2(o,n)/Math.PI,S=Y.rotation}o=(t=x.parent.globalToLocal(e.stageX,e.stageY)).x-x.x,n=x.y-t.y;var i=180*Math.atan2(o,n)/Math.PI,r=S+i-j;r=(r+36e5)%360,f&&180<Math.abs(r-_)||($(r),_=r)}),O=this.on("pressup",function(e){(new Date).getTime()-i<200&&(t=x.parent.globalToLocal(e.stageX,e.stageY),o=t.x-x.x,n=x.y-t.y,$(180*Math.atan2(o,n)/Math.PI));S=Y.rotation,x.off("pressmove",B),x.off("pressup",O)})}}),Object.defineProperty(this,"currentValue",{get:function(){return T},set:function(e){zot(e)||(v?(N=!1,zot(b)||zot(y)?zot(b)?zot(y)||y<e&&(e=y,N=!0):e<b&&(e=b,N=!0):b<y?(e<b&&(e=b,N=!0),y<e&&(e=y,N=!0)):(b<e&&(e=b,N=!0),e<y&&(e=y,N=!0)),V&&(G=!0,W=360*Math.floor(e/(i-n)))):n<i?(e<n&&(e=f?n:i),i<e&&(e=f?i:n)):(n<e&&(e=f?n:i),e<i&&(e=f?i:n)),e=q(T=e),Y.rotation=360*(e-n)/(i-n+(v?0:Q(i-n)*r)),Y.rotation=(Y.rotation+36e5)%360,k=e-n,_=Y.rotation,J(),Je.OPTIMIZE||!zns&&OPTIMIZE||!x.stage||x.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return T},set:function(e){e!=x.currentValue&&(x.currentValue=e,x.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return n},set:function(e){v?n=e:zon&&zog("min is read only")}}),Object.defineProperty(this,"max",{get:function(){return i},set:function(e){v?i=e:zon&&zog("max is read only")}}),Object.defineProperty(this,"continuous",{get:function(){return v},set:function(e){zon&&zog("continuous is read only")}}),Object.defineProperty(this,"continuousMin",{get:function(){return b},set:function(e){b=e,x.currentValue<b&&(x.currentValue=b)}}),Object.defineProperty(this,"continuousMax",{get:function(){return y},set:function(e){y=e,x.currentValue>y&&(x.currentValue=y)}}),Object.defineProperty(this,"step",{get:function(){return r},set:function(e){zon&&zog("step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return m},set:function(e){m=e}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return z},set:function(e){z=e}}),Object.defineProperty(this,"keyFocus",{get:function(){return zns?Je.KEYFOCUS==x:KEYFOCUS==x},set:function(e){zns?Je.KEYFOCUS=x:KEYFOCUS=x}}),(g&&zns?Je.KEYFOCUS:KEYFOCUS)||ee(),this.on("mousedown",function(){g&&ee()});var H=!1,U=!1,Z=!1,K=!1;this.keyDownEvent=function(e){x.stage&&(x.zimAccessibility&&x.focus||!x.zimAccessibility&&x.keyFocus)&&(37==e.keyCode&&m?H=!0:40==e.keyCode&&z?U=!0:39==e.keyCode&&m?Z=!0:38==e.keyCode&&z&&(K=!0),null==x.keyInterval&&(H||U||Z||K)&&(te(),x.keyTimeout=setTimeout(function(){null==x.keyInterval&&(H||U||Z||K)&&(x.keyInterval=setInterval(te,40))},140)))},window.addEventListener("keydown",this.keyDownEvent),x.keyUpEvent=function(e){37==e.keyCode?H=!1:40==e.keyCode?U=!1:39==e.keyCode?Z=!1:38==e.keyCode&&(K=!1),null==x.keyInterval||H||U||Z||K||(clearInterval(x.keyInterval),x.keyInterval=null)},window.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(x,"enabled",{get:function(){return x._enabled},set:function(e){be(x,e),e?(x.keyDownEvent=window.addEventListener("keydown",x.keyDownEvent),x.keyUpEvent=window.addEventListener("keyup",x.keyUpEvent)):(window.removeEventListener("keydown",x.keyDownEvent),window.removeEventListener("keyup",x.keyUpEvent))}}),this.clone=function(){return x.cloneProps(new Je.Dial(n,i,r,e,t,o,a,s,l,c,d,u,h,f,g,m,z,p,v,b,y))},this.dispose=function(){return window.removeEventListener("keydown",x.keyDownEvent),window.removeEventListener("keyup",x.keyUpEvent),this.zimContainer_dispose(),!0}}else zog("ZIM Dial range must not be 0");function q(e){return 0==r?e:Math.round(e/r)*r}function Q(e){return 0<e?1:-1}function J(){x.zimAccessibility&&x.zimAccessibility.changeTitle(x,null,!0)}function $(e){if(v){G&&(G=!1),R+180<e?W-=360:e<R-180&&(W+=360),F=W+e,V=!1;var t=x.currentValue;return x.currentValue=q(F*(i-n)/360),t!=x.currentValue&&x.dispatchEvent("change"),R=e,V=!0}var o;e<0&&(e+=360),e%=360,0!=r?(o=q((e=Math.min(e,360-360/(P+1)))/(360-360/(P+1))*(i-n)),Y.rotation=o*(360-360/(P+1))/(i-n)):o=(Y.rotation=e)/360*(i-n),o!=k&&(T=(k=o)+n,x.dispatchEvent("change"),Je.OPTIMIZE||!zns&&OPTIMIZE||!x.stage||x.stage.update()),J()}function ee(){x.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function te(){(H||U)&&(x.currentValueEvent-=0<r?r*Q(i-n):p*Q(i-n)),(Z||K)&&(x.currentValueEvent+=0<r?r*Q(i-n):p*Q(i-n))}},Je.extend(Je.Dial,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Tabs=function(o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A){var e;if(e=zob(Je.Tabs,arguments,"width, height, tabs, color, rollColor, offColor, spacing, currentEnabled, currentSelected, corner, labelColor, labelOffColor, flatBottom, keyEnabled, gradient, gloss, wait, waitTime, waitColor, rollWaitColor, waitTextColor, rollWaitTextColor, waitModal, waitEnabled, backingColor",this))return e;z_d("65"),this.zimContainer_constructor(),this.type="Tabs";var t=Je.getDefaultFont();zot(o)&&(o=240),zot(n)&&(n=60),(zot(i)||i.length<=0)&&(i=[{label:1},{label:2},{label:3},{label:4}]),zot(r)&&(r="#333"),zot(a)&&(a="#555"),zot(s)&&(s="#777"),zot(c)&&(c=!1),zot(d)?d=!0:0==d&&(c=!0),zot(l)&&(l=1),zot(u)&&(u=0),zot(h)&&(h=t.color?t.color:"white"),zot(f)&&(f=h),zot(g)&&(g=!0),zot(p)&&(p=!0);var E=this;this.keyEnabled=p;var M,I=0,S=[],j=[],B=i.length,O=(o-l*(B-1))/B;if(!zot(A)){var P=this.backing=new Je.Rectangle(o,n,A);this.addChildAt(P)}if("number"==typeof i[0]||"string"==typeof i[0])for(var D=0;D<i.length;D++)i[D]={label:String(null!=i[D])?i[D]:"1"};var L,Y,X=0,_=0;for(D=0;D<i.length;D++)zot((L=i[D]).width)&&_++,X+=zot(L.width)?O:L.width;if(o-l*(B-1)<X)for(D=0;D<i.length;D++)(L=i[D]).width=(o-l*(B-1))/X*(zot(L.width)?O:L.width);else if(Math.round(X)<Math.round(o-l*(B-1)))if(0<_)for(Y=(B*O-(X-_*O))/_,D=0;D<i.length;D++)(L=i[D]).width=zot(L.width)?Y:L.width;else zon&&zog("ZIM Tabs - total less than width"),o=X+l*(B-1);var R,F,W=0;for(D=0;D<i.length&&""!=(L=i[D]);D++)zot(L.label)&&(L.label=" "),R=0==D?zot(L.color)?r:L.color:zot(L.offColor)?s:L.offColor,F=0==D?zot(L.labelColor)?h:L.labelColor:zot(L.labelOffColor)?f:L.labelOffColor,"string"!=typeof L.label&&"number"!=typeof L.label||(L.label=new Je.Label(L.label,t.size?t.size:n/2)),L.label.color=F,(M=new Je.Button({width:zot(L.width)?O:L.width,height:n,label:L.label,color:R,rollColor:zot(L.rollColor)?a:L.rollColor,corner:u,shadowColor:-1,gradient:m,gloss:z,flatBottom:g,wait:zot(L.wait)?v:L.wait,waitTime:zot(L.waitTime)?b:L.waitTime,waitColor:zot(L.waitColor)?y:L.waitColor,rollWaitColor:zot(L.rollWaitColor)?w:L.rollWaitColor,waitTextColor:zot(L.waitTextColor)?x:L.waitTextColor,rollWaitTextColor:zot(L.rollWaitColor)?C:L.rollWaitTextColor,waitModal:zot(L.waitModal)?T:L.waitModal,waitEnabled:zot(L.waitEnabled)?k:L.waitEnabled})).on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(e){N(e.currentTarget.znum),E.dispatchEvent("change"),Je.OPTIMIZE||!zns&&OPTIMIZE||!E.stage||E.stage.update()}),M.znum=D,L.label.znum=D,M.type="TabsButton",S.push(L.label),j.push(M),this.addChild(M),M.x=W,W=M.x+M.width+l,0!=D||c||(M.enabled=!1);function N(e){var t=i[I];t&&(zot(t.wait)&&(j[I].color=zot(t.offColor)?s:t.offColor,j[I].label.color=zot(t.labelOffColor)?f:t.labelOffColor),c||(j[I].enabled=!0)),(t=i[I=e])&&(zot(t.wait)&&d&&(j[I].color=zot(t.color)?r:t.color,j[I].label.color=zot(t.labelColor)?h:t.labelColor),c||(j[I].enabled=!1))}function G(){E.keyFocus=!0;var e=document.activeElement;e&&e.blur()}window.addEventListener("keydown",function(e){if(E.keyEnabled&&E.keyFocus&&!E.zimAccessibility&&9==e.keyCode){var t=I;e.shiftKey?N(--t<0?i.length-1:t):N(++t>i.length-1?0:t),E.dispatchEvent("change"),Je.OPTIMIZE||!zns&&OPTIMIZE||!E.stage||E.stage.update(),e.preventDefault()}}),Object.defineProperty(this,"selected",{get:function(){return j[I]},set:function(e){zon&&zog("selected is read only - try selectedIndex")}}),Object.defineProperty(this,"selectedIndex",{get:function(){return I},set:function(e){N(e),Je.OPTIMIZE||!zns&&OPTIMIZE||!E.stage||E.stage.update()}}),Object.defineProperty(this,"tabs",{get:function(){return I},set:function(e){N(Math.min(Math.max(e,0),i.length-1)),Je.OPTIMIZE||!zns&&OPTIMIZE||!E.stage||E.stage.update()}}),Object.defineProperty(this,"color",{get:function(){return r},set:function(e){zog("tabs color property "+e),r=e,zot(i[I].color)&&(j[I].color=r,Je.OPTIMIZE||!zns&&OPTIMIZE||!E.stage||E.stage.update())}}),Object.defineProperty(this,"rollColor",{get:function(){return a},set:function(e){a=e;for(var t=0;t<i.length;t++)zot(i[I].rollColor)&&(j[t].rollColor=a)}}),Object.defineProperty(this,"offColor",{get:function(){return s},set:function(e){s=e;for(var t=0;t<i.length;t++)zot(i[I].offColor)&&(j[t].color=s);Je.OPTIMIZE||!zns&&OPTIMIZE||!E.stage||E.stage.update()}}),Object.defineProperty(this,"label",{get:function(){return S[I]},set:function(e){zon&&zog("selected is read only - try selectedIndex")}}),Object.defineProperty(this,"text",{get:function(){return null!=S[I]?S[I].text:void 0},set:function(e){zon&&zog("selected is read only - try selectedIndex")}}),Object.defineProperty(this,"buttons",{get:function(){return j},set:function(e){zon&&zog("buttons is read only")}}),Object.defineProperty(this,"labels",{get:function(){return S},set:function(e){zon&&zog("labels is read only")}}),this._enabled=!0,Object.defineProperty(E,"enabled",{get:function(){return E._enabled},set:function(e){be(E,e)}}),Object.defineProperty(this,"keyFocus",{get:function(){return zns?Je.KEYFOCUS==E:KEYFOCUS==E},set:function(e){zns?Je.KEYFOCUS=E:KEYFOCUS=E}}),(p&&zns?Je.KEYFOCUS:KEYFOCUS)||G(),this.on("mousedown",function(){p&&G()}),this.clone=function(){for(var e=Je.copy(i),t=0;t<e.length;t++)e[t].label=e[t].label.clone();return E.cloneProps(new Je.Tabs(o,n,e,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A))}},Je.extend(Je.Tabs,Je.Container,"clone","zimContainer",!1),Je.Pad=function(e,i,t,o,n,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y){var w;if(w=zob(Je.Pad,arguments,"width, cols, rows, keys, color, rollColor, offColor, spacing, currentEnabled, corner, labelColor, gradient, gloss, wait, waitTime, waitColor, rollWaitColor, waitTextColor, rollWaitTextColor, waitModal, waitEnabled",this))return w;if(z_d("66"),this.zimContainer_constructor(),this.type="Pad",zot(e)&&(e=150),zot(i)&&(i=3),zot(t)&&(t=i),zot(o)){o=[];for(var x=1;x<=t*i;x++)o.push(x)}zot(l)&&(l=!0),zot(s)&&(s=1);var C,T=this;this.cols=i,this.rows=t;var k,A=e/i-s,E=[],M=0;this.labels=[],this.buttons=[];for(x=0;x<t;x++){for(var I=[],S=0;S<i;S++)I.push(null!=o[M]?o[M]:""),M++;k=E[x]=new Je.Tabs({width:e,height:A,tabs:I,color:n,rollColor:r,offColor:a,spacing:s,currentEnabled:l,corner:c,labelColor:d,flatBottom:!1,keyEnabled:!1,gradient:u,gloss:h,wait:f,waitTime:g,waitColor:p,rollWaitColor:m,waitTextColor:z,rollWaitTextColor:v,waitModal:b,waitEnabled:y}),this.labels=this.labels.concat(k.labels),this.buttons=this.buttons.concat(k.buttons),this.addChild(k),k.selectedIndex=-1,k.y=(A+s)*x,k.znum=x,k.on("change",j)}function j(e){var t=e.target;T.selected=t.selected,T.text=t.text,T.label=t.label;for(var o=t.selectedIndex,n=0;n<E.length;n++)E[n].selectedIndex=-1;t.selectedIndex=o,C=t.znum*i+o,T.dispatchEvent("change"),Je.OPTIMIZE||!zns&&OPTIMIZE||!T.stage||T.stage.update()}this.tabs=E,Object.defineProperty(this,"selectedIndex",{get:function(){return C},set:function(e){C=e;for(var t=0;t<E.length;t++)E[t].selectedIndex=-1;var o=Math.floor(C/i);0<=o&&o<T.tabs.length&&(T.tabs[o].selectedIndex=C%i)}}),this._enabled=!0,Object.defineProperty(T,"enabled",{get:function(){return T._enabled},set:function(e){be(T,e)}}),this.clone=function(){return T.cloneProps(new Je.Pad(e,i,t,o,n,r,a,s,l,c,d,u,h,f,g,p,m,z,v,b,y))}},Je.extend(Je.Pad,Je.Container,"clone","zimContainer",!1),Je.ColorPicker=function(e,o,n,i,r,t,a,s,l,c,d,u,h,f,g){var p;if(p=zob(Je.ColorPicker,arguments,"width, colors, cols, spacing, greyPicker, alphaPicker, startColor, drag, shadowColor, shadowBlur, buttonBar, circles, indicator, backingColor, keyArrows",this))return p;z_d("67"),this.zimContainer_constructor(),this.type="ColorPicker",zot(e)&&(e=500),zot(o)&&(k=!0),zot(n)&&(n=10),zot(i)&&(i=2);var m=0<o.length&&o.length<=n;zot(t)&&(t=!m),zot(r)&&(r=!m),zot(l)&&(l="rgba(0,0,0,.3)"),zot(c)&&(c=14),zot(d)&&(d=!m),zot(s)&&(s=!!d),zot(u)&&(u=!1),zot(h)&&(h=!1,d||(h=!0)),zot(f)&&(f="black"),zot(g)&&(g=!0);var z=this,v="#e472c4",b="#50c4b7",y=1,w=1,x=new createjs.Shape;this.addChild(x),x.x+=i,x.y+=i;var C,T,k=!1,A=[];if(zot(o)){k=!0;var E=6,M=E*E*E;E=Math.ceil(Math.pow(M,.5)),T=(e-i)/18-i;var I=Math.floor(Math.pow(E*E,1/3));C=[];for(var S=0;S<6;S++)for(var j=0;j<6;j++)for(var B=0;B<6;B++)C.push("#"+L(3*S)+L(3*j)+L(3*B));for(o=[],S=0;S<C.length;S++)X=Math.floor(S/6),o[18*((Y=S%6)+6*(I=18<=X?1:0))+(X-6*I*3)]=C[S];n=18,A=[b,v]}else T=(e-i)/n-i;var O=Math.ceil(o.length/n),P=String(o[o.length-1]);zot(a)||(P=String(a));var D=b;function L(e){return(e=Math.floor(e).toString(16))+""+e}var Y,X,_,R,F=x.graphics;I=0;for(S=0;S<o.length;S++)X=S%n,Y=Math.floor(S/n),_=X*(T+i),R=Y*(T+i),u?F.f(o[S]).dc(_+T/2,R+T/2,T/2):F.f(o[S]).r(_,R,T,T);var W=R+T+i;z.colors=o;var N=W;if(r){for(S=0;S<16;S++)A.push("#"+L(S)+L(S)+L(S));for(S=0;S<A.length;S++)X=Math.floor(S/n),_=(Y=S%n)*(T+i),R=X*(T+i)+W,u?F.f(A[S]).dc(_+T/2,R+T/2,T/2):F.f(A[S]).r(_,R,T,T);W=R+T+i;var G=n,V=Math.ceil(A.length/n)}if(z.greys=A,h){function H(e){zot(e)||e<0?h.visible=!1:(h.visible=!0,"#000"==P||"#000000"==P||"black"==P?(h.color="#222",h.alpha=1):(h.color="black",h.alpha=.5),h.x=x.x+e%n*(T+i)+T/2,h.y=x.x+Math.floor(e/n)*(T+i)+T/2)}(h=this.indicator=u?new Je.Circle(T/2*.5):new Je.Rectangle(.5*T,.5*T)).alpha=.5,h.centerReg(),this.addChild(h),H(o.indexOf(P))}if(t){var U=new Je.Container;U.setBounds(0,0,600,70),this.addChild(U),U.x=0,U.y=W;var Z=this.alphaBacking=new Je.Rectangle(580,50,"#222",null,null,0);U.addChild(Z),Je.centerReg(Z,U);var K=this.alphaBut=new Je.Button({width:20,height:30,label:"",corner:0,hitPadding:20}),q=this.alphaSlider=new Je.Slider(0,1,.05,K,330);q.currentValue=1,U.addChild(q),q.x=40,q.y=U.height/2;var Q=this.alphaText=new Je.Label("Alpha: 1",30,null,"orange");U.addChild(Q),Q.x=q.x+q.bar.width+40,Q.y=U.height/2-Q.height/2,U.scaleX=U.scaleY=e/600,q.on("change",function(){Q.text="Alpha: "+me(q.currentValue),ie&&(ie.alpha=w=q.currentValue),d?z.dispatchEvent("set"):z.dispatchEvent("change"),z.stage&&z.stage.update()}),W+=U.height-10}if(d){var J=new Je.Container;J.setBounds(0,0,600,100),this.addChild(J),J.x=0,J.y=W+10;var $=this.swatchText=new Je.Label(P.toUpperCase().substr(0,7),30,null,"orange");if(J.addChild($),Je.centerReg($),$.x=90,$.y=48,s){var ee=this.grip=new Je.Shape;J.addChild(ee),ee.graphics.f("rgba(256,256,256,.25)").r(0,0,5,20).r(10,0,5,20).r(20,0,5,20).r(30,0,5,20),ee.x=70,ee.y=65,$.y=40,ee.mouseEnabled=!1}var te=this.closeBut=new Je.Button(90,90,"X","#222","#444",null,null,null,0);J.addChild(te),te.x=600-te.width-10,te.y=0,te.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){z.dispatchEvent("close")});var oe=this.okBut=new Je.Button(150,90,"OK","#222","#444",null,null,null,0);J.addChild(oe),oe.x=te.x-oe.width-10,oe.y=0,oe.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",ce);var ne=this.swatchBacking=new Je.Shape;J.addChild(ne),(F=ne.graphics).f("black").r(.5,.5,50,89).f("#666").r(50,.5,50,89).f("white").r(100,.5,49.5,89),ne.x=oe.x-150-10,ne.y=0;var ie=this.swatch=new Je.Rectangle(150,90,P);J.addChild(ie),ie.x=ne.x,ie.y=0,ie.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",ce),ie.cursor="pointer",J.scaleX=J.scaleY=e/600,W+=J.height}else x.cursor="pointer";t||d||(W-=10-i);var re=W+10;this.setBounds(0,0,e,re);var ae,se,le=this.backing=new Je.Rectangle(e,re,f);function ce(){if(P!=D||w!=y){if(k&&r){var e=[b=v,v=D];for(S=0;S<2;S++){var t=x.graphics;X=Math.floor(S/n),_=(Y=S%n)*(T+i),R=X*(T+i)+N,A[S]=e[S],t.f(le.color).r(_-1,R-1,T+2,T+2).f(e[S]).r(_,R,T,T)}Je.OPTIMIZE||!zns&&OPTIMIZE||!z.stage||z.stage.update()}D=P,y=w,z.dispatchEvent("change")}else z.dispatchEvent("close")}(this.addChildAt(le,0),-1!=l&&0<c&&(le.shadow=new createjs.Shadow(l,8,8,c)),s)&&(le.on("mousedown",function(e){ae=e.stageX-z.x,se=e.stageY-z.y,le.cursor="move"}),le.on("pressmove",function(e){z.x=e.stageX-ae,z.y=e.stageY-se,z.stage&&z.stage.update()}),le.on("pressup",function(e){le.cursor="default",z.stage&&z.stage.update()}));var de=n*(T+i),ue=O*(T+i);if(r)var he=G*(T+i),fe=V*(T+i);function ge(){z.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function pe(){z.zimAccessibility&&z.zimAccessibility.changeTitle(z,null,!0)}function me(e){return Math.round(e*Math.pow(10,2))/Math.pow(10,2)}x.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(e){var t=Je.hitTestGrid(x,de,ue,n,O,e.stageX,e.stageY,0,0,i,i);zot(t)||(P=o[t],d?(ie.color=P,$.text=String(o[t]).toUpperCase().substr(0,7),Je.centerReg($),P!=D&&z.dispatchEvent("set")):ce()),r&&(t=null,zot(t=Je.hitTestGrid(x,he,fe,G,V,e.stageX,e.stageY,0,ue,i,i))||(P=A[t],d?(ie.color=P,$.text=A[t].toUpperCase(),Je.centerReg($),P!=D&&z.dispatchEvent("set")):ce())),h&&H(o.indexOf(P)),d?z.stage&&z.stage.update():h&&z.stage&&z.stage.update(),pe()}),Object.defineProperty(this,"selectedColor",{get:function(){return P},set:function(e){D=P=e,d&&(ie.color=P,$.text=P,Je.centerReg($),z.stage&&z.stage.update()),h&&H(o.indexOf(P)),pe()}}),Object.defineProperty(this,"currentValue",{get:function(){return P},set:function(e){z.selectedColor=e}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return P},set:function(e){e!=z.selectedColor&&(z.selectedColor=e,z.dispatchEvent("change"))}}),Object.defineProperty(this,"selectedIndex",{get:function(){return o.indexOf(P)},set:function(e){D=P=o[e],d&&(ie.color=P,$.text=P,Je.centerReg($),z.stage&&z.stage.update()),h&&H(o.indexOf(P)),pe()}}),Object.defineProperty(this,"selectedAlpha",{get:function(){return t?me(q.currentValue):1},set:function(e){t&&(y=q.currentValue=e,ie&&(ie.alpha=y),Q&&(Q.text="Alpha: "+me(q.currentValue)),z.stage&&z.stage.update())}}),Object.defineProperty(this,"colors",{get:function(){return r?o.concat(A):o},set:function(e){zon&&zog("Display - ColorPicker() colors is read only - make a new ColorPicker to change")}}),Object.defineProperty(this,"keyFocus",{get:function(){return zns?Je.KEYFOCUS==z:KEYFOCUS==z},set:function(e){zns?Je.KEYFOCUS=z:KEYFOCUS=z}}),(g&&zns?Je.KEYFOCUS:KEYFOCUS)||ge(),this.on("mousedown",function(){g&&ge()}),this.keyDownEvent=function(e){if(z.stage&&(z.zimAccessibility&&z.focus||!z.zimAccessibility&&z.keyFocus)){var t=z.selectedIndex;function o(){t<0&&(t=z.colors.length-1),t>z.colors.length-1&&(t=0),z.selectedIndex=t,z.dispatchEvent("change"),z.stage&&z.stage.update()}37==e.keyCode||40==e.keyCode?(t--,o()):38!=e.keyCode&&39!=e.keyCode||(t++,o())}},window.addEventListener("keydown",this.keyDownEvent),this.clone=function(){return z.cloneProps(new Je.ColorPicker(e,k?null:o,n,i,r,t,a,s,l,c,d,u,h,f,g))},this.dispose=function(){return window.removeEventListener("keydown",z.keyDownEvent),q&&q.dispose(),this.zimContainer_dispose(),!0}},Je.extend(Je.ColorPicker,Je.Container,["clone","dispose"],"zimContainer",!1),Je.Keyboard=function(n,p,m,i,r,a,s,t,z,o,v,l,c,d,u,h,f,g,b,y){var e;if(e=zob(Je.Keyboard,arguments,"labels, color, textColor, shiftColor, shiftHoldColor, placeColor, placeTextColor, cursorColor, shadeAlpha, margin, corner, drag, placeClose, shadowColor, shadowBlur, container, data, place, special, rtl",this))return e;z_d("67.2"),this.zimContainer_constructor(1e3,400),this.type="Keyboard";var w=Je.getDefaultFont(),x=this;zot(n)&&(n=[]),Array.isArray(n)||(n=[n]),zot(p)&&(p="#333"),zot(m)&&(m=w.color?w.color:"white"),zot(i)&&(i="orange"),zot(r)&&(r="red"),zot(a)&&(a="#50c4b7"),zot(s)&&(s=w.color?w.color:"white"),zot(t)&&(t="#50c4b7"),zot(z)&&(z=.2),zot(o)&&(o=5),zot(v)&&(v=30),zot(l)&&(l=!1),zot(c)&&(c=!0),zot(d)&&(d="rgba(0,0,0,.2)"),zot(u)&&(u=14),zot(f)&&(f=[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["shift","z","x","c","v","b","n","m","backspace"],["?123"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC"]],[["+","x","%","=","<",">","{","}","[","]"],["","","","$","","~","`","","",""],["2/2","_","\\","|","","","","","backspace"],["ABC"]]]),x.data=f,zot(g)&&(g=!0),zot(y)&&(y=!1);var C="zim display - Keyboard(): Please pass in a reference to a container with bounds set";if(zot(h)){if(!zimDefaultFrame)return void zog(C);h=zimDefaultFrame.stage}else{if(!h.getBounds)return void zog(C);if(zot(h.stage))return void zog("zim display - Keyboard(): The container must have a stage property")}-1!=d&&0<u&&(x.shadow=new createjs.Shadow(d,3,3,u));var T,k=zimDefaultFrame?zimDefaultFrame.stage:null;x.labels=n;var A=["@","",".","/","away"];zot(b)||A.splice(1,0,b);var E=Je.copy(f[0]);E[3]=E[3].concat(A);var M=Je.copy(f[1]);M[3]=M[3].concat(A);var I=Je.copy(f[2]);I[3]=I[3].concat(A);var S,j,B,O,P,D,L,Y,X,_,R,F=["","","","","","",""],W=["","","","",""],N=["","","","","",""],G=["","","","","","","",""],V=["","","","","","","",""],H=["",""],U=[],Z=95.5,K={default:"default",shift:"shift",number1:"number1",number2:"number2"},q=K.default,Q=!1,J=0,$=[];function ee(e){var t,o=!1;if(q===K.default){for(O.color=e?r:i,t=0;t<U.length-6-(zot(b)?0:1);t++){0<(n=U[t]).label.text.length&&(1===n.name.length?(n.label.text=n.label.text.toUpperCase(),n.label.centerReg(n).mov(0,6)):n.label.centerReg(n))}e||(o=!0,Je.timeout(500,function(){o&&(Q=!0,O.color=r,S.updateCache(),x.stage.update())}),x.on("pressup",function e(t){x.off("pressup",e);o=!1})),q=K.shift}else{for(O.color=p,Q=!1,t=0;t<U.length-6;t++){var n;0<(n=U[t]).label.text.length&&(1===n.name.length?(n.label.text=n.label.text.toLowerCase(),n.label.centerReg(n).mov(0,3)):n.label.centerReg(n))}q=K.default}S.updateCache(),x.stage.update()}function te(e){var t,o,n,i,r,a,s,l=0,c=0,d=!1,u=!1;zot(e)&&(e=K.default),e===K.default?t=E:e===K.number1?t=M:e===K.number2&&(t=I),S=new Container(1e3,430).addTo(x);for(var h=0;h<t.length;h++){(h<=1||e==K.default&&2==h&&"shift"!=t[2][0])&&(l=(Z/2+2.5)*(10-t[h].length));for(var f=0;f<t[h].length;f++){if(a=null,u=d=!1,"backspace"==t[h][f]?(a=Y,u=r=!0):"shift"==t[h][f]?(r=!0,a=L):(3==h||e!=K.default&&2==h)&&0==f?u=r=!0:""==t[h][f]?d=!(r=!1):"away"==t[h][f]?(a=X,u=r=!0):r=!1,i=r?1.5*Z+2.5:d?(Z+5)*(zot(b)?4:3)-5:Z,n=new Je.Rectangle(i,Z,p,null,null,v).cur().addTo(S),u&&n.addChild(new Je.Rectangle(i,Z,"black",null,null,v).alp(z)),n.label=o=a?new Label(""):new Label({lineWidth:10,lineHeight:25,text:t[h][f],color:m,align:"center"}),a){var g=a.clone();g.scaleTo(n,70,70),g.centerReg(n)}s?(s=!1,l+=67.33):(o.centerReg(n).mov(0,isNaN(o.text)?3:7),n.x=l,n.y=c,n.name=t[h][f],2==h&&0==f&&e==K.number1&&(n.toggle="1/2"),2==h&&0==f&&e==K.number2&&(n.toggle="2/2"),3==h&&0==f&&e==K.default&&(n.toggle="?123"),3==h&&0==f&&e!=K.default&&(n.toggle="ABC"),n.toggle&&o.mov(0,3),U.push(n),"shift"==n.name&&(O=n),l=n.x+n.width+5)}c+=Z+5,l=0}S.cache()}function oe(){x.mouseYAmount&&(x.y=x.parent.globalToLocal(0,x.mouseYAmount-R).y)}function ne(){k.off("pressmousemove",x.tickerMouseEvent),Ticker.remove(oe)}function ie(){if(P){for(var e=0,t=0;t<J;t++)e+=P.widthArray[t];B.heightOnly=P.getBounds().height,P.addChild(B),B.x=e}}function re(){if(D)return x;var e,t,o,n=c?["<",">","x"]:["<",">"];$=[],o=P.localToLocal(0,0,x),D=(new Container).addTo(x).pos(o.x,o.y+P.height+15).cur();for(var i=0;i<n.length;i++)e=new Je.Rectangle(Z,Z,a,null,null,v),"x"==n[i]&&new Je.Rectangle(Z,Z,"black",null,null,v).alp(z).addTo(e),(t=new Label({lineWidth:10,lineHeight:25,text:n[i],backing:e,color:s,align:"center"}).addTo(D).cache()).x=i*(Z+5),$.push(t);o=P.localToLocal(0,0,x),D.pos(o.x,o.y+P.height+15),D.on("click",function(e){0==$.indexOf(e.target)?0<J&&J--:1==$.indexOf(e.target)?J<P.text.length&&J++:ae();ie()}),x.stage.update()}function ae(){if(!D)return x;D.removeAllEventListeners(),x.removeChild(D),D=null}function se(e){var t,o;"del"===e?(P&&(P.text=[P.text.slice(0,J-1),P.text.slice(J)].join("")),J--,ce()):(q===K.shift&&(e=e.toUpperCase()),P&&P.width<T&&((t=P.clone()).text=e,o=t.label.getMeasuredWidth(),P.widthArray?P.widthArray.splice(J,0,o):P.widthArray=[P.breedte],J<P.text.length?P.text=[P.text.slice(0,J),e,P.text.slice(J)].join(""):P.text+=e,J++,ie())),q!==K.shift||Q||(x.removeChild(S),te(),q=K.default),ie();var n=new createjs.Event("keydown");n.letter=e,x.dispatchEvent(n),x.stage.update()}function le(e){if(x.stage){var t,o=0,n=!1;(P=e.target).widthArrayCheck||ce(),T=P.label.lineWidth?P.label.lineWidth:1e4,t=P.globalToLocal(e.stageX,e.stageY);for(var i=0;i<P.widthArray.length;i++)if(o+=P.widthArray[i],t.x<o-P.widthArray[i]/2){J=i,n=!0;break}n||(J=P.text.length),ie(),g&&!D&&0<P.text.length&&re(),D&&P&&(0<P.text.length?(t=P.localToLocal(0,0,x),D.pos(t.x,t.y+P.height+15)):ae())}}function ce(){if(P){var e;P.widthArray=[];for(var t=0;t<P.text.length;t++)(e=P.clone()).text=P.text[t],P.widthArray.push(e.label.getMeasuredWidth());P.widthArrayCheck=!0,ie()}}function de(){for(var e=0;e<n.length;e++)n[e].clickEvent=n[e].on("click",le)}function ue(){if(1<n.length)for(var e=0;e<n.length;e++)n[e].off("click",n[e].clickEvent)}function he(){if(!B&&(P=n[0],T=P&&P.label.lineWidth?P.label.lineWidth:1e4,P)){(B=new Je.Rectangle(3,30,t).addTo(P)).x=0,B.y=0,B.visible=!1,B.heightOnly=P.height,B.animate({obj:{alpha:0},rewind:!0,loop:!0,loopWait:750,time:250,id:"knipperTekst"});for(var e=0;e<n.length;e++)n[e].widthArray=[0];ce()}}function fe(){Je.stopAnimate("knipperTekst"),P&&P.removeChild(B),P=B=null}!function(){(L=new Shape).graphics.f(m).p("AhIFoIAAjYIixAAID5n3ID6H3IixAAIAADYgAjHBxICeAAIAADYIBTAAIAAjYICeAAIjImSg"),L.setBounds(-25.5,-36,51,72),Y=new Container;var e=new Shape;e.graphics.f(m).p("ACgC+IigigIifCgQgGAGgJAAQgJAAgGgGQgGgGgBgJQABgJAGgGICgigIigifQgGgGgBgJQABgJAGgGQAGgGAJAAQAIAAAHAGICfCgICgigQAGgGAJAAQAJAAAGAGQAGAGABAJQgBAJgGAGIigCfICgCgQAGAGABAJQgBAJgGAGQgGAGgJAAQgJAAgGgGg"),e.setTransform(82.6,32),e.addTo(Y);var t=new Shape;t.graphics.f(m).s().p("AkhFAQgcAAgUgUIkHj6QgVgUAAgeQAAgdAVgVIEHj6QAUgTAcAAINKAAQAdAAAUAUQAUAUAAAdIAAH1QAAAdgUATQgUAVgdAAgAk0kOIkGD8QgIAHAAALQAAALAIAIIEGD7QAIAHALAAINKAAQALAAAIgIQAHgHAAgLIAAn1QAAgLgHgIQgIgIgLAAItKAAQgLAAgIAHg"),t.setTransform(62.2,32),t.addTo(Y),Y.setBounds(0,0,125,64),(X=new Container).setBounds(0,0,147,86);for(var o,n=[{p:"Ai+heIF9AAIi/C9g",transform:[73.4,76]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.4,43.2]},{p:"AnNAzIAAhlIObAAIAABlg",transform:[73,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.2,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.5,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.8,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[87.1,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.4,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.7,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.3,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.6,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[86.9,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.2,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.5,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]},{p:"AphEnQgzAAgkgkQglglAAgzIAAlVQAAgzAlglQAkgkAzAAITDAAQAzAAAkAkQAlAlAAAzIAAFVQAAAzglAlQgkAkgzAAgAqjjtQgcAcAAAnIAAFVQAAAnAcAbQAbAcAnAAITDAAQAnAAAcgcQAbgbAAgnIAAlVQAAgngbgcQgcgcgnAAIzDAAQgnAAgbAcg",transform:[73.4,29.5]}],i=0;i<n.length;i++)(o=new Shape).graphics.f(m).s().p(n[i].p),o.setTransform(n[i].transform[0],n[i].transform[1]),o.addTo(X)}(),te(q),l&&function(){_=new Je.Rectangle(1.5*Z+2.5+2.5,Z,p,null,null,v).addTo(x,0).cur();for(var e=0;e<4;e++)new Je.Rectangle(.4*_.width,4,m).centerReg(_).alp(.2).y-=15*e-22;_.x=8.5*Z+40,_.y=-Z-5,_.name="drag"}(),this.on("mousedown",function(e){k=x.stage,j&&x.removeChild(j);D&&$.indexOf(e.target)<0&&ae();zot(e.target.name)||(l&&e.target===_?(x.tickerMouseEvent=k.on("stagemousemove",function(e){x.mouseYAmount=e.stageY}),Ticker.add(oe),x.on("pressup",ne),R=e.stageY-x.localToGlobal(0,0).y):zot(b)||e.target.name!==b?"shift"===e.target.name?ee():"?123"===e.target.toggle?(x.removeChild(S),te(K.number1)):"ABC"===e.target.toggle?(x.removeChild(S),q=K.default,te(),Q&&ee(!0)):"1/2"===e.target.toggle?(x.removeChild(S),te(K.number2)):"2/2"===e.target.toggle?(x.removeChild(S),te(K.number1)):"away"===e.target.name?(x.hide(),x.dispatchEvent("close")):"e"===e.target.name||"u"===e.target.name||"i"===e.target.name||"o"===e.target.name||"a"===e.target.name||"n"===e.target.name?function(t){var a,s,l=!1,c=!1;switch(t){case"e":a=F;break;case"u":a=W;break;case"i":a=N;break;case"o":a=G;break;case"a":a=V;break;case"n":a=H}s=Je.timeout(500,function(){var e,t,o,n,i=0;if(s.clear(),!l){c=!0,(j=new Container(1e3,Z).addTo(x,0)).y=-Z-5;for(var r=0;r<a.length;r++)n=q===K.shift?a[r].toUpperCase():a[r],e=new Label({lineWidth:10,lineHeight:25,text:n,color:m,align:"center"}),t=new Je.Rectangle(Z,Z,p,null,null,v).addTo(j),o=new Je.Rectangle(Z,Z,"white",null,null,v).alp(.2),t.addChild(o),e.center(t),t.name=a[r],t.x=i,i+=Z+5;x.stage.update()}});var o=x.on("pressup",function(e){l=!0,x.off("pressup",o),c||se(t)})}(e.target.name):"return"===e.target.name?se("\n"):"backspace"===e.target.name?function(){var t,o=!0;function n(){P&&0<P.text.length?(se("del"),x.on("pressup",i)):se("del")}function i(){o=!1,t.clear(),x.off("pressup",i)}n(),t=Je.timeout(300,function e(){(!P||P.text.length<1)&&(o=!1);o&&(n(),t=Je.timeout(200,e));P.text.length<1&&i()}),x.stage.update()}():""===e.target.name?se(" "):se(e.target.name):x.dispatchEvent("special"),k.update())}),de(),he(),Object.defineProperty(this,"selectedLabel",{get:function(){return P},set:function(e){le({target:e}),x.hidePlace()}}),Object.defineProperty(this,"selectedIndex",{get:function(){return J},set:function(e){J=e,ie()}}),this.show=function(e){(x.addTo(h),x.resize(),zot(e))||le({target:n[e]});return B&&(B.visible=!0),x},this.hide=function(){return x.removeFrom(h),B&&(B.visible=!1),k.update(),x},this.showPlace=function(){return re(),x},this.hidePlace=function(){return ae(),x},this.addLabels=function(e){Array.isArray(e)||(e=[e]);for(var t=e.length-1;0<=t;t--){0<=n.indexOf(e[t])||"Label"!=e[t].type?e.splice(t,1):e[t].widthArray=[0]}return ue(),n=n.concat(e),de(),he(),x},this.removeLabels=function(e){Array.isArray(e)||(e=[e]),ue();for(var t=0;t<e.length;t++){var o=n.indexOf(e[t]);0<=o&&n.splice(o,1)}return de(),0==n.length?P&&fe():P&&-1==n.indexOf(P)&&(fe(),he()),x};var ge=new Je.Rectangle(this.width,this.height,frame.clear).addTo(this).expand().bot();ge.on("mousedown",function(){}),ge.on("click",function(){}),this.resize=function(){return x.scaleTo(k,100-2*o/k.width*100,50-2*o/k.height*100),x.y=k.height-x.height-o,x.x=k.width/2-x.width/2,D&&(point=P.localToLocal(0,0,x),D.pos(point.x,point.y+P.height+15)),x.stage&&x.stage.update(),x},this.clone=function(){var e=new Je.Keyboard(n,p,m,i,r,a,t,z,o,v,l,c,d,u,h,f,g,b,y);return x.cloneProps(e)}},Je.extend(Je.Keyboard,Je.Container,"clone","zimContainer",!1),Je.Loader=function(t,o,n,i,r,a,e,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T){var k;if(k=zob(Je.Loader,arguments,"width, height, label, color, rollColor, borderColor, borderRollColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, flatBottom, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, rollToggle, toggleEvent, frame",this))return k;if(z_d("67.5"),zot(t)&&(t=250),zot(o)&&(o=70),zot(i)&&(i="rgba(0,0,0,.05)"),zot(r)&&(r="rgba(0,0,0,.1)"),zot(a)&&(a="rgba(0,0,0,.3)"),zot(s)&&(s=1),zot(p)&&(p=!0),zot(l)&&(l=0),zot(n)&&(n=new Je.Label({text:"UPLOAD PIC",color:"rgba(0,0,0,.4)",valign:"center",align:"center"})),zot(T)){if(!zimDefaultFrame)return void(zon&&zog("zim.Loader - please provide a reference to zim Frame"));T=zimDefaultFrame}this.zimButton_constructor(t,o,n,i,r,a,e,s,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C),this.type="Loader";var A=this,E=T.stage;n=A.label;var M=A.tag=document.createElement("input");document.body.appendChild(M),M.setAttribute("type","file"),M.setAttribute("multiple","multiple"),M.setAttribute("aria-hidden",!0),M.hidden=!0,M.style.cssText="border:thin solid grey; z-index:2; width:"+t+"px; height:"+o+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none; cursor:pointer; opacity: 0; filter: alpha(opacity=0);",this.addEventListener("mousedown",function(){M.click()}),M.addEventListener("change",S);var I=new createjs.DOMElement(M);function S(e){var n;n=e.dataTransfer&&e.dataTransfer.files&&0<e.dataTransfer.files.length?e.dataTransfer.files:e.target.files;for(var i,t,o,r=[],a=0;a<n.length;a++)t=n[a],o=void 0,(o=new FileReader).onload=function(e){var o=new Image;o.onload=function(){var e=new Je.Bitmap(o);if(r.push(e),1==r.length&&(i=e),r.length==n.length){var t=new createjs.Event("loaded");t.bitmaps=r,t.bitmap=i,t.lastBitmap=e,t.total=r.length,A.dispatchEvent(t),M.value=""}},o.src=e.target.result},o.readAsDataURL(t)}E.addChild(I),I.alpha=0,this.resize=function(){return A.stage?(M.setAttribute("aria-hidden",!1),M.hidden=!1,M.style.display="block",setTimeout(function(){var e=A.localToGlobal(0,0);I.x=T.x+e.x*T.scale,I.y=T.y+e.y*T.scale,Je.sca(I,T.scale*A.scaleX,T.scale*A.scaleY),E.update()},50),A):(M.setAttribute("aria-hidden",!0),M.hidden=!0,void(M.style.display="none"))},this.resize(),A.on("added",function(){M.style.display="block",M.hidden=!1,M.style.display="block",A.resize()}),A.added(function e(){A.resize();setTimeout(function(){M.style.display="block",M.hidden=!1,M.style.display="block"},50);A.on("added",e,null,!0)}),A.on("removed",function(){M.style.display="none",M.hidden=!0,M.style.display="none"}),T.on("resize",A.resize),(new XMLHttpRequest).upload&&M.addEventListener("drop",function(e){M.removeEventListener("change",S),S(e),setInterval(function(){M.addEventListener("change",S)},100)}),this.save=function(e,t,o,n,i,r,a,s,l){var c;if(c=zob(A.save,arguments,"content, filename, x, y, width, height, cached, cachedBounds, type"))return c;if(zot(e)&&(e=T.stage),zot(l)&&(l="png"),zot(t))t="saved_"+String(Je.makeID("numbers",5))+"."+l;else{var d=t.split(".");if(1==d.length)t+="."+l;else{var u=["png","jpg","jpeg"],h=u.indexOf(d[d.length-1].toLowerCase());-1==h?t+="."+l:l=u[h]}}if(zot(o)&&(o=0),zot(n)&&(n=0),zot(i)&&(i=e.getBounds&&e.getBounds()?e.getBounds().width:T.width),zot(r)&&(r=e.getBounds&&e.getBounds()?e.getBounds().height:T.height),e.cache(o,n,i,r),/Edge\/(\d)+/.test(navigator.userAgent)){var f=window.open();f.document.write("<html><head><title>saved</title></head><body style='margin:0px;padding:0px;overflow:hidden'><img src="+e.cacheCanvas.toDataURL("image/"+l)+"></body></html>"),f.document.close()}else{var g=document.createElement("a");g.setAttribute("download",t),g.setAttribute("href",e.cacheCanvas.toDataURL("image/"+l)),document.body.appendChild(g),g.click(),document.body.removeChild(g)}return a?s&&e.cache(cashedBound.x,cashedBound.y,cashedBound.width,cashedBound.height):e.uncache(),A},this.clone=function(){var e=new Je.Loader(t,o,zot(n)?null:n.clone(),i,r,a,s,l,c,d,u,h,f,g,zot(m)?null:m.clone(),zot(z)?null:z.clone(),v,zot(b)?null:b.clone(),zot(y)?null:y.clone(),zot(w)?null:"string"==typeof w?w:w.clone(),zot(x)?null:x.clone(),C,p,T);return A.cloneProps(e)},this.dispose=function(){return document.body.removeChild(M),this.zimButton_dispose(),!0}},Je.extend(Je.Loader,Je.Button,["clone","dispose"],"zimButton",!1),Je.TextArea=function(t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z){var e;if(e=zob(Je.TextArea,arguments,"width, height, size, padding, color, backingColor, borderColor, borderWidth, corner, shadowColor, shadowBlur, dashed, id, placeholder, readOnly, spellCheck, frame",this))return e;if(z_d("67.6"),zot(t)&&(t=250),zot(o)&&(o=70),zot(n)&&(n=20),zot(i)&&(i=5),zot(r)&&(r="#666"),zot(a)&&(a="rgba(256,256,256,.1)"),zot(s)&&(s="rgba(0,0,0,.1)"),zot(c)&&(c=0),!zot(u)&&zot(d)&&(d="rgba(0,0,0,.3)"),!zot(d)&&zot(u)&&(u=10),zot(z)){if(!zimDefaultFrame)return void(zon&&zog("zim.TextArea - please provide a reference to zim Frame"));z=zimDefaultFrame}this.zimContainer_constructor(t,o),this.type="TextArea";var v=this,b=z.stage,y=this.backing=new Je.Rectangle(t,o,a,s,l,c,null,h);-1!=d&&0<u&&(y.shadow=new createjs.Shadow(d,3,3,u)),v.addChild(y);var w=v.tag=document.createElement("textarea");document.body.appendChild(w),zot(f)||(w.setAttribute("id",f),w.setAttribute("name",f)),p&&(w.readOnly=!0),m||(w.spellcheck=!1),zot(g)||w.setAttribute("placeholder",g),w.style.cssText="background-color:rgba(0,0,0,.01); color:"+r+"; resize:none; z-index:3; width:"+(t-2*i)+"px; height:"+(o-2*i)+"px; overflow:hidden; outline:none;font-size:"+n+"px; font-family:verdana; border:none; position:absolute; left:0px; top:0px; display:none;",w.addEventListener("change",function(){v.dispatchEvent("change")}),w.addEventListener("input",function(){v.dispatchEvent("input")}),w.addEventListener("focus",function(){z.zil&&window.removeEventListener("keydown",z.zil[0]),v.dispatchEvent("focus")}),w.addEventListener("blur",function(){z.zil&&window.addEventListener("keydown",z.zil[0]),v.dispatchEvent("blur")});var x=new createjs.DOMElement(w);x.alpha=0,this.on("mousedown",function(){setTimeout(function(){w.focus()},100)}),this.setFocus=function(e){return zot(e)&&(e=!0),e?w.focus():w.blur(),v},this.resize=function(){return setTimeout(function(){var e=v.localToGlobal(i,i);x.x=z.x+e.x*z.scale,x.y=z.y+e.y*z.scale,Je.sca(x,z.scale*v.scaleX,z.scale*v.scaleY),x.alpha=1,v.stage&&b.update()},50),v},this.resize(),v.added(function e(){b.addChild(x);setTimeout(function(){w.style.display="block"},50);v.resize();v.on("added",e,null,!0)}),v.on("removed",function(){b.removeChild(x),w.style.display="none"}),z.on("resize",v.resize),Object.defineProperty(this,"currentValue",{get:function(){return w.value},set:function(e){w.value=e}}),Object.defineProperty(this,"text",{get:function(){return w.value},set:function(e){w.value=e}}),Object.defineProperty(this,"focus",{get:function(){return document.activeElement==w},set:function(e){v.setFocus(e)}}),Object.defineProperty(this,"readOnly",{get:function(){return w.readOnly},set:function(e){w.readOnly=e}}),Object.defineProperty(this,"keyFocus",{get:function(){return zns?Je.KEYFOCUS==v:KEYFOCUS==v},set:function(e){zns?Je.KEYFOCUS=v:KEYFOCUS=v}}),(zns?Je.KEYFOCUS:KEYFOCUS)||(v.keyFocus=!0),w.addEventListener("mousedown",function(){v.keyFocus=!0}),this.clone=function(){var e=new Je.TextArea(t,o,n,i,r,a,s,l,c,d,u,h,f,g,p,m,z);return v.cloneProps(e)},this.dispose=function(){return document.body.removeChild(w),this.zimContainer_dispose(),!0}},Je.extend(Je.TextArea,Je.Container,["clone","dispose"],"zimContainer",!1),Je.drag=function(a,e,r,i,s,t,l,c,d,u,o,h,f,g,n,p){var m;if(m=zob(Je.drag,arguments,"obj, boundary, overCursor, dragCursor, currentTarget, swipe, localBounds, onTop, surround, slide, slideDamp, slideSnap, reg, removeTweens, startBounds, rect"))return m;if(z_d("31"),!zot(a)&&a.on){a.zimDown&&a.noDrag(),a.cursor=zot(r)?"pointer":r,zot(s)&&(s=!1),zot(t)&&(t=!1),zot(l)&&(l=!1),zot(c)&&(c=!0),zot(d)&&(d=!1),zot(u)&&(u=!1),zot(o)&&(o=.3),zot(h)&&(h=!0);if(!0!==h&&["horizontal","vertical","auto"].indexOf(h)<0&&(h=!1),zot(f)&&(f=!1),zot(g)&&(g=!0),zot(n)&&(n=!0),zot(e)&&!zot(p)&&(e=p),u)var z,v,b,y,w,x,C,T,k,A,E,M,I,S;Je.setSwipe(a,t),a.zimBoundary=e,a.zimLocalBounds=l;var j,B,O,P,D,L,Y=!1;return a.zimAdded=a.on("added",X,null,!0),a.zimRemoved=a.on("removed",function(){a.zimDragTicker&&Je.Ticker.remove(a.zimDragTicker)},null,!0),a.parent&&X(),a.pointers={},a.zimDown=a.on("mousedown",function(e){if(a.stage){var t="id"+Math.abs(e.pointerID+1);if(a.pointers[t]=!0,L=s?e.currentTarget:e.target,!a.zimBoundary||L.getBounds()){if(Y=!0,a.stage.mouseMoveOutside=!0,u||(a.zimDragTicker&&Je.Ticker.remove(a.zimDragTicker),a.zimDragTicker=Je.Ticker.add(function(){},a.stage)),g&&createjs.Tween.removeTweens(L),c){var o=L.parent.numChildren-1;"Keyboard"==L.parent.getChildAt(o).type&&o--,L.parent.setChildIndex(L,o),L.ZIMoutlineShape&&L.outline()}var n=L.parent.globalToLocal(e.stageX,e.stageY);f&&(L.x=n.x,L.y=n.y),j=n.x-L.x,B=n.y-L.y,a.zimBoundary&&(l?(P=Je.boundsToGlobal(L.parent,a.zimBoundary),d&&(D=a.zimBoundary)):(P=a.zimBoundary,d&&(D=Je.boundsToGlobal(L.parent,a.zimBoundary,!0)))),a.cursor=zot(i)?"pointer":i,u&&(y=0,w=[n.x],x=[n.y],S=I=-1e4,a.zimDragMoving=!0)}else zog("zim.drag() - drag object needs bounds set")}},!0),a.zimMove=a.on("pressmove",function(e){Y&&(_(L,e.stageX,e.stageY),L.ZIMoutlineShape&&L.outline())},!0),a.zimPosition=_,a.zimUp=a.on("pressup",function(e){var t="id"+Math.abs(e.pointerID+1);if(delete a.pointers[t],Y){if(a.cursor=zot(r)?"pointer":r,u){var o=L.parent.globalToLocal(e.stageX,e.stageY);Y=!1,C=o.x,T=o.y,k=L.x,A=L.y,z.immediate(L.x),v.immediate(L.y)}else{var n=0;for(var i in a.pointers)n++;0==n&&Je.Ticker.remove(a.zimDragTicker)}a.stage&&a.stage.update()}},!0),a}function X(){B=j=0,a.zimBoundary&&(l?(P=Je.boundsToGlobal(a.parent,a.zimBoundary),d&&(D=a.zimBoundary)):(P=a.zimBoundary,d&&(D=Je.boundsToGlobal(a.parent,a.zimBoundary,!0)))),P&&n&&(O=a.parent.localToGlobal(a.x,a.y),_(a,O.x,O.y)),u&&setTimeout(function(){z=new Je.Damp(a.x,o),v=new Je.Damp(a.y,o),b=3,y=0,w=[],x=[],C=a.x,T=a.y,k=a.x,A=a.y,E=a.x,M=a.y,S=I=-1e4,a.zimDragMoving=!0,function(){var i=a.stage;function r(e,t,o,n,i){Math.abs(e.x-I)<.1&&Math.abs(e.y-S)<.1?(a.zimDragMoving=!1,e.x=n,e.y=i,e.dispatchEvent("slidestop")):(I=t,S=o)}a.zimDragTicker=function(){if(L||(L=a),Y){var e=L.parent.globalToLocal(i.mouseX,i.mouseY);y++,w.push(e.x),x.push(e.y),b<=y?(E=w.shift(),M=x.shift()):(E=w[0],M=x[0])}else{if(!a.zimDragMoving)return;var t=k+C-E,o=A+T-M;if(P){var n=R(L,t,o);t=n.x,o=n.y}if(h)L.x=z.convert(t),L.y=v.convert(o),r(L,L.x,L.y,t,o);else{var n=R(L,z.convert(t),v.convert(o));L.x=n.x,L.y=n.y,r(L,L.x,L.y,L.x,L.y)}}},Je.Ticker.add(a.zimDragTicker,i)}()},50),zot(a.zimMaskDynamic)||a.zimMaskApply()}function _(e,t,o){if(zot(e)&&(e=L||a),e.parent&&e.stage){if(zot(t)||zot(o)){var n=e.parent.localToGlobal(e.x,e.y);j=B=0,a.zimBoundary&&(l?(P=Je.boundsToGlobal(e.parent,a.zimBoundary),d&&(D=e.zimBoundary)):(P=a.zimBoundary,d&&(D=Je.boundsToGlobal(e.parent,a.zimBoundary,!0)))),t=n.x,o=n.y,u&&(k=e.x,A=e.y,L=e,z.immediate(k),v.immediate(A))}var i,r=e.parent.globalToLocal(t,o);u&&h?"vertical"==h?(i=R(e,r.x-j,r.y-B),e.x=i.x,e.y=r.y-B):"horizontal"==h?(i=R(e,r.x-j,r.y-B),e.x=r.x-j,e.y=i.y):(e.x=r.x-j,e.y=r.y-B):(i=R(e,r.x-j,r.y-B),e.x=i.x,e.y=i.y)}}function R(e,t,o){if(P)if(d){var n=e.getBounds().width,i=e.getBounds().height,r=e.getBounds().x,a=e.getBounds().y;n<D.width?t=D.x+(D.width-n)/2+(e.regX-r):(t-(e.regX-r)>D.x&&(t=D.x+(e.regX-r)),t-(e.regX-r)+n<D.x+D.width&&(t=D.x+D.width+(e.regX-r)-n)),e.height<D.height?o=D.y+(D.height-i)/2+(e.regY-a):(o-(e.regY-a)>D.y&&(o=D.y+(e.regY-a)),o-(e.regY-a)+i<D.y+D.height&&(o=D.y+D.height+(e.regY-a)-i))}else{var s=e.parent.localToGlobal(t,o);t=Math.max(P.x,Math.min(P.x+P.width,s.x)),o=Math.max(P.y,Math.min(P.y+P.height,s.y)),t=(s=e.parent.globalToLocal(t,o)).x,o=s.y}return{x:t,y:o}}},Je.noDrag=function(e){if(z_d("32"),!zot(e)&&e.on)return e.cursor="default",Je.setSwipe(e,!0),e.off("added",e.zimAdded),e.off("removed",e.zimRemoved),e.off("mousedown",e.zimDown),e.off("pressmove",e.zimMove),e.off("pressup",e.zimUp),Je.Ticker&&e.zimDragSlide&&Je.Ticker.remove(e.zimDragSlide),e.zimDragMoving=e.zimAdded=e.zimRemoved=e.zimDown=e.zimMove=e.zimUp=e.zimBoundary=e.zimDragSlide=null,e},Je.dragBoundary=function(e,t){if(z_d("33"),!zot(e)&&e.on&&!zot(t))return e.zimBoundary=t,e.zimDragMoving=!0,e.zimPosition&&e.zimPosition(),e},Je.dragRect=Je.dragBoundary,Je.transform=function(s,e,t,o,n,i,r,a,l,c,d,u,h,f,g,p,m,z,v,b,y,w,x){var C;if(C=zob(Je.transform,arguments,"obj, move, stretchX, stretchY, scale, rotate, toggle, visible, onTop, showStretch, showRotate, showScale, showReg, showBorder, borderColor, borderWidth, dashed, customCursors, handleSize, regSize, snapDistance, snapRotation, cache"))return C;if(z_d("33.5"),zot(s)||!s.getBounds)return zog("zim methods - transform(): please provide object with bounds set"),s;if(!s.getBounds())return zog("zim methods - transform(): please setBounds() on object"),s;if(!s.parent)return zog("zim methods - transform(): object should be on stage first"),s;zot(e)&&(e=!0),zot(t)&&(t=!0),zot(o)&&(o=!0),zot(n)&&(n=!0),zot(i)&&(i=!0);var T,k=Je.mobile();if(zot(r)&&(r=!0),zot(a)&&(a=!0),zot(l)&&(l=!0),zot(c)&&(c=!!k),zot(d)&&(d=!!k),zot(u)&&(u=!0),zot(h)&&(h=!0),zot(f)&&(f=!0),zot(g)&&(g="brown"),zot(p)&&(p=1),zot(z)&&(z=!k),zot(v)&&(v=Je.mobile()?20:10),zot(b)&&(b=16),zot(y)&&(y=10),zot(w)&&(w=5),zot(x)&&(x=!0),s.mouseChildren=!1,s.stage)T=s.stage;else{if(!zimDefaultFrame)return s;T=zimDefaultFrame.stage}if(!frame){if(!zimDefaultFrame)return s;frame=zimDefaultFrame}var A=s.getBounds(),E=new Je.Shape,M=new Je.Shape;M.controlType="reg";var I,S,j,B,O,P,D,L=s.parent,Y=E.graphics,X=M.graphics,_=new Je.Container;_.type="TransformControls";var R,F,W,N,G,V=new Je.Container,H=new Je.Container,U=new Je.Container,Z=new Je.Container;if(zot(s.zimMaskDynamic)||s.zimMaskApply(),z){var K=new Container,q=new Container;function Q(e){e==K&&new Triangle(16,12,12,"white").addTo(e).mov(0,-13.5),new Triangle(16,12,12,"white").addTo(e).mov(13.5).rot(90),e==K&&new Triangle(16,12,12,"white").addTo(e).mov(0,13.5).rot(180),new Triangle(16,12,12,"white").addTo(e).mov(-13.5).rot(-90),e==K&&new Triangle(10,7,7,"black").addTo(e).mov(0,-13),new Triangle(10,7,7,"black").addTo(e).mov(13).rot(90),e==K&&new Triangle(10,7,7,"black").addTo(e).mov(0,13).rot(180),new Triangle(10,7,7,"black").addTo(e).mov(-13).rot(-90),x&&e.cache(-20,-20,40,40)}Q(K),Q(q);var J={"nw-resize":45,"ne-resize":-45,"n-resize":90,"e-resize":0}}function $(){var e=s;for(W=F=1,G=N=R=0;e.parent;)R+=e.rotation,F*=e.scaleX,W*=e.scaleY,N+=e.skewX,G+=e.skewY,e=e.parent}$();for(var ee=R,te=["nw-resize","ne-resize","nw-resize","ne-resize"],oe=[2,3,0,1],ne=0;ne<4;ne++){var ie=new Je.Rectangle(v,v,u?"#e472c4":"rgba(0,0,0,0)",u?"#333":"rgba(0,0,0,0)",2);x&&ie.cache(-1,-1,v+2,v+2),ie.centerReg(V),ie.expand(0),ie.rotation=R,P=z?"none":te[ne],ie.drag({overCursor:P,dragCursor:P,onTop:!1}),ie.controlType="corner",ie.cu=te[ne]}for(ne=0;ne<oe.length;ne++)V.getChildAt(ne).op=V.getChildAt(oe[ne]);var re=["n-resize","e-resize","n-resize","e-resize"];oe=[1,1,0,0];for(ne=0;ne<4;ne++){var ae=ne%2==0?s.width/2:v,se=ne%2==0?v:s.height/2;if(c){ie=new Je.Rectangle(v,v,"#AAA","#333",2);x&&ie.cache(-1,-1,v+2,v+2)}else ie=new Je.Rectangle(ae,se,"rgba(0,0,0,0)");ie.centerReg(ne%2==0?U:H),ie.rotation=R,ie.expand(0),P=z?"none":re[ne],ie.drag({overCursor:P,dragCursor:P,onTop:!1}),ie.controlType="side",ie.cu=re[ne]}for(ne=0;ne<oe.length;ne++){var le=ne%2==0?U:H;le.getChildAt(Math.floor(ne/2)).op=le.getChildAt(oe[ne])}var ce=["ne-resize","nw-resize","ne-resize","nw-resize"];for(ne=0;ne<4;ne++){(ie=new Je.Circle(v,d?"#e472c4":"rgba(0,0,0,0)")).addTo(Z),x&&ie.cache(-v,-v,2*v,2*v),ie.expand(0),P=z?"none":ce[ne],ie.drag({overCursor:P,dragCursor:P,onTop:!1}),ie.controlType="rotate",ie.cu=ce[ne]}var de=1.8;function ue(){var e=v*de*Je.sign(F),t=v*de*Je.sign(W);Z.getChildAt(0).reg(e,t),Z.getChildAt(1).reg(-e,t),Z.getChildAt(2).reg(-e,-t),Z.getChildAt(3).reg(e,-t),T.update()}function he(){Y.c(),X.c(),I=s.localToGlobal(A.x,A.y),S=s.localToGlobal(A.x+A.width,A.y),j=s.localToGlobal(A.x+A.width,A.y+A.height),B=s.localToGlobal(A.x,A.y+A.height),pTM=s.localToGlobal(A.x+A.width/2,A.y),pRM=s.localToGlobal(A.x+A.width,A.y+A.height/2),pBM=s.localToGlobal(A.x+A.width/2,A.y+A.height),pLM=s.localToGlobal(A.x,A.y+A.height/2),O=s.localToGlobal(s.regX,s.regY),pMid=s.localToGlobal(A.x+A.width/2,A.y+A.height/2),D=[I,S,j,B],mids=[pTM,pRM,pBM,pLM],f&&(Y.s(g),m&&Y.sd([10,5],0),Y.ss(p).mt(I.x,I.y).lt(S.x,S.y).lt(j.x,j.y).lt(B.x,B.y).lt(I.x,I.y).cp()),E.setBounds(I.x,I.y,S.x-I.x,B.y-I.y),h&&(X.s("#eee").ss(p).f("rgba(0,0,0,.1)").dc(0,0,b),X.s("#222").ss(p).dc(0,0,.3*b)),$();for(var e=Math.min(50,Math.abs(N))*Je.sign(N),t=Math.min(50,Math.abs(G))*Je.sign(G),o=R*Je.sign(F*W)*Je.sign(s.scaleX*s.scaleY),n=0;n<D.length;n++){var i=D[n];V.getChildAt(n).pos(i.x,i.y).ske(e,t).rot(o),Z.getChildAt(n).pos(i.x,i.y).rot(o);var r=mids[n],a=n%2==0?U:H;a.getChildAt(Math.floor(n/2)).pos(r.x,r.y).ske(e,t).rot(o),c||a.getChildAt(Math.floor(n/2)).sca(n%2==0?F/2:1,n%2==0?1:W/2)}M.pos(O.x,O.y)}Z.alpha=.5,ue(),he();var fe=new Je.Shape(1e3,1e3);function ge(){fe.pos(0,0),fe.graphics.c().f("rgba(0,0,0,.01)").mt(I.x,I.y).lt(S.x,S.y).lt(j.x,j.y).lt(B.x,B.y).lt(I.x,I.y).cp(),fe.reg(O.x,O.y),fe.pos(O.x,O.y)}ge(),_.on("dblclick",function(e){frame.ctrlKey&&s.transformControls.visible&&(s.scaleX=1,s.scaleY=1,s.rotation=0,he(),ge(),T.update()),Re(e,!0)});var pe=_.on("mousedown",ze),me=s.on("mousedown",ze);function ze(e){s.hitTestPoint(e.stageX,e.stageY)?s.transformControls.visible||(z?(Ve=!1,fe.mouseEnabled=!1):frame.canvas.style.cursor="move",s.transformControls.show(),s.dispatchEvent("transformshow")):s.transformControls.visible&&!_.hitTestPoint(e.stageX,e.stageY)&&(s.transformControls.hide(),s.dispatchEvent("transformhide"))}var ve,be,ye,we,xe,Ce,Te,ke,Ae,Ee,Me,Ie=T.on("stagemousedown",function(e){s.transformControls.visible&&!_.hitTestPoint(e.stageX,e.stageY)&&(s.transformControls.hide(),s.dispatchEvent("transformhide"))});r||(_.off("mousedown",pe),s.off("mousedown",me),T.off("stagemousedown",Ie));var Se,je,Be,Oe=!1,Pe=!1,De=s.cursor,Le=new Circle(30,"rgba(0,0,0,0)").expand(20);if(z){Le.mouseEnabled=!1,Le.mouseChildren=!1,Le.addChild(q),V.on("mouseover",Fe),V.on("mouseout",We),H.on("mouseover",Fe),H.on("mouseout",We),U.on("mouseover",Fe),U.on("mouseout",We),Z.on("mouseover",Fe),Z.on("mouseout",We);var Ye=new Circle(30,"rgba(0,0,0,0)").expand(20);Ye.cursor="none"}function Xe(e){if(Pe=!0,l&&Ne(),Se&&T.off("stagemousemove",Se),ve=e.target.x,be=e.target.y,ke=s.x,Ae=s.y,startSX=s.scaleX,startSY=s.scaleY,"rotate"==e.target.controlType){Oe=!0,ye=s.rotation;var t=e.stageX,o=e.stageY,n=L.localToGlobal(ke,Ae);Ee=n.x,Me=n.y,we=180*Math.atan2(o-Me,t-Ee)/Math.PI}frame.ctrlKey||"rotate"==e.target.controlType?(xe=Math.abs(ve-s.x),Ce=Math.abs(be-s.y)):(xe=Math.abs(ve-e.target.op.x),Ce=Math.abs(be-e.target.op.y)),"rotate"!=e.target.controlType&&(Te={x:e.target.op.x,y:e.target.op.y}),Le.stage?T.setChildIndex(Le,T.getChildIndex(_)):Le.addTo(T,T.getChildIndex(_)+1),Le.pos(e.stageX,e.stageY),Le.cursor=z?"none":e.target.cu,z&&(q.rotation=s.rotation*Je.sign(F*W)*Je.sign(s.scaleX*s.scaleY)+J[e.target.cu]+ee,"side"!=e.target.controlType&&F*W<0&&(q.rotation+=90),Ye.addTo(T,1).pos(e.stageX,e.stageY)),fe.visible=!1,s.cursor="none"}function _e(e){var t;if(t=frame.ctrlKey&&"corner"==e.target.controlType?Ce<xe?(e.target.x-ke)/(ve-ke):(e.target.y-Ae)/(be-Ae):Ce<xe?(e.target.x-e.target.op.x)/(ve-e.target.op.x):(e.target.y-e.target.op.y)/(be-e.target.op.y),"corner"==e.target.controlType?(s.scaleX=t*startSX,s.scaleY=t*startSY):(s.scaleX="e-resize"==e.target.cu?t*startSX:startSX,s.scaleY="n-resize"==e.target.cu?t*startSY:startSY),he(),Le.pos(e.stageX,e.stageY),z&&Ye.pos(e.stageX,e.stageY),!frame.ctrlKey||"side"==e.target.controlType){var o=e.target.op.x,n=e.target.op.y;s.x-=(o-Te.x)*Je.sign(F)*Je.sign(s.scaleX),s.y-=(n-Te.y)*Je.sign(W)*Je.sign(s.scaleY)}he()}function Re(e,t){ue();var o=e?e.target.controlType:"move";t&&(o="reset"),z&&Ye.removeFrom(T);var n=!1;Be=null,"move"==o?(s.x==He.x&&s.y==He.y||((Be=new createjs.Event("transformed")).transformType="move"),n=fe.hitTestPoint(e.stageX,e.stageY)):"corner"==o?(s.scaleX==He.scaleX&&s.scaleY==He.scaleY||((Be=new createjs.Event("transformed")).transformType="size"),n=V.hitTestPoint(e.stageX,e.stageY)):"side"==o?(s.scaleX==He.scaleX&&s.scaleY==He.scaleY||((Be=new createjs.Event("transformed")).transformType="stretch"),n=H.hitTestPoint(e.stageX,e.stageY)||U.hitTestPoint(e.stageX,e.stageY)):"rotate"==o?(s.rotation!=He.rotation&&((Be=new createjs.Event("transformed")).transformType="rotate"),n=Z.hitTestPoint(e.stageX,e.stageY)):"reg"==o?s.regX==He.regX&&s.regY==He.regY||((Be=new createjs.Event("transformed")).transformType="reg"):(Be=new createjs.Event("transformed")).transformType="reset"==o?"reset":"unknown",n||(Le.removeFrom(T),frame.canvas.style.cursor="default",s.cursor=De),T.update(),Be&&s.dispatchEvent(Be)}function Fe(e){Pe||(Le.stage?T.setChildIndex(Le,T.getChildIndex(_)):Le.addTo(T,T.getChildIndex(_)+1),Ye.addTo(T,1),Le.pos(e.stageX,e.stageY),Ye.pos(e.stageX,e.stageY),q.rotation=s.rotation*Je.sign(F*W)*Je.sign(s.scaleX*s.scaleY)+J[e.target.cu]+ee,"side"!=e.target.controlType&&F*W<0&&(q.rotation+=90),T.update(),Se&&T.off("stagemousemove",Se),Se=T.on("stagemousemove",function(e){Le.pos(e.stageX,e.stageY),T.update()}))}function We(e){T.off("stagemousemove",Se),Pe||(s.cursor=De,Le.removeFrom(T),Ye.removeFrom(T),T.update())}function Ne(){if(l){var e=L.numChildren-1;"Keyboard"==L.getChildAt(e).type&&e--,L.setChildIndex(s,e),Ge()}}function Ge(){if(L==T)if(_.stage){var e=T.getChildIndex(s);T.setChildIndex(_,e)}else T.addChildAt(_,T.getChildIndex(s)+1);else{for(var t=L;t.parent!=T;)t=t.parent;_.stage?T.setChildIndex(_,T.getChildIndex(t)+1):T.addChildAt(_,T.getChildIndex(t)+1)}}V.on("mousedown",Xe),V.on("pressmove",_e),V.on("pressup",Re),H.on("mousedown",Xe),H.on("pressmove",_e),H.on("pressup",Re),U.on("mousedown",Xe),U.on("pressmove",_e),U.on("pressup",Re),Z.on("mousedown",Xe),Z.on("pressmove",function(e){var t=180*Math.atan2(e.stageY-Me,e.stageX-Ee)/Math.PI;frame.shiftKey?s.rot(45*Math.round((ye+(t-we)*Je.sign(F)*Je.sign(s.scaleX))/45)):s.rot(ye+(t-we)*Je.sign(F)*Je.sign(s.scaleX));he(),Le.pos(e.stageX,e.stageY),z&&(q.rotation=s.rotation*Je.sign(F*W)*Je.sign(s.scaleX*s.scaleY)+J[e.target.cu]+ee,"side"!=e.target.controlType&&F*W<0&&(q.rotation+=90),Ye.pos(e.stageX,e.stageY));he()}),Z.on("pressup",Re),M.drag(),M.on("mousedown",Ne),M.on("pressup",function(e){if(!frame.ctrlKey){for(var t=0;t<D.length;t++)if(Je.dist(M.x,M.y,D[t].x,D[t].y)<y){M.x=D[t].x,M.y=D[t].y;break}Je.dist(M.x,M.y,pMid.x,pMid.y)<y&&(M.x=pMid.x,M.y=pMid.y)}var o=s.rotation,n=s.globalToLocal(M.x,M.y),i=L.globalToLocal(M.x,M.y);s.reg(n.x,n.y),s.rotation=0,s.pos(s.x+i.x-s.x,s.y+i.y-s.y),s.rotation=o,he(),ge(),Re(e),T.update()});var Ve=!0;P=z?"none":"move",fe.drag({overCursor:P,dragCursor:P,onTop:!1}),fe.controlType="move",z&&(fe.on("mouseover",function(e){if(Pe||!z||!Ve)return;K.addTo(_).pos(e.stageX,e.stageY),T.update(),je&&T.off("stagemousemove",je);je=T.on("stagemousemove",function(e){K.pos(e.stageX,e.stageY),T.update()})}),fe.on("mouseout",function(){if(T.off("stagemousemove",je),Pe)return;K.removeFrom(_),T.update()})),fe.on("mousedown",Ne),fe.on("pressmove",function(){var e=L.globalToLocal(fe.x,fe.y);s.x=e.x,s.y=e.y,he()}),fe.on("pressup",Re);var He,Ue=T.on("stagemouseup",function(){Pe=!1,fe.mouseEnabled=!0,Ve||s.x==He.x&&s.y==He.y||((Be=new createjs.Event("transformed")).transformType="move",s.dispatchEvent(Be)),Ve=!0,fe.visible=!0,Oe&&!frame.ctrlKey&&1<w&&(s.rotation=Math.round(s.rotation/w)*w,he()),ge(),fe.mouseEnabled=!0,Oe=!1,T.update()});function Ze(){He={x:s.x,y:s.y,rotation:s.rotation,regX:s.regX,regY:s.regY,scaleX:s.scaleX,scaleY:s.scaleY}}Ze();var Ke,qe=s.on("mousedown",Ze);_.on("mousedown",Ze);_.addChild(E),e&&_.addChild(fe),n&&_.addChild(V),t&&_.addChild(H),o&&_.addChild(U),i&&_.addChild(Z),_.addChild(M),e&&(s.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),Ke=s.on("pressmove",function(){he(),ge(),ue()}));var Qe=r;return s.transformControls={visible:a,show:function(){return l?Ne():Ge(),s.transformControls.visible=!0,T.update(),s},hide:function(){return T.removeChild(_),s.transformControls.visible=!1,z&&(Se&&T.off("stagemousemove",Se),je&&T.off("stagemousemove",je),Pe=!1,Le.removeFrom(T),Ye.removeFrom(T)),e||(s.cursor=De),T.update(),s},remove:function(){s.transformControls.hide(),r=!1,e&&(s.noDrag(),s.off("pressmove",Ke))},add:function(){s.transformControls.show(),r=Qe,e&&(s.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),Ke=s.on("pressmove",Ke))},toggleOn:function(){r=Qe=!0,pe=_.on("mousedown",pe),me=s.on("mousedown",me),Ie=T.on("stagemousedown",Ie)},toggleOff:function(){r=Qe=!1,_.off("mousedown",pe),s.off("mousedown",me),T.off("stagemousedown",Ie)},disable:function(){_.mouseChildren=!1,_.mouseEnabled=!1,e&&(s.noDrag(),s.off("pressmove",Ke))},enable:function(){_.mouseChildren=!0,_.mouseEnabled=!0,e&&(s.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),Ke=s.on("pressmove",Ke))},recordData:function(e){var t={type:s.type,index:L.getChildIndex(s),x:s.x,y:s.y,scaleX:s.scaleX,scaleY:s.scaleY,rotation:s.rotation,skewX:s.skewX,skewY:s.skewY,regX:s.regX,regY:s.regY,controls:s.transformControls.visible};return e?JSON.stringify(t):t},setData:function(e,t){if(!zot(e)){t&&(e=JSON.parse(e));var o=e.controls;delete e.controls;var n=e.index;for(var i in zot(n)&&(n=0),delete e.index,e)s[i]=e[i];return he(),ge(),ue(),L.setChildIndex(s,n),o?s.transformControls.show():s.transformControls.hide(),s}},resize:function(){return L=s.parent,he(),ge(),ue(),a&&s.transformControls.show(),s},dispose:function(){s.transformControls.hide(),r=!1,e&&(s.noDrag(),s.off("pressmove",Ke)),_.removeAllEventListeners(),me&&s.off("mousedown",me),pe&&s.off("mousedown",pe),Ie&&T.off("stagemousedown",Ie),Se&&T.off("stagemousemove",Se),je&&T.off("stagemousemove",je),Ue&&T.off("stagemouseup",Ue),qe&&s.off("mousedown",qe),Ke&&s.off("pressmove",Ke),_=Le=Ye=null,s.transformControls=null},scaleControls:V,stretchXControls:H,stretchYControls:U,rotateControls:Z},a&&s.transformControls.show(),s},Je.setSwipe=function(r,e){if(z_d("34"),!zot(r)&&r.on)return r.zimNoSwipe=!e||null,r instanceof createjs.Container&&function e(t){var o=t.numChildren;var n;for(var i=0;i<o;i++)(n=t.getChildAt(i)).zimNoSwipe=r.zimNoSwipe,n instanceof createjs.Container&&e(n)}(r),r},Je.gesture=function(C,e,t,l,o,T,k,c,n,d,u,A,i,r,a,s){var h;if(h=zob(Je.gesture,arguments,"obj, move, scale, rotate, boundary, minScale, maxScale, snapRotate, localBounds, slide, slideEffect, regControl, onTop, surround, circularBounds, rect"))return h;if(z_d("34.5"),!zot(C)&&C.on){var f,g;if(zot(e)&&(e=!0),zot(t)&&(t=!0),zot(l)&&(l=!0),zot(n)&&(n=!1),zot(c)&&(c=1),zot(d)&&(d=!1),zot(u)&&(u=5),zot(A)&&(A=!1),zot(i)&&(i=!0),zot(r)&&(r=!1),r&&l&&(r=s=null,zon&&zog("ZIM Gesture() - does not support surround when rotate is true")),zot(a)&&(a=!1),zot(o)&&!zot(s)&&(o=s),zot(C.zimMaskDynamic)||C.zimMaskApply(),!C.zimTouch){var E,M,I,S,j,B,O,p,P=new Je.Damp(C.scaleX,.05),D=new Je.Damp(C.scaleY,.05),L=C.scaleX/C.scaleY;if(C.zimTouch={move:e,scale:t,rotate:l,pointers:{},checkBounds:function(e,t){if(C.zimTouch.boundary){var o=C.zimTouch.boundary,n=C.parent.localToLocal(e,t,C.parent);r?(e=Math.min(o.x,Math.max(o.x+o.width,n.x)),t=Math.min(o.y,Math.max(o.y+o.height,n.y))):(e=Math.max(o.x,Math.min(o.x+o.width,n.x)),t=Math.max(o.y,Math.min(o.y+o.height,n.y))),e=(n=C.parent.globalToLocal(e,t)).x,t=n.y}return{x:e,y:t}}},o){C.zimTouch.boundary=o,n&&(C.zimTouch.boundary=Je.boundsToGlobal(C.parent,o)),C.zimTouch.boundaryStartX=C.zimTouch.boundary.x,C.zimTouch.boundaryStartY=C.zimTouch.boundary.y,C.zimTouch.boundaryStartW=C.zimTouch.boundary.width,C.zimTouch.boundaryStartH=C.zimTouch.boundary.height;var m=C.zimTouch.checkBounds(C.x,C.y);C.x=m.x,C.y=m.y}d&&(slideSlice=10,slideTotal=5,g=0,f=[],C.zimTouch.slideInterval=Je.interval(slideSlice,function(){f[g++%slideTotal]=[C.x,C.y]}),C.zimTouch.slideInterval.pause(),C.animate({x:C.x,y:C.y},10,"quadOut")),C.zimTouch.mousedown=C.on("mousedown",function(e){if(zot(p)?p=1:p++,i){var t=C.parent.numChildren-1;"Keyboard"==C.parent.getChildAt(t).type&&t--,C.parent.setChildIndex(C,t),C.ZIMoutlineShape&&C.outline()}A||(O=null,M=C.scaleX,I=C.scaleY,S=C.rotation,j=C.regX,B=C.regY,C.reg(0,0),E=C.getMatrix(),C.regX=j,C.regY=B);var o="id"+Math.abs(e.pointerID+1),n=C.parent.globalToLocal(e.stageX,e.stageY);C.zimTouch.pointers[o]={startX:n.x,startY:n.y,x:n.x,y:n.y},(C.zimTouch.move||C.zimTouch.rotate)&&(C.zimTouch.total=0,Je.loop(C.zimTouch.pointers,function(e){C.zimTouch.total++})),d&&1==C.zimTouch.total&&C.zimTouch.slideInterval.pause(!1),z()}),C.zimTouch.pressmove=C.on("pressmove",function(e){var t="id"+Math.abs(e.pointerID+1),o=C.parent.globalToLocal(e.stageX,e.stageY);C.zimTouch.pointers[t].x=o.x,C.zimTouch.pointers[t].y=o.y;var n,i,r=0,a=0,s=0,l=0;Je.loop(C.zimTouch.pointers,function(e,t){r+=t.x-t.startX,a+=t.y-t.startY,s+=t.x,l+=t.y}),n=r/C.zimTouch.total,i=a/C.zimTouch.total,r=C.zimTouch.startX+n,a=C.zimTouch.startY+i,s/=C.zimTouch.total,l/=C.zimTouch.total;var c={x:C.x,y:C.y,scaleX:C.scaleX,scaleY:C.scaleY,rotation:C.rotation};if(C.zimTouch.move){var d=C.zimTouch.checkBounds(r,a);c.x=d.x,c.y=d.y}if(2==C.zimTouch.pair.length){var u=C.zimTouch.pair[0],h=C.zimTouch.pair[1];if(C.zimTouch.scale){var f=Math.sqrt(Math.pow(h.startX-u.startX,2)+Math.pow(h.startY-u.startY,2)),g=Math.sqrt(Math.pow(h.x-u.x,2)+Math.pow(h.y-u.y,2)),p=C.zimTouch.startSX+(g/f-1),m=C.zimTouch.startSY+(g/f-1);c.scaleX=p,c.scaleY=m,c.scaleX=P.convert(p),c.scaleY=D.convert(m);var z=!zot(T)&&Math.min(p,m)<T,v=!zot(k)&&Math.max(p,m)>k;(z||v)&&(z?1<L?(c.scaleY=T,c.scaleX=T*L):(c.scaleX=T,c.scaleY=T/L):v&&(1<L?(c.scaleX=k,c.scaleY=k/L):(c.scaleY=k,c.scaleX=k*L)),P.immediate(c.scaleX),D.immediate(c.scaleY))}if(C.zimTouch.rotate){var b=Math.atan2(u.startY-h.startY,u.startX-h.startX)*(180/Math.PI),y=Math.atan2(u.y-h.y,u.x-h.x)*(180/Math.PI)-b;c.rotation=C.zimTouch.startR+y}if(A)C.scaleX=c.scaleX,C.scaleY=c.scaleY,C.rotation=c.rotation,C.zimTouch.move&&(C.x=c.x,C.y=c.y);else{C.reg(0,0);var w=C.parent.localToGlobal(s,l);s=w.x,l=w.y;var x=zot(O)?C.globalToLocal(s,l):C.globalToLocal(O.x,O.y);E.clone().translate(x.x,x.y).rotate(c.rotation-S).scale(c.scaleX/M,c.scaleY/I).translate(-x.x,-x.y).decompose(C),C.zimTouch.move&&(C.x+=n,C.y+=i),O=C.localToGlobal(x.x,x.y),C.reg(j,B)}C.zimTouch.scale&&C.dispatchEvent("scale"),C.zimTouch.rotate&&C.dispatchEvent("rotate"),C.zimTouch.move&&C.dispatchEvent("move")}else C.x=c.x,C.y=c.y,C.zimTouch.move&&C.dispatchEvent("move");C.ZIMoutlineShape&&C.outline(),C.getStage&&C.stage&&C.stage.update()});function z(){C.zimTouch.pair=[],Je.loop(C.zimTouch.pointers,function(e,t,o){t.startX=t.x,t.startY=t.y,o<=1&&C.zimTouch.pair.push(t)}),C.zimTouch.startX=C.x,C.zimTouch.startY=C.y,C.zimTouch.startSX=C.scaleX,C.zimTouch.startSY=C.scaleY,C.zimTouch.startR=C.rotation}function v(){var e=C.localToGlobal(C.regX,C.regY);if(a)var t=C.parent.localToGlobal(C.x-C.width/2,C.y-C.height/2),o=C.parent.localToGlobal(C.x+C.width/2,C.y+C.height/2),n={x:t.x,y:t.y,width:o.x-t.x,height:o.y-t.y};else n=C.boundsToGlobal();var i={x:C.zimTouch.boundaryStartX+e.x-n.x,y:C.zimTouch.boundaryStartY+e.y-n.y,width:C.zimTouch.boundaryStartW-n.width,height:C.zimTouch.boundaryStartH-n.height};C.gestureBoundary(i,!1)}C.on("mousedown",function(){var e=1;C.stage.on("stagemousedown",function(){e++}),C.stage.on("stagemouseup",function(){0==--e&&setTimeout(function(){C.zimTouch&&(C.zimTouch.total=0),C.zimTouch&&(C.zimTouch.pointers={}),p=null},50)})},null,!0),C.zimTouch.pressup=C.on("pressup",function(e){var t="id"+Math.abs(e.pointerID+1);if(delete C.zimTouch.pointers[t],(C.zimTouch.move||C.zimTouch.rotate)&&C.zimTouch.total--,l&&!zot(c)&&0==C.zimTouch.total&&(0<c?C.rotation=Math.round(C.rotation/c)*c:0==c&&(C.rotation=Math.round(C.rotation))),d&&0==C.zimTouch.total&&1==p){C.zimTouch.slideInterval.pause();var o=f[(g+1)%f.length],n=f[g%f.length],i=C.x+(o[0]-n[0])*u,r=C.y+(o[1]-n[1])*u,a=C.zimTouch.checkBounds(i,r),s=slideTotal*slideSlice*u*Math.min((C.x-a.x)/(C.x-i)||1,(C.y-a.y)/(C.y-r)||1);C.animate({x:a.x,y:a.y},s,"quadOut",function(){C.dispatchEvent("slidestop")})}0==C.zimTouch.total&&(p=null),C.getStage&&C.stage&&C.stage.update(),z()}),o&&(v(),C.on("move",v))}return C}},Je.noGesture=function(e,t,o,n){var i;return(i=zob(Je.noGesture,arguments,"obj, move, scale, rotate"))?i:(z_d("34.6"),!zot(e)&&e.on&&e.zimTouch?(zot(t)&&(t=!0),zot(o)&&(o=!0),zot(n)&&(n=!0),e.zimTouch.move=!t,e.zimTouch.scale=!o,e.zimTouch.rotate=!n,e.zimTouch.move||e.zimTouch.scale||e.zimTouch.rotate||(e.off("mousedown",e.zimTouch.mousedown),e.off("pressmove",e.zimTouch.pressmove),e.off("pressup",e.zimTouch.pressup),delete e.zimTouch),e):void 0)},Je.gestureBoundary=function(e,t,o){if(z_d("34.7"),!zot(e)&&e.on&&!zot(t)&&e.zimTouch){e.zimTouch.localBounds&&e.parent?e.zimTouch.boundary=Je.boundsToGlobal(e.parent,t):e.zimTouch.boundary=t,zot(o)&&(o=!0),o&&(e.zimTouch.boundaryStartX=t.x,e.zimTouch.boundaryStartY=t.y,e.zimTouch.boundaryStartW=t.width,e.zimTouch.boundaryStartH=t.height);var n=e.zimTouch.checkBounds(e.x,e.y);return e.x=n.x,e.y=n.y,e}},Je.hitTestPoint=function(e,t,o,n){if(z_d("35"),!e.stage)return!1;if(!zot(e)&&e.globalToLocal){zot(n)&&(n=!0);var i=e.globalToLocal(t,o),r=e.getBounds();if(n&&r){if(i.x>r.x+r.width||i.x<r.x)return!1;if(i.y>r.y+r.height||i.y<r.y)return!1}return e.hitTest(i.x,i.y)}},Je.hitTestReg=function(e,t,o){if(z_d("36"),!e.stage||!t.stage)return!1;if(!zot(e)&&!zot(t)&&e.localToLocal&&t.localToLocal){zot(o)&&(o=!0);var n=t.localToLocal(t.regX,t.regY,e),i=e.getBounds();if(o&&i){if(n.x>i.x+i.width||n.x<i.x)return!1;if(n.y>i.y+i.height||n.y<i.y)return!1}return e.hitTest(n.x,n.y)}},Je.hitTestRect=function(e,t,o,n){if(z_d("37"),!e.stage||!t.stage)return!1;if(!zot(e)&&!zot(t)&&e.hitTest&&t.getBounds){zot(o)&&(o=0),zot(n)&&(n=!0);var i=t.getBounds();if(i){var r=e.getBounds();if(n&&r&&!Je.hitTestBounds(e,t))return!1;var a,s,l=i.x+i.width/2,c=i.y+i.height/2,d=t.localToLocal(l,c,e);if(e.hitTest(d.x,d.y))return!0;for(var u=0;u<=o;u++){if(a=i.width*(u+1)/(o+1),s=i.height*(u+1)/(o+1),d=t.localToLocal(i.x+a,i.y,e),e.hitTest(d.x,d.y))return!0;if(d=t.localToLocal(i.x+i.width,i.y+s,e),e.hitTest(d.x,d.y))return!0;if(d=t.localToLocal(i.x+i.width-a,i.y+i.height,e),e.hitTest(d.x,d.y))return!0;if(d=t.localToLocal(i.x,i.y+i.height-s,e),e.hitTest(d.x,d.y))return!0}}else zog("zim methods - hitTestRect():\n please setBounds() on param b object")}},Je.hitTestCircle=function(e,t,o,n){if(z_d("38"),e.stage&&t.stage&&!zot(e)&&!zot(t)&&e.hitTest&&t.getBounds){zot(o)&&(o=8),zot(n)&&(n=!0);var i=t.getBounds();if(i){var r=e.getBounds();if(n&&r&&!Je.hitTestBounds(e,t))return!1;var a=i.x+i.width/2,s=i.y+i.height/2,l=t.localToLocal(a,s,e);if(e.hitTest(l.x,l.y))return!0;for(var c,d,u,h=(i.width+i.height)/2/2,f=0;f<o;f++)if(c=f/o*2*Math.PI,d=a+h*Math.cos(c),u=s+h*Math.sin(c),l=t.localToLocal(d,u,e),e.hitTest(l.x,l.y))return!0}else zog("zim methods - hitTestCircle():\n please setBounds() on param b object")}},Je.hitTestCircles=function(e,t,o){if(z_d("38.5"),e.stage&&t.stage&&!zot(e)&&!zot(t)&&e.hitTest&&e.getBounds&&t.getBounds){var n=e.getBounds(),i=t.getBounds();if(n&&i){zot(o)&&(o=0);var r=e.localToGlobal(n.x+n.width/2,n.y+n.height/2),a=t.localToGlobal(i.x+i.width/2,i.y+i.height/2),s=e.getConcatenatedMatrix(),l=t.getConcatenatedMatrix();scale1X=Math.sqrt(s.a*s.a+s.c*s.c),scale1Y=Math.sqrt(s.b*s.b+s.d*s.d),scale2X=Math.sqrt(l.a*l.a+l.c*l.c),scale2Y=Math.sqrt(l.b*l.b+l.d*l.d);var c=Math.sqrt(Math.abs(Math.pow(r.x-a.x,2)+Math.pow(r.y-a.y,2)));return n.width*Math.max(scale1X,scale1Y)/2+i.width*Math.max(scale2X,scale2Y)/2>=c-o}zog("zim methods - hitTestCircles():\n please setBounds() on both objects")}},Je.hitTestBounds=function(e,t,o,n){if(z_d("39"),e.stage&&t.stage&&!zot(e)&&!zot(t)&&e.getBounds&&t.getBounds){var i=!1;n&&n.graphics&&(i=!0);var r=e.getBounds(),a=t.getBounds();if(r&&a){zot(o)&&(o=0);var s,l,c=Je.boundsToGlobal(e),d=Je.boundsToGlobal(t);if(i){var u=n.graphics;u.c(),u.ss(1).s("blue"),u.r(c.x,c.y,c.width,c.height),u.s("green"),u.r(d.x,d.y,d.width,d.height),n.stage.update()}return l=d,!((s=c).x>=l.x+l.width+o||s.x+s.width+o<=l.x||s.y>=l.y+l.height+o||s.y+s.height+o<=l.y)}zog("zim methods - hitTestBounds():\n please setBounds() on both objects")}},Je.boundsToGlobal=function(e,t,o){if(z_d("40"),!zot(e)&&e.getBounds){zot(o)&&(o=!1);var n=e.getBounds();if(n||!zot(t)){if(t&&(n=t),o)var i=e.globalToLocal(n.x,n.y),r=e.globalToLocal(n.x+n.width,n.y),a=e.globalToLocal(n.x+n.width,n.y+n.height),s=e.globalToLocal(n.x,n.y+n.height);else i=e.localToGlobal(n.x,n.y),r=e.localToGlobal(n.x+n.width,n.y),a=e.localToGlobal(n.x+n.width,n.y+n.height),s=e.localToGlobal(n.x,n.y+n.height);var l=Math.min(i.x,r.x,a.x,s.x),c=Math.min(i.y,r.y,a.y,s.y),d=Math.max(i.x,r.x,a.x,s.x),u=Math.max(i.y,r.y,a.y,s.y);return new createjs.Rectangle(l,c,d-l,u-c)}zog("zim methods - boundsToGlobal():\n please setBounds() on object (or a rectangle)")}},Je.resetBounds=function(e,t,o,n,i){if(z_d("40.5"),zot(n))r=0,a=t,s=0,l=o;else var r=t,a=n,s=o,l=i;return zot(l)&&(l=a),zot(t)?e.setBounds(null):e.setBounds(r,s,a,l),this},Je.hitTestGrid=function(e,t,o,n,i,r,a,s,l,c,d,u,h){if(z_d("41"),!e.stage)return!1;if(!zot(e)&&!u){var f=e.globalToLocal(r,a);r=f.x,a=f.y}zot(s)&&(s=0),zot(l)&&(l=0),zot(c)&&(c=0),zot(d)&&(d=0);var g=t/n,p=o/i,m=Math.min(n-1,Math.max(0,Math.floor((r-s)/g))),z=Math.min(i-1,Math.max(0,Math.floor((a-l)/p)));if(!(g*(m+1)-c<r-s||r-s<g*m||p*(z+1)-d<a-l||a-l<p*z)){var v=z*n+m;return zot(h)||"index"==h?v:"col"==h?m:"row"==h?z:"array"==h?[v,m,z]:void 0}},Je.animate=function(l,e,n,c,i,r,a,t,o,s,d,u,h,f,g,p,m,z,v,b,y,w,x,C,T,k,A,E,M,I,S,j,B,O,P,D,L){var Y;if(Y=zob(Je.animate,arguments,"target, props, time, ease, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, sequence, sequenceCall, sequenceParams, sequenceReverse, ticker, cjsProps, css, protect, override, from, set, id, events, sequenceTarget, obj"))return Y;if(z_d("45"),0==Je.ANIMATE||!window.zns&&!ANIMATE)return l;zot(e)&&!zot(L)&&(e=L),L=e,l=zik(l),n=zik(n),c=zik(c),a=zik(a),d=zik(d),u=zik(u),m=zik(m),z=zik(z),k=zik(k),j=zik(j),B=zik(B);var X={override:!zot(l.zimX)&&!zot(L.x)||!zot(l.zimY)&&!zot(L.y)};if(zot(s)||(X.loop=s),zot(d)||(X.count=d),zot(u)||(X.loopWait=u),zot(h)||(X.loopCall=h),zot(p)||(X.loopWaitParams=p),zot(g)||(X.loopWaitCall=g),zot(f)||(X.loopParams=f),zot(m)||(X.rewind=m),zot(z)||(X.rewindWait=z),zot(v)||(X.rewindCall=v),zot(b)||(X.rewindParams=b),zot(y)||(X.rewindWaitCall=y),zot(w)||(X.rewindWaitParams=w),zot(e)||(X=Je.merge(X,E)),E=X,zot(x)&&(x=0),0<x&&l.addChild){for(var _=[],R=0;R<l.numChildren;R++)_.push(l.getChildAt(R));D=l,l=_}if(l instanceof Array){k&&l.reverse();var F=0;for(R=0;R<l.length;R++)!function(){var e,o=R;if(j)for(var t in l[o].zimObj={},L)e=zik(L[t]),l[o].zimObj[t]=l[o][t],l[o][t]=e;else for(var t in l[o].zimObj={},L)l[o].zimObj[t]=zik(L[t]);setTimeout(function(){var e=l[F];if(F++,Je.animate(e,e.zimObj,n,c,i,r,a,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,A,Je.copy(E),M,I,S,null,B,O,P,D,L),o==l.length-1&&C){var t=n||1e3;E&&E.rewind&&(t+=(n||1e3)+(E.rewindWait?E.rewindWait:0)),E&&E.loop&&E.loopWait&&(t+=E.loopWait),setTimeout(function(){C(T)},t)}},x*R)}();return D}var W,N,G,V=n;if(zot(V)&&(V=1e3),zot(c)&&(c="quadInOut"),zot(a)&&(a=0),zot(E)&&(E={override:!zot(l.zimX)&&!zot(L.x)||!zot(l.zimY)&&!zot(L.y)}),zot(r)&&(r=l),zot(A)&&(A=!0),zot(M)&&(M=!1),zot(I)&&(I=!1),zot(j)&&(j=!1),zot(B)&&(B={}),B.scale&&(B.scaleX=B.scaleY=B.scale,delete B.scale),zot(S)||(E.override=S),L instanceof Array){var H,U=1;if(0==L.length)return this;function Z(){for(var e,t,o=a,n=0,i=0;i<L.length;i++)if(!zot((e=L[i]).target)){zot(e.time)&&(e.time=V),o+=e.wait?e.wait:0,t=e.time,e.rewind&&(t=2*t+(e.rewindWait?e.rewindWait:0)),e.loop&&(t*=e.loopCount,t+=(e.loopCount-1)*(e.loopWait?e.loopWait:0));var r={target:e.target,obj:Je.copy(e.obj),wait:n+o,waitedCall:e.waitedCall,waitedParams:e.waitedParams,time:e.time,ease:e.ease,from:e.from,rewind:e.rewind,call:e.call,params:e.params,loop:e.loop,loopCount:e.loopCount,loopWait:e.loopWait,loopCall:e.loopCall,loopParams:e.loopParams,loopWaitCall:e.loopWaitCall,loopWaitParams:e.loopWaitParams,rewind:e.rewind,rewindWait:e.rewindWait,rewindCall:e.rewindCall,rewindParams:e.rewindParams,rewindWaitCall:e.rewindWaitCall,rewindWaitParams:e.rewindWaitParams,set:Je.copy(e.masterSet),override:!1,id:O};i==L.length-1&&K(r),Je.animate(r),n+=o+t,o=0}}function K(e){E.loop&&(!E.count||U<E.count)?e.call=function(){function e(){for(var e=0;e<H.objects.length;e++)H.objects[e].set&&H.objects[e].set(H.values[e]);E.loopWaitCall&&"function"==typeof E.loopWaitCall&&E.loopWaitCall(E.loopWaitParams),Z()}E.loopCall&&"function"==typeof E.loopCall&&E.loopCall(E.loopParams),E.loopWait?(zot(l.zimTweens)&&(l.zimTweens={}),W=l.zimTweens[O]=l.zimTween=createjs.Tween.get(l,{override:E.override}).wait(E.loopWait).call(e)):e()}:e.call=function(){i&&"function"==typeof i&&i(r),Te(O)},U++}return function(){var e=new Je.Dictionary;H=new Je.Dictionary;for(var t=0;t<L.length;t++)if(Q=L[t],l||(l=Q.target),zot(Q.target)&&(Q.target=l),zot(Q.ease)&&(Q.ease=c),!zot(Q.target)){if(zot(Q.props)&&!zot(Q.obj)&&(Q.props=Q.obj),Q.obj=Q.props,Q.loop&&(zot(Q.loopCount)||Q.loopCount<=0)&&(Q.loopCount=0,L.splice(t+1,L.length)),zot(Q.obj.scale)||(Q.obj.scaleX=Q.obj.scaleY=Q.obj.scale,delete Q.obj.scale),Q.from){var o=e.at(Q.target);if(o){if(Q.set){var n=Je.copy(Q.obj),i=Je.merge(o,Q.set);Q.obj=ve(Q.target,Q.obj,i),Q.set=Je.merge(Q.set,n)}else Q.set=Je.copy(Q.obj),Q.obj=ve(Q.target,Q.obj,o);Q.from=!1}else e.add(Q.target,ve(Q.target,Q.obj,Q.set))}var r={};for(var a in Q.obj)r[a]=Q.set&&Q.set[a]?Q.set[a]:Q.target[a];zot(H.at(Q.target))&&H.add(Q.target,{});var s=Je.merge(H.at(Q.target),r);H.remove(Q.target),H.add(Q.target,s),Q.masterSet=Je.copy(Q.set)}zot(l.zimTweens)&&(l.zimTweens={})}(),ze(),Z(),l}if(L.x&&(l.zimX=!0),L.y&&(l.zimY=!0),!zot(l)){var q;if(M&&(A=!1),zot(l.zimTweens)&&(l.zimTweens={}),l.stage)q=l.stage;else{if(!zimDefaultFrame)return;q=zimDefaultFrame.stage}for(var Q in zot(L.scale)||(L.scaleX=L.scaleY=zik(L.scale),delete L.scale),L){if(!l.zimBusy)break;l.zimBusy[Q]&&delete L[Q]}if(!Je.isEmpty(L)){l.paused=!1;var J=l.mouseEnabled;for(var R in(I||E.loop||E.rewind)&&(l.mouseEnabled=!1,setTimeout(function(){for(var e in l.zimBusy||(l.zimBusy={}),L)l.zimBusy[e]=!0;l.mouseEnabled=J},70)),ze(),L)L[R]=zik(L[R]);for(R in B)B[R]=zik(B[R]);for(R in E)"waitedCall"!=R&&"waitedParams"!=R&&"loopCall"!=R&&"rewindCall"!=R&&"loopWaitCall"!=R&&"rewindWaitCall"!=R&&(E[R]=zik(E[R]));for(R in L)"string"==typeof L[R]&&(L[R]=l[R]+Number(L[R].replace(/\s/g,"")));for(R in B)"string"==typeof B[R]&&(B[R]=l[R]+Number(B[R].replace(/\s/g,"")));j&&(L=ve(l,L,B,!0));var $=0;if(E.loop&&!zot(E.count)){$=E.count,delete E.count;U=1}var ee,te=0;E.loopWait&&(te=E.loopWait,delete E.loopWait),E.loopCall&&(ee=E.loopCall,delete E.loopCall);var oe,ne=l;E.loopParams&&(ne=E.loopParams,delete E.loopParams),E.loopWaitCall&&(oe=E.loopWaitCall,delete E.loopWaitCall);var ie,re=l;if(E.loopWaitParams&&(re=E.loopWaitParams,delete E.loopWaitParams),E.rewind){if(c){var ae=c;-1==ae.indexOf("InOut")&&(-1!=ae.indexOf("Out")?ae=ae.replace("Out","In"):-1!=ae.indexOf("In")&&(ae=ae.replace("In","Out")))}var se,le,ce=0;if(delete E.rewind,E.rewindWait&&(ce=E.rewindWait,delete E.rewindWait),E.rewindCall){se=E.rewindCall;var de=E.rewindParams;zot(de)&&(de=l),delete E.rewindCall,delete E.rewindParams}function ue(){se&&"function"==typeof se&&se(de)}if(E.rewindWaitCall){le=E.rewindWaitCall;var he=E.rewindWaitParams;zot(he)&&(he=l),delete E.rewindWaitCall,delete E.rewindWaitParams}function fe(){le&&"function"==typeof le&&le(he)}function ge(){var e=xe();l.set&&!j&&l.set(B),W=l.zimTweens[O]=l.zimTween=createjs.Tween.get(l,E).to(L,V,createjs.Ease[c]).call(fe).wait(ce).call(ue).to(e,V,createjs.Ease[ae]).call(we).wait(te).call(be),Ce()}0<a?W=l.zimTweens[O]=l.zimTween=createjs.Tween.get(l,{override:E.override}).wait(a).call(function(){t&&"function"==typeof t&&t(zot(o)?l:o),ge()}):ge()}else{function pe(){l.set&&!j&&l.set(B),W=l.zimTweens[O]=l.zimTween=createjs.Tween.get(l,E).to(L,V,createjs.Ease[c]).call(we).wait(te).call(be),Ce()}0<a?W=l.zimTweens[O]=l.zimTween=createjs.Tween.get(l,{override:E.override}).wait(a).call(function(){t&&"function"==typeof t&&t(zot(o)?l:o),pe()}):pe()}!M&&A&&(ie=P&&!zot(D)&&D.dispatchEvent?Je.Ticker.add(function(){D.dispatchEvent("animation")},q):P&&l.dispatchEvent?Je.Ticker.add(function(){l.dispatchEvent("animation")},q):Je.Ticker.add(function(){},q)),zot(l.zimMaskDynamic)||l.zimMaskApply();var me=!1;return Ce(),l.stopAnimate&&l.stopAnimate.real||(l.stopAnimate=function(e,t){if(l.paused=null,zot(t)&&(t=!0),zot(e)){if(!t)return l;for(var o in l.zimBusy=null,createjs.Tween.removeTweens(l),l.zimTweens)ke(o);l.zimTweens=null,l.zimIdSets=null,Je.idSets&&Je.idSets[N||o]&&(delete Je.idSets[N||o],Je.isEmpty(Je.idSets)&&delete Je.idSets),Je.animatedObjects.remove(l)}else{Array.isArray(e)||(e=[e]);var n=Ee(e);for(var o in l.zimTweens)t&&0<=n.indexOf(o)&&Te(o),!t&&n.indexOf(o)<0&&Te(o)}return l},l.stopAnimate.real=!0,l.pauseAnimate=function(e,t,o){if(zot(e)&&(e=!0),l.paused=e,zot(o)&&(o=!0),zot(t)&&!o)return l;if(zot(t))for(var n in l.zimTweens)Ae(n,e);else{Array.isArray(t)||(t=[t]);var i=Ee(t);for(var n in l.zimTweens)o&&0<=i.indexOf(n)&&Ae(n,e),!o&&i.indexOf(n)<0&&Ae(n,e)}return l}),l}}function ze(){zot(O)?O=Je.makeID(10):(O=String(O),G=O),zot(l.zimIdSets)&&(l.zimIdSets={}),zot(l.zimIdSets[O])?zot(l.zimTweens[O])||(N=O,O=Je.makeID(10),l.zimIdSets[N]=[N],l.zimTweens[N].zimIdSet=N,l.zimIdSets[N].push(O)):(N=O,O=Je.makeID(10),l.zimIdSets[N].push(O))}function ve(e,t,o,n){var i={};for(R in t)o&&!zot(o[R])?i[R]=o[R]:i[R]=e[R],n&&(e[R]=t[R]);return i}function be(){ee&&"function"==typeof ee&&ee(ne)}function ye(){oe&&"function"==typeof oe&&oe(re)}function we(){if(E.loop){if(!(0<$))return void ye();if(U<$)return ye(),void U++;m?l.set&&l.set(xe()):l.set&&l.set(L)}Te(O),l.paused=null,l.zimX=null,l.zimY=null,i&&"function"==typeof i&&i(r)}function xe(){var e={};for(var t in L)M?zot(B[t])||j?e[t]=l.style[t]:e[t]=B[t]:zot(B[t])||j?e[t]=l[t]:e[t]=B[t];return e}function Ce(){W.zimObj=L,W.zimTicker=ie,W.zimPaused=me,N&&(W.zimIdSet=N),G&&(zot(Je.idSets)&&(Je.idSets={}),zot(Je.idSets[G])?Je.idSets[G]=[l]:Je.idSets[G].indexOf(l)<0&&Je.idSets[G].push(l)),Je.animatedObjects||(Je.animatedObjects=new Je.Dictionary(!0)),Je.animatedObjects.add(l,!0)}function Te(e){if(!zot(l.zimTweens)&&!zot(l.zimTweens[e])){!function(e){if(l.zimBusy){for(var t in e)delete l.zimBusy[t];Je.isEmpty(l.zimBusy)&&(l.zimBusy=null)}}(l.zimTweens[e].zimObj),l.zimTweens[e].paused=!0,ke(e);var t=l.zimTweens[e].zimIdSet;if(!zot(t)&&l.zimIdSets){var o=l.zimIdSets[t];o&&o.splice(o.indexOf(e),1),o&&0==o.length&&(delete l.zimIdSets[t],Je.isEmpty(l.zimIdSets)&&delete l.zimIdSets)}if(delete l.zimTweens[e],Je.isEmpty(l.zimTweens)&&l.stopAnimate(),l.zimTweens&&l.zimTweens[e]||l.zimIdSets&&l.zimIdSets[t||e]);else if(Je.idSets&&Je.idSets[t||e]){Je.idSets[t||e];var n=Je.idSets[t||e].indexOf(l);0<=n&&Je.idSets[t||e].splice(n,1),Je.idSets[t||e].length<=0&&(delete Je.idSets[t||e],Je.isEmpty(Je.idSets)&&delete Je.idSets)}}}function ke(e){var t;t=l.zimTweens[e].zimTicker,setTimeout(function(){t&&Je.Ticker.remove(t),t=null},200)}function Ae(e,t){var o=l.zimTweens[e];(o.paused=t)!=o.zimPaused&&((o.zimPaused=t)?o.zimTicker&&(o.zimAnimateTimeout=setTimeout(function(){Je.Ticker.remove(o.zimTicker)},200)):(clearTimeout(o.zimAnimateTimeout),o.zimTicker&&(o.zimTicker=Je.Ticker.add(o.zimTicker,q))))}function Ee(e){for(var t=[],o=0;o<e.length;o++)l.zimIdSets&&!zot(l.zimIdSets[e[o]])?t=t.concat(l.zimIdSets[e[o]]):t.push(e[o]);return t}},Je.stopAnimate=function(e){if(z_d("45.12"),zot(e)){if(Je.animatedObjects)for(var t=Je.animatedObjects.length-1;0<=t;t--)Je.animatedObjects.objects[t].stopAnimate()}else if(Array.isArray(e)||(e=[e]),Je.idSets)for(var o=0;o<e.length;o++){var n=e[o];if(Je.idSets[n])for(t=Je.idSets[n].length-1;0<=t;t--)Je.idSets[n][t].stopAnimate(n)}},Je.stopZimAnimate=function(e){z_d("45.1"),Je.stopAnimate(e)},Je.pauseAnimate=function(e,t){if(z_d("45.22"),zot(e)&&(e=!0),zot(t)){if(Je.animatedObjects)for(var o=Je.animatedObjects.length-1;0<=o;o--)Je.animatedObjects.objects[o].pauseAnimate(e)}else if(Array.isArray(t)||(t=[t]),Je.idSets)for(var n=0;n<t.length;n++){var i=t[n];if(Je.idSets[i])for(o=Je.idSets[i].length-1;0<=o;o--)Je.idSets[i][o].pauseAnimate(e,i)}},Je.pauseZimAnimate=function(e,t){z_d("45.2"),Je.pauseAnimate(e,t)},Je.wiggle=function(r,a,s,l,c,d,u,e,h,f,g,p,m,t){var o;if(o=zob(Je.wiggle,arguments,"target, property, baseAmount, minAmount, maxAmount, minTime, maxTime, totalTime, type, ease, integer, id, startType, ticker"))return o;if(z_d("45.25"),zot(r)||zot(s)||zot(l))return r;zot(c)&&(c=l),zot(d)&&(d=1e3),zot(u)&&(u=d),zot(f)&&(f="quadInOut"),zot(g)&&(g=!1),zot(p)&&(p=Je.makeID()),zot(h)&&(h="both"),zot(m)&&(m="both"),zot(t)&&(t=!0),zot(e)||(r.wiggleTimeout=setTimeout(function(){r.stopAnimate(p)},e));var z,v=0;return function e(){var t=Je.rand(zik(d),zik(u)),o={},n={};if(n[a]=zik(s),"negative"==h||0==v&&"negative"==m)var i=-Je.rand(zik(l),zik(c),g);else i="positive"==h||0==v&&"positive"==m?Je.rand(zik(l),zik(c),g):0==v?Je.rand(zik(l),zik(c),g,!0):Je.rand(zik(l),zik(c),g)*Je.sign(z)*-1;o[a]=zik(s)+i,0==v&&(t/=2),z=i,v++,"negative"==h||"positive"==h?Je.animate({target:r,obj:o,set:n,ease:f,time:2*t,rewind:!0,override:!1,call:e,id:p,ticker:!!r.stage}):Je.animate({target:r,obj:o,ease:f,time:t,override:!1,call:e,id:p,ticker:!!r.stage})}(),r},Je.loop=function(e,t,o,n,i,r){var a;if(a=zob(Je.loop,arguments,"obj, call, reverse, step, start, end"))return a;if(z_d("45.3"),!zot(e)&&!zot(t)){zot(o)&&(o=!1),(zot(n)||n<=0)&&(n=1);var s="number"==typeof e?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":"container";if("container"!=s||e.addChild)if("number"==s||"array"==s||"nodelist"==s){if(0==(h=f((d="number"==s?e:e.length)-1)))return;if(o)for(var l=i;r<=l;l-=n){if("number"==s)var c=t(l,h,i,r,e);else if("array"==s)c=t(e[l],l,h,i,r,e);else c=t(e.item(l),l,h,i,r,e);if(void 0!==c)return c}else for(l=i;l<=r;l+=n){if("number"==s)c=t(l,h,i,r,e);else if("array"==s)c=t(e[l],l,h,i,r,e);else c=t(e.item(l),l,h,i,r,e);if(void 0!==c)return c}}else if("object"==s){var d=0,u=[];for(var l in e)d++,u.push(l);if(0==(h=f(d-1)))return;if(o)for(l=i;r<=l;l-=n){if(void 0!==(c=t(u[l],e[u[l]],l,h,i,r,e)))return c}else for(l=i;l<=r;l+=n){if(void 0!==(c=t(u[l],e[u[l]],l,h,i,r,e)))return c}}else{var h;if(0==(h=f(e.numChildren-1)))return;if(o)for(l=i;r<=l;l-=n){if(void 0!==(c=t(e.getChildAt(l),l,h,i,r,e)))return c}else for(l=i;l<=r;l+=n){if(void 0!==(c=t(e.getChildAt(l),l,h,i,r,e)))return c}}}function f(e){return zot(i)&&(i=o?e:0),zot(r)&&(r=o?0:e),o&&i<r||!o&&r<i?0:(i<0&&r)<0||e<i&&e<r?0:(i=Math.max(0,Math.min(i,e)),r=Math.max(0,Math.min(r,e)),Math.floor((o?i-r:r-i)/n)+1)}},Je.copyMatrix=function(e,t){return z_d("45.5"),e.x=t.x,e.y=t.y,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.regX=t.regX,e.regY=t.regY,e.rotation=t.rotation,e.skewX=t.skewX,e.skewY=t.skewY,e},Je.cur=function(e,t){return z_d("41.1"),zot(e)?zog("zim methods - cur(): please provide object"):(zot(t)&&(t="pointer"),e.cursor=t),e},Je.sha=function(e,t,o,n,i){return z_d("41.2"),zot(e)?(zog("zim methods - sha(): please provide object"),e):(zot(t)&&(t="rgba(0,0,0,.3)"),t.blur?e.shadow=t:(zot(o)&&(o=e.width?.08*e.width:5),zot(n)&&(n=e.height?.08*e.height:5),zot(i)&&(i=e.width?.16*e.width:10),e.shadow=new createjs.Shadow(t,o,n,i)),e)},Je.pos=function(e,t,o,n,i,r){var a;return(a=zob(Je.pos,arguments,"obj, x, y, container, index, add"))?a:(z_d("41.5"),zot(e)?void 0:(zot(t)||(e.x=t),zot(o)||(e.y=o),zot(r)&&(r=!0),!zot(n)&&r&&(zot(i)||"number"==typeof i&&isNaN(i)?n.addChild(e):n.addChildAt(e,i)),e))},Je.mov=function(e,t,o){if(z_d("41.6"),!zot(e))return zot(t)||(e.x+=t),zot(o)||(e.y+=o),e},Je.top=function(e){if(z_d("41.62"),!zot(e)&&e.parent)return e.parent.setChildIndex(e,e.parent.numChildren-1),e},Je.bot=function(e){if(z_d("41.63"),!zot(e)&&e.parent)return e.parent.setChildIndex(e,0),e},Je.dep=function(e,t){if(z_d("41.65"),!zot(e))return zot(t)&&(t=0),e.depth=t,e},Je.alp=function(e,t){if(z_d("41.7"),!zot(e))return zot(t)||(e.alpha=t),e},Je.rot=function(e,t){if(z_d("41.8"),!zot(e))return zot(t)||(e.rotation=t),e},Je.siz=function(e,t,o,n){if(z_d("41.85"),!zot(e))return zot(n)&&(n=!1),zot(t)||zot(o)?zot(t)?zot(o)||(n?e.heightOnly=o:e.height=o):n?e.widthOnly=t:e.width=t:(e.widthOnly=t,e.heightOnly=o),e},Je.ske=function(e,t,o){if(z_d("41.9"),!zot(e))return zot(t)||(e.skewX=t),zot(o)||(e.skewY=o),e},Je.reg=function(e,t,o){if(z_d("41.95"),!zot(e))return zot(t)||(e.regX=t),zot(o)||(e.regY=o),e},Je.sca=function(e,t,o){if(z_d("41.97"),!zot(e)&&!zot(e.scaleX))return zot(t)&&(t=e.scaleX),zot(o)&&(o=t),e.scaleX=t,e.scaleY=o,e},Je.scaleTo=function(e,t,o,n,i,r){var a;if(a=zob(Je.scaleTo,arguments,"obj, boundObj, percentX, percentY, type, boundsOnly"))return a;if(z_d("43"),!zot(e)&&e.getBounds&&e.getBounds()){if(!zot(t)&&t.getBounds&&t.getBounds()){zot(o)&&(o=-1),zot(n)&&(n=-1),-1==o&&-1==n&&(o=n=100),zot(i)&&(i="smallest"),zot(r)&&(r=!1);var s=t.getBounds().width*o/100*(r?1:t.scaleX),l=t.getBounds().height*n/100*(r?1:t.scaleY);if((-1==o||-1==n)&&"both"!=i&&"stretch"!=i)return-1==o?Je.sca(e,l/e.getBounds().height):Je.sca(e,s/e.getBounds().width),e;if("both"==i||"stretch"==i)return e.scaleX=-1!=o?s/e.getBounds().width:e.scaleX,e.scaleY=-1!=n?l/e.getBounds().height:e.scaleY,e;if("biggest"==i||"largest"==i||"outside"==i)var c=Math.max(s/e.getBounds().width,l/e.getBounds().height);else c=Math.min(s/e.getBounds().width,l/e.getBounds().height);return Je.sca(e,c),e}zog("zim methods - scaleTo(): please provide a boundObject (with setBounds) to scale to")}else zog("zim methods - scaleTo(): please provide an object (with setBounds) to scale")},Je.fit=function(e,t,o,n,i,r){var a;if(a=zob(Je.fit,arguments,"obj, left, top, width, height, inside"))return a;if(z_d("46"),!zot(e)&&e.getBounds){if(e.getBounds()){if(zot(t)){if(!e.stage)return void zog("zim methods - fit(): please add boundary dimensions or add obj to stage first");if(!e.stage.getBounds())return void zog("zim methods - fit(): please add boundary dimensions or add obj with bounds to stage first");o=t=0,n=e.stage.getBounds().width,i=e.stage.getBounds().height}zot(r)&&(r=!0),e.scaleX=e.scaleY=1;var s,l=n,c=i,d=e.getBounds().width,u=e.getBounds().height;s=r?d/u<=l/c?c/u:l/d:d/u<=l/c?l/d:c/u,e.scaleX=e.scaleY=s;var h=d*s,f=u*s;return e.x=(e.regX-e.getBounds().x)*s+t+(l-h)/2,e.y=(e.regY-e.getBounds().y)*s+o+(c-f)/2,{x:e.x,y:e.y,width:h,height:f,scale:s,bX:t,bY:o,bWidth:n,bHeight:i}}zog("zim methods - fit(): please setBounds() on object")}},Je.outline=function(t,e,o){var n;if(n=zob(Je.outline,arguments,"obj, color, size"))return n;if(z_d("47"),zot(t)||!t.getBounds)return zog("zim methods - outline(): please provide object with bounds set"),t;if(!t.getBounds())return zog("zim methods - outline(): please setBounds() on object"),t;if(!t.parent)return zog("zim methods - outline(): object should be on stage first"),t;if(zot(e)&&(e="brown"),zot(o)&&(o=2),o<=0)return t.ZIMoutlineShape&&t.ZIMoutlineShape.parent.removeChild(t.ZIMoutlineShape),t.ZIMoutlineShapeC&&t.ZIMoutlineShapeC.parent.removeChild(t.ZIMoutlineShapeC),void(t.ZIMoutlineShape=t.ZIMoutlineShapeC=null);var i=t.getBounds(),r=t.ZIMoutlineShape=t.ZIMoutlineShape?t.ZIMoutlineShape:new createjs.Shape,a=t.ZIMoutlineShapeC=t.ZIMoutlineShapeC?t.ZIMoutlineShapeC:new createjs.Shape,s=t.parent;t.toggled=!0,t.toggle=function(e){return!0===e?(t.ZIMoutlineShape.visible=!0,t.ZIMoutlineShapeC.visible=!0):!1===e?(t.ZIMoutlineShape.visible=!1,t.ZIMoutlineShapeC.visible=!1):(t.ZIMoutlineShape.visible=!t.ZIMoutlineShape.visible,t.ZIMoutlineShapeC.visible=!t.ZIMoutlineShapeC.visible),t.toggled=t.ZIMoutlineShape.visible,t};var l=t.localToLocal(i.x,i.y,s),c=t.localToLocal(i.x+i.width,i.y,s),d=t.localToLocal(i.x+i.width,i.y+i.height,s),u=t.localToLocal(i.x,i.y+i.height,s),h=t.localToLocal(0,0,s),f=r.graphics.c(),g=a.graphics.c();f.s(e).ss(o).mt(l.x,l.y).lt(c.x,c.y).lt(d.x,d.y).lt(u.x,u.y).lt(l.x,l.y).cp();g.s("white").ss(o+2),g.mt(-11,0).lt(11,0),g.mt(0,-11).lt(0,11),g.s(e).ss(o),g.mt(-10,0).lt(10,0),g.mt(0,-10).lt(0,10),a.x=h.x,a.y=h.y,a.rotation=t.rotation,f.s("white").ss(o+2).dc(t.x,t.y,16),f.s(e).ss(o).dc(t.x,t.y,16),t.parent.removeChild(r),t.parent.removeChild(a);var p=t.parent.getChildIndex(t);return t.parent.addChildAt(a,p+1),t.parent.addChildAt(r,p+1),r.mouseEnabled=!1,a.mouseEnabled=!1,t},Je.addTo=function(e,t,o,n){var i;if(i=zob(Je.addTo,arguments,"obj, container, index, localToLocal"))return i;if(z_d("47.5"),!zot(e)){if(zot(t)){if(!zimDefaultFrame)return void zog("zim methods - addTo(): please provide container");t=zimDefaultFrame.stage}if(zot(n)&&(n=!0),e.parent||(n=!1),n)var r=e.parent.localToLocal(e.x,e.y,t);return zot(o)||isNaN(o)?t.addChild(e):t.addChildAt(e,o),n&&e.pos(r.x,r.y),e}zog("zim methods - addTo(): please provide object")},Je.removeFrom=function(e,t){if(z_d("47.6"),!zot(e))return zot(t)?e.parent&&e.parent.removeChild(e):t.removeChild(e),e;zog("zim methods - removeFrom(): please provide object")},Je.added=function(e,t,o,n){if(z_d("47.7"),!zot(e)&&!zot(t)&&"function"==typeof t){if(zot(o)&&(o=100),!e.stage){var i=Date.now(),r=0,a=setInterval(function(){5<r?clearInterval(a):(r++,e.stage&&(t(e.stage,e),clearInterval(a),clearInterval(s)))},10),s=setInterval(function(){0<n&&i-Date.now()>n&&clearInterval(s),e.stage&&(t(e.stage,e),clearInterval(s))},o);return s}t(e.stage,e)}},Je.centerReg=function(e,t,o,n){var i;if(i=zob(Je.centerReg,arguments,"obj, container, index, add"))return i;if(z_d("48"),zot(e)||!e.getBounds||!e.getBounds())return zog("zim methods - centerReg(): please provide object with bounds set"),e;zot(n)&&(n=!0),e.parent&&n&&(t=e.parent,zot(o)&&(o=e.parent.getChildIndex(e)),e.parent.removeChild(e));var r=e.getBounds();return e.regX=r.x+r.width/2,e.regY=r.y+r.height/2,n?Je.center(e,t,o):e},Je.center=function(e,t,o,n){var i;if(i=zob(Je.center,arguments,"obj, container, index, add"))return i;if(z_d("48.1"),!zot(e)&&e.getBounds){if(zot(t)&&(e.parent?t=e.parent:zimDefaultFrame&&(t=zimDefaultFrame.stage)),!zot(t)&&t.getBounds){var r=e.getBounds(),a=t.getBounds();if(zot(n)&&(n=!0),n&&t.addChild&&(zot(o)||"number"==typeof o&&isNaN(o)?t.addChild(e):t.addChildAt(e,o)),zot(a))return e;if(zot(r))return e.x=t.getBounds().width/2,e.y=t.getBounds().height/2,e;var s=e.localToLocal(e.regX,e.regY,t),l=Je.boundsToGlobal(e),c=Je.boundsToGlobal(t,l,!0);if(e.x=a.x+a.width/2-c.width/2+(s.x-c.x),e.y=a.y+a.height/2-c.height/2+(s.y-c.y),!n&&t.getStage&&t.stage&&e.parent){var d=t.localToLocal(e.x,e.y,e.parent);e.x=d.x,e.y=d.y}return e}zog("zim.center(): please provide container with bounds")}else zog("zim.center(): please provide object with bounds")},Je.place=function(e,t){if(z_d("49"),!zot(e))return zot(t)&&(t="obj"),Je.drag({obj:e,currentTarget:!0,dragCursor:"crosshair"}),zog("place "+t+" - to get new position"),e.on("click",function(){zog(t+".x = "+Math.round(e.x)+"; "+t+".y = "+Math.round(e.y)+";"),zog(t+".pos("+Math.round(e.x)+", "+Math.round(e.y)+");")}),e},Je.placeReg=function(t,o){if(z_d("49.5"),!zot(t)){var e=t.stage;if(zot(e))zog("zim.placeReg() - add object to stage before calling placeReg()");else{zot(o)&&(o="obj");var n=t.parent.localToGlobal(t.x,t.y),i=new Je.Shape(-25,-25,50,50).addTo(e).pos(n.x,n.y);i.graphics.s("white").mt(-25,0).lt(25,0).mt(0,-25).lt(0,20),i.compositeOperation="difference",i.expand(0),Je.drag({obj:i}),zog("place cursor to get new registration point location"),e.on("stagemouseup",function(){var e=t.globalToLocal(i.x,i.y);zog(o+".regX = "+Math.round(e.x)+"; "+o+".regY = "+Math.round(e.y)+";"),zog(o+".reg("+Math.round(e.x)+", "+Math.round(e.y)+");")})}}},Je.expand=function(e,t,o){if(z_d("50"),zot(e)||!e.getBounds||!e.getBounds())return zog("zim methods - expand(): please provide object with bounds set"),e;zot(t)&&(t=20),zot(o)&&(o=t);var n=e.getBounds(),i=new createjs.Shape;return i.graphics.f("0").r(n.x-t,n.y-o,n.width+2*t,n.height+2*o),e.hitArea=i,e},Je.setMask=function(e,t,o){if(z_d("50.1"),zot(e)&&zog("zim methods - setMask(): please provide obj"),zot(t))return n(),e;function n(){e.zimMask&&e.zimMask.parent&&e.zimMask.parent.removeChild(e.zimMask),e.zimMask=null,e.zimMaskTicker&&Ticker.remove(e.zimMaskTicker),e.mask=null}var i;function r(){if(o&&(!e.stage||!t.stage))return e;delete i,e.zimMask=t.zimMask=i=t.shape.clone(),Je.copyMatrix(i,t),i.regX=t.regX,i.regY=t.regY,t.addChildAt(i,0),i.alpha=0,i.x=t.x+t.shape.x,i.y=t.y+t.shape.y,e.mask=i}return e.zimMaskOriginal&&e.zimMaskOriginal!=t&&n(),zot(o)&&(o=!("Blob"!=t.type&&zot(t.zimDown)&&zot(t.transformControls)&&zot(t.zimTouch)&&zot(t.zimTweens)),t.zimMaskDynamic=o),(e.zimMaskOriginal=t).zimMaskApply=function(){e.zimMaskTicker&&Ticker.remove(e.zimMaskTicker),e.zimMaskTicker=Ticker.add(r)},t&&t.shape?(r(),o&&t.zimMaskApply()):(i=t,e.mask=i),e},Je.ANIMATE=!0,Je.OPTIMIZE=!1,Je.ACTIONEVENT="mousedown",Je.DEFAULTFONT=null,Je.getDefaultFont=function(){z_d("50.32");var e=Je.DEFAULTFONT;return DEFAULTFONT&&(e=DEFAULTFONT),"string"==typeof e&&(e={font:e}),zot(e)&&(e={}),e},Je.KEYFOCUS=null,Je.Ticker={stages:null,myUpdate:null,alwaysList:new Je.Dictionary,list:new Je.Dictionary,setFPS:function(e,t){zot(e)&&zot(t)?(e=30,t=60):zot(e)?e=30:zot(t)&&(t=e),Je.Ticker.framerate=createjs.Ticker.framerate=Je.mobile()?e:t},setTimingMode:function(e){createjs.Ticker.timingMode=createjs.Ticker.RAF,"synched"==e&&(createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED),"timeout"==e&&(createjs.Ticker.timingMode=createjs.Ticker.TIMEOUT)},add:function(e,t){z_d("30");var o=Je.Ticker;return o.has(e,t)?e:(o.framerate||o.setFPS(),!zot(t)&&t.update||(t=zimDefaultFrame.stage),zot(e)||"function"!=typeof e?void zog("zim.Ticker.add() - only add functions"):(o.ticker||(o.ticker=createjs.Ticker.on("tick",o.call)),o.list.at(t)?o.list.at(t).push(e):o.list.add(t,[e]),e))},rawID:{},raw:function(t){z_d("30");var o=Je.makeID(7,"letters");return function e(){t(),Je.Ticker.rawID[o]=requestAnimationFrame(e)}(),o},removeRaw:function(e){cancelAnimationFrame(Je.Ticker.rawID[e]),delete Je.Ticker.rawID[e]},call:function(e){for(var t,o,n=Je.Ticker,i=0;i<n.list.length;i++){t=n.list.objects[i],o=n.list.values[i];for(var r=0;r<o.length;r++)o[r]();n.alwaysList.at(t)?t.update():0<o.length&&(!zot(n.update)||Je.OPTIMIZE||!zns&&OPTIMIZE?n.update&&t.update():t.update())}for(i=0;i<n.alwaysList.length;i++)t=n.alwaysList.objects[i],null==n.list[t]&&t.update()},always:function(e){z_d("30");var t=Je.Ticker;t.framerate||t.setFPS(),!zot(e)&&e.update||(e=zimDefaultFrame.stage),t.alwaysList.add(e,!0),t.ticker||(t.ticker=createjs.Ticker.on("tick",t.call))},alwaysOff:function(e){var t=Je.Ticker;!zot(e)&&e.update||(e=zimDefaultFrame.stage),t.alwaysList.remove(e)},remove:function(e){var t=Je.Ticker;if(zot(e)||"function"!=typeof e)zog("zim.Ticker - only remove functions");else{for(var o=0,n=0;n<t.list.length;n++){t.list.objects[n];var i=t.list.values[n].indexOf(e);-1<i&&t.list.values[n].splice(i,1),o+=t.list.values[n].length}0<t.alwaysList.length||0==o&&(createjs.Ticker.off("tick",t.ticker),t.ticker=null)}},removeAll:function(e){for(var t,o=Je.Ticker,n=0,i=0;i<o.list.length;i++)t=o.list.objects[i],(zot(e)||e===t)&&(o.list.values[i]=[]),n+=o.list.values[i].length;0<o.alwaysList.length||0==n&&(createjs.Ticker.off("tick",o.ticker),o.ticker=null)},has:function(e,t){return!zot(t)&&t.update||(t=zimDefaultFrame.stage),Je.Ticker.list&&Je.Ticker.list.at(t)&&0<=Je.Ticker.list.at(t).indexOf(e)},dispose:function(e){for(var t,o=Je.Ticker,n=0,i=o.list.length-1;0<=i;i--)t=o.list.objects[i],zot(e)||e===t?(o.list.remove(e),o.alwaysList.remove(e)):n+=o.list.values[i].length;if(!(0<o.alwaysList.length))return 0==n&&(createjs.Ticker.off("tick",o.ticker),o.ticker=null),!0}},Object.defineProperty(Je.Ticker,"update",{get:function(){return Je.Ticker.myUpdate},set:function(e){var t=Je.Ticker;"boolean"!=typeof e&&(e=null),t.myUpdate=e,!1===t.myUpdate&&(cancelAnimationFrame(t.ticker),t.alwaysList=new Je.Dictionary)}}),Je.Accessibility=function(u,e,o,t,n,f,i,r,a,s,l,c,d,h){var g;if(g=zob(Je.Accessibility,arguments,"appName, tabOrder, tabIndex, cycle, decimals, frame, alwaysHighlight, AHTime, AHColor, AHBorderWidth, AHBorderPadding, AHAlpha, AHObject, AHObjectScale",this))return g;if(z_d("30.5"),this.cjsEventDispatcher_constructor(),zot(u)&&(u="application"),zot(t)&&(t=!1),zot(n)&&(n=2),zot(f)&&(f=zimDefaultFrame),zot(i)&&(i=!1),zot(r)&&(r=700),zot(a)&&(a="brown"),zot(s)&&(s=3),zot(l)&&(l=5),zot(c)&&(c=.8),zot(h)&&(h=.8),zot(d)){var p=new Je.Shape;p.mouseEnabled=!1}else d.mouseEnabled&&(d.mouseEnabled=!1);var m=this;m.cycle=t,m.decimals=n,m.alwaysHighlight=i,m.AHTime=r,m.AHColor=a,m.AHBorderWidth=s,m.AHBorderPadding=l,m.AHAlpha=c,m.AHObjectScale=h;var z,v,b,y,w,x,C,T,k=-1,A=-1,E=[],M=[],I={RadioButtons:"option",Tabs:"tab",Pad:"key"},S=f.canvas.id,j=Je.mobile(),B=!1,O=null,P=[];function D(e){var t=e.currentTarget.boundsToGlobal(),o=t.x+t.width/2,n=t.y+t.height/2;e.stageX<o-5||e.stageX>o+5||e.stageY<n-5||e.stageY>n+5?X():Y()}function L(){y&&(y.innerHTML="")}function Y(){var e,t;O=!0,W(),y&&y.setAttribute("aria-hidden",!1),Je.ACTIONEVENT="click",zns||(ACTIONEVENT="click"),f.stage.removeChild(z),m.alwaysHighlight=!1,f.stage.update();for(var o=0;o<k.length;o++)(t=(e=k[o]).obj.zimTabTag).disabled=!1,e.title=e.title.replace(/\s\(use arrow keys\)/,""),t.setAttribute("aria-label",e.title),t.addEventListener("focus",_)}function X(){O=!1;for(var e=0;e<k.length;e++)k[e].obj.zimTabTag.disabled=!1;W(),i&&function(){for(var e=0;e<E.length;e++){var t=E[e];(!t.zimObject||"Loader"!=t.zimObject.type&&"TextArea"!=t.zimObject.type)&&(E[e].style.left="-2000px")}}()}function _(e){var t=e.currentTarget,o=t.zimObject;A=o.zimTabIndex,o.focus=!0;var n=new createjs.Event("change");n.title=t.getAttribute("aria-label"),m.dispatchEvent(n)}function R(e){O=!1,e.target.focusTab.focus()}function F(){zot(O)||O?Y():X()}function W(){B=!0,v.removeEventListener("focus",F),b.removeEventListener("focus",F),w.removeEventListener("focus",R),x.removeEventListener("focus",R),w.parentNode.removeChild(w),x.parentNode.removeChild(x),C.removeEventListener("focus",R),T.removeEventListener("focus",R),C.parentNode.removeChild(C),T.parentNode.removeChild(T);for(var e=0;e<P.length;e++)P[e][0].off("mousedown",P[e][1])}function N(e){var t=e.currentTarget;if("RadioButton"==t.type||"TabsButton"==t.type||"PadButton"==t.type)for(var o=0;o<t.zimTabParent.buttons.length;o++){var n=t.zimTabParent.buttons[o];n.zimTabTag.setAttribute("aria-label",n.zimTabTag.getAttribute("aria-label").split(" - currently")[0]+(t.zimTabParent.selectedIndex==n.tabIndex?" - currently selected.":" - currently not selected."))}m.tabIndex=e.currentTarget.zimTabIndex,m.activatedObject=t}function G(e){return"TextArea"==e.type||"RadioButtons"==e.type||"Tabs"==e.type||"Pad"==e.type?e.type:"Waiter"==e.type?"Waiter active - please wait":e.text?e.type+" - "+("a"==e.text||"A"==e.text?"eh":e.text):e.type+("Dial"==e.type||"Slider"==e.type||"ColorPicker"==e.type||"Stepper"==e.type?" (use arrow keys)":"")+("TextArea"==e.type?" (press ENTER to edit)":"")}function V(e){var t=e.obj;e.title=e.title.replace(/\.$/,""),"RadioButton"==t.type||"TabsButton"==t.type||"PadButton"==t.type?e.title=e.title+(t.tabIndex==t.zimTabParent.selectedIndex?" - currently selected":" - currently not selected"):"CheckBox"==t.type?e.title=e.title+(t.checked?" - currently checked":" - currently not checked"):"Stepper"==t.type?e.title=e.title+" - currently displaying "+t.currentValue:"Slider"==t.type||"Dial"==t.type?e.title=e.title+" - currently at "+Je.decimals(t.currentValue,m.decimals):"ColorPicker"==t.type?e.title=e.title+" - currently at "+t.selectedColor:"TextArea"==t.type?e.title=e.title+(""!=t.tag.value?"":" - placeholder: "+t.tag.placeholder):"Indicator"==t.type&&(e.title=e.title+" - currently "+(0<=t.selectedIndex?"at "+(t.selectedIndex+1)+" of "+t.num:"not indicating")),e.title+="."}function H(e,t,o,n,i){var r;if(n&&(u=n.obj),n&&("TextArea"==u.type||"Loader"==u.type))return(r=u.tag).setAttribute("aria-label",t),u&&r.setAttribute("aria-hidden",!u.stage),"before"==i?o.parentNode.insertBefore(r,o):o.parentNode.insertBefore(r,o.nextSibling),r.style.zIndex=-5,r.zimObject=u,n.obj.zimTabTag=r,E.push(r),r;if(!n||"Dial"!=u.type&&"Slider"!=u.type&&"Stepper"!=u.type&&"ColorPicker"!=u.type)r=document.createElement("div"),u&&(r.zimObject=u),r.innerHTML="tag",r.setAttribute("role","button");else{var a,s,l=[];if("Dial"==u.type||"Slider"==u.type)for(var c=u.step<=0?(u.max-u.min)/20:u.step,d=u.min;d<u.max;d+=c)l.push(u.min+d);else"Stepper"==u.type?l=u.stepperArray:"ColorPicker"==u.type&&(l=u.colors);(r=document.createElement("select")).disabled=!0,r.zimObject=u,r.addEventListener("change",function(e){O&&(e.currentTarget.zimObject.zimTabParent.currentValueEvent=e.target.value,f.stage.update())}),r.size=1;for(d=0;d<l.length;d++)a=l[d],(s=document.createElement("option")).setAttribute("aria-label",a),s.innerHTML=a,r.add(s),a==u.zimTabParent.currentValue&&s.setAttribute("selected","selected");r.setAttribute("role","button")}if(r.setAttribute("id",e),r.setAttribute("tabindex",0),r.setAttribute("aria-label",t),u&&r.setAttribute("aria-hidden",!u.stage),"before"==i?o.parentNode.insertBefore(r,o):o.parentNode.insertBefore(r,o.nextSibling),r.style.position="absolute",n){var u,h=(u=n.obj).boundsToGlobal();r.style.left=f.x+h.x*f.scale+"px",r.style.top=f.y+h.y*f.scale+"px",r.style.width=h.width*f.scale+"px",r.style.height=h.height*f.scale+"px",n.obj.zimTabTag=r}else r.style.left="-1000px",r.style.top=f.y+"px";return r.style.overflow="hidden",r.style.zIndex=-5,r.style.fontSize="20px",E.push(r),r}Object.defineProperty(this,"tabOrder",{get:function(){return k},set:function(e){v&&v.removeEventListener("focus",L),b&&b.removeEventListener("focus",L);for(var t=0;t<E.length;t++)E[t].parentElement&&(E[t].outerHTML="");var o,n;for(E=[],t=0;t<M.length;t++)(o=k[t])&&M[t][0].off("mousedown",M[t][1]);M=[],k=[];var i=[],r=f.canvas,a=0;for(t=0;t<e.length;t++){if((o=e[t]).constructor=={}.constructor){if(!(n=o.obj)||!n.getStage)continue;o.title||(o.title=G(n))}else o={obj:n=o,title:G(o)};if("RadioButtons"==n.type||"Tabs"==n.type||"Pad"==n.type){var s=[];a--;for(var l=0;l<n.buttons.length;l++){a++;var c=n.buttons[l],d={obj:c,title:o.title+" - "+I[n.type]+": "+("a"==c.text||"A"==c.text?"eh":c.text)};s.push(d),c.zimTabParent=n,c.zimTabParent.zimAccessibility=m,c.zimTabIndex=t+a,c.tabIndex=l,c.zimAccessibility=m,V(d),r=H(S+"Tab"+(t+a),d.title,r,d),M.push([c,c.on("mousedown",N)]),B||P.push([c,c.on("mousedown",D)])}i=i.concat(s)}else n.zimTabIndex=t+a,n.zimTabParent=n,V(o),n.zimAccessibility=m,M.push([n,n.on("mousedown",N)]),B||P.push([n,n.on("mousedown",D)]),i.push(o),r=H(S+"Tab"+(t+a),o.title,r,o)}(v=m.startAppTag=H(S+"PrefixTab",u+" start",f.canvas,null,"before")).addEventListener("focus",L),B||(v.addEventListener("focus",F),(w=H(S+"noAriaTab","",v,null,"before")).setAttribute("aria-hidden",!0),w.focusTab=v,w.addEventListener("focus",R),(C=H(S+"noAriaTab","",v)).setAttribute("aria-hidden",!0),C.focusTab=v,C.addEventListener("focus",R)),r=H(S+"BufferTab","",r),j&&r.setAttribute("aria-hidden",!0),r=b=m.endAppTag=H(S+"SuffixTab",u+" end",r),b.addEventListener("focus",L),B||(b.addEventListener("focus",F),r=x=H(S+"noAriaTab","",b),x.setAttribute("aria-hidden",!0),x.focusTab=b,x.addEventListener("focus",R),(T=H(S+"noAriaTab","",b,null,"before")).setAttribute("aria-hidden",!0),T.focusTab=b,T.addEventListener("focus",R)),k=i}}),Object.defineProperty(this,"tabIndex",{get:function(){return A},set:function(e){if(_state)if(e<0||e>=k.length)d();else{e!=A&&c();var t=k[e].obj;if(t.stage){if(A=e,t.focus=!0,K=!(Z=!0),m.changeTitle(t),t.zimTabTag.focus(),setTimeout(function(){t.zimTabTag.focus();var e=new createjs.Event("change");e.title=t.zimTabTag.getAttribute("aria-label"),m.dispatchEvent(e)},150),m.alwaysHighlight&&!O){if(m.AHObject){z=m.AHObject;var o=Je.boundsToGlobal(t);m.AHObject.alp(m.AHAlpha).addTo(f.stage,null,!1),m.AHObject.fit(o.x,o.y,o.width,o.height),m.AHObject.sca(m.AHObject.scaleX*m.AHObjectScale),0<m.AHTime&&(U=setTimeout(function(){f.stage.removeChild(m.AHObject),f.stage.update()},m.AHTime))}else{z=p;var n=t.getBounds(),i=t.localToGlobal(n.x-5,n.y-5),r=t.localToGlobal(n.x+n.width+5,n.y-5),a=t.localToGlobal(n.x+n.width+5,n.y+n.height+5),s=t.localToGlobal(n.x-5,n.y+n.height+5),l=p.graphics;l.clear(),l.s(m.AHColor).ss(m.AHBorderWidth).mt(i.x,i.y).lt(r.x,r.y).lt(a.x,a.y).lt(s.x,s.y).lt(i.x,i.y).cp(),p.alpha=m.AHAlpha,0<m.AHTime&&(U=setTimeout(function(){f.stage.removeChild(p),f.stage.update()},m.AHTime))}f.stage.addChild(z),f.stage.update()}}else d()}function c(){if(A&&-1<A)k[A].obj.focus=!1;else for(var e=0;e<k.length;e++)k[e].obj.focus=!1}function d(){c(),Z=!1,m.AHObject&&f.stage.removeChild(m.AHObject),m.alwaysHighlightShape&&f.stage.removeChild(m.alwaysHighlightShape),f.stage.update(),A=-1}}}),Object.defineProperty(this,"aria",{get:function(){return O},set:function(e){(O=e)&&Y()}}),zot(e)?setTimeout(function(){if(-1==k){k=[];var t=[];Je.loop(f.stage,function(e){e.type&&t.push(e)}),m.tabOrder=t,zot(o)||(m.tabIndex=o)}},50):(k=[],m.tabOrder=e,zot(o)||(m.tabIndex=o));var U,Z=!1,K=!0,q=f.on("keydown",function(e){var t;if(9==e.keyCode&&(function(){for(var e=!1,t=0;t<E.length;t++)if(document.activeElement==E[t]){e=!0;break}return!(document.activeElement!=f.canvas&&!e)}()||(Z=!1,-1!=m.tabIndex&&(m.tabIndex=-1)),Z?Q(e):(t=e,f.shiftKey||zid(S+"PrefixTab")!=document.activeElement&&f.canvas!=document.activeElement?!f.shiftKey||zid(S+"SuffixTab")!=document.activeElement&&zid(S+"BufferTab")!=document.activeElement||(0<k.length&&(k[0].obj.focus=!0),Z=K=!0,Q(t)):(0<k.length&&(k[k.length-1].obj.focus=!0),Z=K=!0,Q(t)))),Z&&0<k.length&&0<=m.tabIndex&&13==e.keyCode){var o=k[m.tabIndex],n=o.obj;if(o&&n.stage){var i=new createjs.Event("mousedown"),r=new createjs.Event("click");i.fromEnter=r.fromEnter=!0,"Pane"==n.type?(n.backdrop.dispatchEvent(i),n.backdrop.dispatchEvent(r)):(n.dispatchEvent(i),n.dispatchEvent(r))}}});function Q(e){e.ctrlKey?J(e.shiftKey?-1:1):(e.shiftKey?m.tab(-1):m.tab(1),e.preventDefault())}function J(e){Z=!1,zid(S+(1==e?"SuffixTab":"PrefixTab")).focus(),f.stage.removeChild(d),f.stage.update(),m.tabIndex=-1}this.tab=function(e){if(clearTimeout(U),z&&f.stage.removeChild(z),zot(e)&&(e=1),0!=k.length)for(var t=0;t<k.length;t++){var o=k[t].obj;if(o.focus){o.focus=!1;var n=t+e,i=(n+1e4*k.length)%k.length,r=k[i];o=r.obj;for(var a=0,s=!1;!o.stage||!(!o.zimTabParent&&(zot(o.enabled)||o.enabled)||o.zimTabParent&&(zot(o.zimTabParent.enabled)||o.zimTabParent.enabled));)if(a++,i=((n+=e)+100*k.length)%k.length,o=(r=k[i]).obj,a==k.length){s=!0;break}if(s||!m.cycle&&n!=i&&!K)return void J(e);K=!1,m.tabIndex=i;break}}else J(e)};var $=!(this.changeTitle=function(e,t,o){if("number"!=typeof e&&(e=e.zimTabIndex),!zot(e))if(o&&zot(t))m.tabIndex=e;else{var n=k[e],i=n.obj;zot(t)&&(t=i.zimTabTag.getAttribute("aria-label").split(" - currently")[0]),n.title=t,V(n),i.zimTabTag.setAttribute("aria-label",n.title),o&&(m.tabIndex=e)}});this.talk=function(e){$||((y=H(S+"TalkTab","",b)).setAttribute("role","alert"),y.setAttribute("aria-hidden",!O),$=!0),y.setAttribute("aria-label",e),y.innerHTML=" ",y.innerHTML=e;var t=new createjs.Event("change");t.title=e,m.dispatchEvent(t)},this.resize=function(e){if(zot(e)){if(m.alwaysHighlight&&!zot(O))return;for(var t=0;t<k.length;t++)n(k[t].obj)}else{if("number"!=typeof e&&(e=e.zimTabIndex),e<0)return;var o=k[e].obj;if(!o.stage&&z&&o==m.currentObject&&(f.stage.removeChild(z),f.stage.update()),m.alwaysHighlight&&!zot(O))return;n(o)}function n(e){if("TextArea"!=e.type&&"Loader"!=e.type){var t=e.boundsToGlobal(),o=e.zimTabTag;o.style.left=f.x+t.x*f.scale+"px",o.style.top=f.y+t.y*f.scale+"px",o.style.width=t.width*f.scale+"px",o.style.height=t.height*f.scale+"px",o.setAttribute("aria-hidden",!e.stage),o.hidden=!e.stage}else e.resize()}},Object.defineProperty(this,"currentObject",{get:function(){return k[A]&&k[A].obj?k[A].obj:null},set:function(e){for(var t=0;t<k.length;t++)if(k[t].obj==e){m.tabIndex=t;break}}}),_state=!0,Object.defineProperty(this,"enabled",{get:function(){return _state},set:function(e){_state=e}}),this.dispose=function(){m.tabOrder=[];for(var e=0;e<E.length;e++)E[e].parentElement&&(E[e].outerHTML="");m.removeAllEventListeners(),f.off("keydown",q)}},Je.extend(Je.Accessibility,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.Swipe=function(o,e,t){var n;if(n=zob(Je.Swipe,arguments,"obj, distance, duration",this))return n;if(z_d("70"),this.cjsEventDispatcher_constructor(),!zot(o)&&o.on){var i,r,a,s,l,c;zot(e)&&(e=30),zot(t)&&(t=80),this.distance=e,this.duration=t,this.active=!0;var d=this;o.on("mousedown",function(e){function t(){var e=new createjs.Event("swipe");e.obj=d.obj,e.swipeX=e.swipeY=0,d.direction="none",Math.abs(a-i)>Math.abs(s-r)?(a-i>d.distance&&(e.swipeX=1,d.direction="right"),i-a>d.distance&&(e.swipeX=-1,d.direction="left")):(s-r>d.distance&&(e.swipeY=1,d.direction="down"),r-s>d.distance&&(e.swipeY=-1,d.direction="up")),d.dispatchEvent(e)}d.active&&!e.target.zimNoSwipe&&(d.obj=e.target,a=i=e.stageX,s=r=e.stageY,l=!0,d.dispatchEvent("swipedown"),clearTimeout(c),c=setTimeout(function(){l&&(t(),l=!1)},d.duration),o.on("pressmove",function(e){a=e.stageX,s=e.stageY}),o.on("pressup",function(e){l&&(t(),l=!1,clearTimeout(c))}))}),this.disable=function(){d.active=!1},this.enable=function(){d.active=!0}}else zog("zim controls - Swipe():\nPlease pass in object")},Je.extend(Je.Swipe,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.Pages=function(o,g,p,e,m){var t;if(t=zob(Je.Pages,arguments,"pages, transition, speed, transitionTable, holder",this))return t;if(z_d("71"),this.zimContainer_constructor(),this.type="Pages",zot(o)&&(o=[]),this.pages=o,zot(g)&&(g="none"),zot(p)&&(p=200),zot(e)&&(e=[]),this.transitionTable=e,zot(m)&&zimDefaultFrame&&(m=zimDefaultFrame.stage),m.getBounds&&m.getBounds()){this.speed=p,this.active=!0;var z=this;z.transitioning=!1;var v,b,y=m.getBounds().width,w=m.getBounds().height;"none"==g&&e==[]||l();for(var n,i,x=["left","right","up","down"],r=0;r<o.length;r++)(n=o[r]).constructor!=={}.constructor&&(n=o[r]={page:o[r]}),n.page.zimSwipeArray=n.swipe?n.swipe:[],n.page.zimOriginalAlpha=n.page.alpha,n.page.parent&&n.page.parent.removeChild(n.page);var a,C=this.page=o[0]?o[0].page:null;this.addChild(C),this.swipe=new Je.Swipe(m);var T=!1,s=this.swipe.on("swipe",function(e){if(z.active){var t=e.currentTarget.direction;if("none"!=t){var o="";"left"==t?o="right":"right"==t?o="left":"up"==t?o="down":"down"==t&&(o="up"),t=o;var n=x.indexOf(t);i=C.zimSwipeArray[n],a=[i,t,null,null,!0],z.page=C,z.nextPage=i,z.direction=t,z.dispatchEvent("swipe"),setTimeout(function(){T||z.go(i,t,null,null,!0)},50)}}});this.addPage=function(e,t){zot(t)&&(t=[]);var o={page:e,swipe:t};o.page.zimSwipeArray=o.swipe?o.swipe:[],o.page.zimOriginalAlpha=o.page.alpha,C?o.page.parent&&o.page.parent.removeChild(o.page):(C=z.page=o.page,z.addChild(C))},this.removePage=function(e){z.currentPage==e&&(z.removeChild(e),m.stage&&m.stage.update()),e.zimSwipeArray=null},this.setSwipeArray=function(e,t){zot(t)&&(t=[]);var o={page:e,swipe:t};o.page.zimSwipeArray=o.swipe?o.swipe:[]},this.pause=function(){T=!0},this.unpause=function(){T&&z.go(a[0],a[1],a[2],a[3],a[4])};var k=!0;this.go=function(e,t,o,n,i){if("number"==typeof e){var r=z.pages[e];if(zot(r))return;e=r.page}setTimeout(function(){T=!1},200);for(var a=[{x:y},{x:-y},{y:w},{y:-w}],s=[{x:y/2,alpha:0},{x:-y/2,alpha:0},{y:w/2,alpha:0},{y:-w/2,alpha:0}],l=g,c=p,d=0;d<z.transitionTable.length;d++)if(z.transitionTable[d][0]==C&&z.transitionTable[d][1]==e){l=z.transitionTable[d][2],c=z.transitionTable[d][3];break}if(zot(o)&&(o=l),zot(n)&&(n=c),z.speed=n,z.direction=t,""==e||null==e)z.page=C,z.dispatchEvent("nothing");else if("string"==typeof e)z.page=C,z.dispatchEvent(e);else{if(e==C)return;zot(t)&&(t="right");var u=x.indexOf(t);if(!k)return;function h(e){e[0].uncache(),e[1].uncache(),z.transitioning=!1,z.dispatchEvent("pagetransitioned"),z.removeChild(z.lastPage),z.removeChild(v),z.removeChild(b),k=!0}function f(e){z.removeChild(z.lastPage),Je.animate(e.shift(),{alpha:0},z.speed/2,null,h,e)}k=!1,e.x=0,e.y=0,e.alpha=e.zimOriginalAlpha,z.transitioning=!0,"slide"==o?(e.x=-(0|a[u].x),e.y=-(0|a[u].y),e.cache(0,0,(y+1)/e.scaleX,(w+1)/e.scaleY),C.cache(0,0,(y+1)/C.scaleX,(w+1)/C.scaleY),z.addChild(e),z.addChild(C),Je.animate(C,a[u],z.speed,null,h,[C,e]),Je.animate(e,[{x:0},{x:0},{y:0},{y:0}][u],z.speed)):"reveal"==o?(e.cache(0,0,(y+1)/e.scaleX,(w+1)/e.scaleY),C.cache(0,0,(y+1)/C.scaleX,(w+1)/C.scaleY),z.addChild(e),z.addChild(C),Je.animate(C,s[u],z.speed,null,h,[C,e])):"fade"==o?(e.cache(0,0,(y+1)/e.scaleX,(w+1)/e.scaleY),C.cache(0,0,(y+1)/C.scaleX,(w+1)/C.scaleY),e.alpha=1,z.addChild(e),z.addChild(C),Je.animate(C,{alpha:0},z.speed,null,h,[C,e])):"black"==o?(e.cache(0,0,(y+1)/e.scaleX,(w+1)/e.scaleY),C.cache(0,0,(y+1)/C.scaleX,(w+1)/C.scaleY),e.alpha=1,z.addChild(e),z.addChild(C),v.alpha=0,z.addChild(v),Je.animate(v,{alpha:1},z.speed/2,null,f,[v,C,e])):"clear"==o?(e.cache(0,0,(y+1)/e.scaleX,(w+1)/e.scaleY),C.cache(0,0,(y+1)/C.scaleX,(w+1)/C.scaleY),e.alpha=0,z.addChild(e),z.addChild(C),Je.animate(C,{alpha:0},z.speed/2),Je.animate(e,{alpha:1},z.speed/2,null,h,[C,e],z.speed/2)):"white"==o?(e.cache(0,0,(y+1)/e.scaleX,(w+1)/e.scaleY),C.cache(0,0,(y+1)/C.scaleX,(w+1)/C.scaleY),e.alpha=1,z.addChild(e),z.addChild(C),b.alpha=0,z.addChild(b),Je.animate(b,{alpha:1},z.speed/2,null,f,[b,C,e])):(z.transitioning=!1,z.addChild(e),z.removeChild(C),k=!0),z.lastPage=C,z.page=e,zot(i)&&(i=!1),z.fromSwipe=i,z.dispatchEvent("page"),C=e,m.stage&&m.stage.update()}},this.resize=function(){y=m.getBounds().width,w=m.getBounds().height,"none"==g&&e==[]||l()},this.puff=function(e){for(var t=0;t<o.length;t++)z.addChild(o[t].page);z.addChild(C),0<e&&setTimeout(function(){z.settle()},e)},this.settle=function(){z.removeAllChildren(),z.addChild(C),z.dispatchEvent("puffed")},this.disable=function(){z.active=!1},this.enable=function(){z.active=!0},this.dispose=function(){return z.swipe.off("swipe",s),this.zimContainer_dispose(),!0}}else zog("zim controls - Pages():\nholder object must have bounds set");function l(){(v=new createjs.Shape).graphics.f("black").r(0,0,y,w+1),(b=new createjs.Shape).graphics.f("white").r(0,0,y,w+1)}},Je.extend(Je.Pages,Je.Container,["clone","dispose"],"zimContainer",!1),Je.HotSpots=function(n,o,i){var e;if(e=zob(Je.HotSpots,arguments,"spots, local, mouseDowns",this))return e;if(z_d("72"),this.zimContainer_constructor(),this.type="HotSpots",!zot(n)&&Array.isArray(n)){zot(o)&&(o=!0),zot(i)&&(i=!1);for(var r,a,s=(zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",l=[],t=0;t<n.length;t++)c(n[t]);this.addHotSpot=function(e,t,o){r={page:e,rect:t,call:o},n.push(r),c(r)},this.show=function(){for(var e=0;e<l.length;e++)(a=l[e]).button||a.show()},this.hide=function(){for(var e=0;e<l.length;e++)(a=l[e]).hide()},this.removeHotSpots=function(e,t){for(var o=n.length-1;0<=o;o--)r=n[o],a=l[o],t&&!Array.isArray(t)&&(t=[t.x,t.y,t.getBounds().width,t.getBounds().height]),(zot(e)&&zot(t)||zot(t)&&e==r.page||zot(e)&&Je.arraysEqual(t,r.rect)||e==r.page&&Je.arraysEqual(t,r.rect))&&(n.splice(o,1),a.button&&(a.button.off(s,a.button.zimHSEvent),a.button.zimHSEvent=null,i||(a.button.off("mousedown",a.button.zimHSMDEvent),a.button.zimHSMDEvent=null)),a.off(s,d),a.dispose(),l.splice(o,1))},this.dispose=function(){for(var e=0;e<l.length;e++)(a=l[e]).button&&(a.button.off(s,a.button.zimHSEvent),a.button.zimHSCall=null,a.button.zimHSEvent=null,i||(a.button.off("mousedown",a.button.zimHSMDEvent),a.button.zimHSMDEvent=null)),a.off(s,d),a.dispose();return!0}}else zog("zim controls - HotSpots():\nplease provide an array of HotSpot data");function c(e){var t=null;if(!Array.isArray(e.rect)){if(!(t=e.rect))return void zog("zim controls - HotSpots(): HotSpot "+e.page+" "+e.rect+" button does not exist");e.rect=[t.x,t.y,1,1]}(a=new Je.HotSpot(e.page,e.rect[0],e.rect[1],e.rect[2],e.rect[3],e.call,o)).zimHSpage=e.page,a.button=t,l.push(a),a.on(s,d),t&&(a.spot.mouseEnabled=!1,a.spot.mouseChildren=!1,t.zimHScall=e.call,t.zimHSEvent=t.on(s,d,!0),i||(t.zimHSMDEvent=t.on("mousedown",function(e){e.stopImmediatePropagation()})),t.cursor="pointer")}function d(e){e.stopImmediatePropagation&&e.stopImmediatePropagation(),window.event&&(window.event.cancelBubble=!0),"function"==typeof e.currentTarget.zimHScall&&e.currentTarget.zimHScall(e)}},Je.extend(Je.HotSpots,Je.Container,"clone","zimContainer",!1),Je.HotSpot=function(e,t,o,n,i,r,a){var s;if(s=zob(Je.HotSpot,arguments,"obj, x, y, width, height, call, local",this))return s;if(z_d("73"),this.zimContainer_constructor(),this.type="HotSpot",!zot(e)&&e.addChild)if(e instanceof createjs.Container!=0)if(zot(t)||zot(o)||zot(n)||zot(i))zog("zim controls - HotSpot():\nPlease pass in x, y, width, height");else{zot(a)&&(a=!0),eventType=(zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click";var l=n,c=i,d=new createjs.Shape,u=new createjs.Shape;if(a)d.graphics.f("#999999").dr(t,o,l,c),u.graphics.f("#999999").dr(t,o,1,1);else{var h=e.globalToLocal(t,o),f=e.globalToLocal(t+l,o+c),g=f.x-h.x,p=f.y-h.y;d.graphics.f("#999999").dr(h.x,h.y,g,p),u.graphics.f("#999999").dr(h.x,h.y,1,1)}d.alpha=.4,d.mouseEnabled=!1,u.alpha=.01,u.cursor="pointer";var m=(this.spot=u).on(eventType,function(e){"function"==typeof r&&r()});e.addChild(u),u.hitArea=d,this.show=function(){e.addChild(d)},this.hide=function(){e.removeChild(d)},this.dispose=function(){return u.off(eventType,m),e.removeChild(u),delete u,!0}}else zog("zim controls - HotSpot():\nObjects passed in should be Containers");else zog("zim controls - HotSpot():\nPlease pass in container object for obj")},Je.extend(Je.HotSpot,Je.Container,"clone","zimContainer",!1),Je.Manager=function(e){z_d("75");var i=this;this.items=[],this.add=function(e){Array.isArray(e)?i.items=i.items.concat(e):i.items.push(e)},this.remove=function(e){if(zot(e))i.items=[];else{var t;Array.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++){t=e[o];var n=i.items.indexOf(t);-1!=n&&i.items.splice(n,1)}}},this.resize=function(){if(i)for(var e=0;e<i.items.length;e++)i.items[e].resize?i.items[e].resize():i.items.splice(e)},this.toggle=function(e){if(i)for(var t=0;t<i.items.length;t++)i.items[t].toggle?i.items[t].toggle(e):i.items.splice(t)},this.dispose=function(){for(var e=i.items.length-1;0<=e;e--)i.items[e].dispose();return i.items=[],!(i=null)}},Je.ResizeManager=function(){z_d("75.5"),Je.Manager.call(this,"ResizeManager")},Je.ResizeManager.prototype=new Je.Manager,Je.ResizeManager.prototype.constructor=Je.ResizeManager,Je.TransformManager=function(e,i){z_d("75.7");var r=this;function a(){localStorage&&r.savePersist()}this.items=[],this.add=function(e){var t,o=[];o=Array.isArray(e)?e:[e];for(var n=!1,i=0;i<o.length;i++)t=o[i],0==r.items.length&&0==i&&(n=!0),"Blob"==t.type||"Squiggle"==t.type?(r.persistID||(n?(n=!1,t.controlsVisible=!0,r.currentObject=t):t.controlsVisible=!1),t.on("change",function(e){var t=new createjs.Event("transformed");t.transformObject=e.target,t.transformType=e.controlType,r.dispatchEvent(t)}),t.on("controlsshow",function(e){var t=new createjs.Event("transformshow");r.currentObject=t.transformObject=e.target,r.dispatchEvent(t)}),t.on("controlshide",function(e){var t=new createjs.Event("transformhide");t.transformObject=e.target,r.currentObject=null,r.dispatchEvent(t)})):(transObj=t.transformControls,r.persistID||(n?(n=!1,transObj.show(),r.currentObject=t):transObj.hide()),t.on("transformed",function(e){var t=new createjs.Event("transformed");t.transformObject=e.target,t.transformType=e.transformType,r.dispatchEvent(t)}),t.on("transformshow",function(e){var t=new createjs.Event("transformshow");r.currentObject=t.transformObject=e.target,r.dispatchEvent(t)}),t.on("transformhide",function(e){var t=new createjs.Event("transformhide");t.transformObject=e.target,r.currentObject=null,r.dispatchEvent(t)}));r.items=r.items.concat(e)},this.remove=function(e){if(zot(e))r.items=[];else{var t;Array.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++){t=e[o],r.currentObject==t&&(r.currentObject=null),t.transformedEvent&&(t.off("transformed",t.transformedEvent),t.transformedEvent=null),"Blob"==t.type||"Squiggle"==t.type?t.controlsVisible=!1:t.transformControls.remove();var n=r.items.indexOf(t);-1!=n&&r.items.splice(n,1)}i&&r.savePersist()}},this.show=function(e){if(!zot(e)){if("Blob"==e.type||"Squiggle"==e.type)e.controlsVisible||(e.controlsVisible=!0);else{var t=e.transformControls;if(!t||t.visible)return;t.show()}r.currentObject=e}},this.hide=function(e){if(!zot(e))if(r.currentObject==e&&(r.currentObject=null),"Blob"==e.type||"Squiggle"==e.type)e.controlsVisible&&(e.controlsVisible=!1);else{var t=e.transformControls;if(!t||t.visible)return;t.hide()}},this.hideAll=function(e){for(var t,o,n=0;n<r.items.length;n++)if((o=r.items[n])&&(o.transformControls||o.update)){if(r.items[n]==e)continue;"Blob"==o.type||"Squiggle"==o.type?o.controlsVisible&&(o.controlsVisible=!1):(t=r.items[n].transformControls).visible&&t.hide()}else r.items.splice(n);r.currentObject=null},this.resize=function(){if(r){for(var e,t=0;t<r.items.length;t++)(e=r.items[t])&&(e.transformControls||e.update)?"Blob"==e.type||"Squiggle"==e.type?e.update():e.transformControls.resize():r.items.splice(t);i&&r.savePersist()}},zot(e)||r.add(e);var s="TransformManager persist(persistID) - sorry, must provide id";this.persist=function(e){if(zot(e)&&zon)zog(s);else{if(r.persistID=e,localStorage&&localStorage[e]){var t=r.persistData=JSON.parse(localStorage[e]);if(t.length==r.items.length)for(var o=0;o<r.items.length;o++)t[o].controlsVisible&&(r.currentObject=r.items[o]),!t[o]||"Blob"!=t[o].type&&"Squiggle"!=t[o].type?t[o]&&r.items[o].transformControls.setData(t[o]):r.items[o].setData(t[o])}var n;for(o=0;o<r.items.length;o++)(n=r.items[o]).transformedEvent||("Blob"==n.type||"Squiggle"==n.type?(n.transformedEvent=n.on("change",a),n.transformedEvent=n.on("controlsshow",a),n.transformedEvent=n.on("controlshide",a)):(n.transformedEvent=n.on("transformed",a),n.transformedEvent=n.on("transformshow",a),n.transformedEvent=n.on("transformhide",a)))}},this.savePersist=function(){for(var e=[],t=0;t<r.items.length;t++)it=r.items[t],"Blob"==it.type||"Squiggle"==it.type?it.recordData&&e.push(it.recordData()):it.transformControls&&it.transformControls.recordData&&e.push(it.transformControls.recordData());r.persistData=e,localStorage[r.persistID]=JSON.stringify(e)},this.clearPersist=function(e){zot(e)&&zon?zog(s):(r.persistData=null,localStorage&&localStorage.removeItem(e))},this.stopPersist=function(){for(var e=0;e<r.items.length;e++)it=r.items[e],it.transformedEvent&&("Blob"==it.type||"Squiggle"==it.type?it.off("change",it.transformedEvent):it.off("transformed",it.transformedEvent),it.transformedEvent=null);r.persistData=null},zot(i)||r.persist(i),this.dispose=function(e,t){if(zot(e)&&(e=!0),r.removeAllEventListeners(),r.persistID&&e&&r.stopPersist(),t)for(var n=0;n<r.items.length;n++)o=r.items[n],"Blob"==o.type||"Squiggle"==o.type?o.dispose():o.transformControls.dispose()}},Je.extend(Je.TransformManager,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.Guide=function(n,i,r,t,o){var e;if(e=zob(Je.Guide,arguments,"obj, vertical, percent, hideKey, pixelKey",this))return e;if(z_d("76"),this.zimContainer_constructor(),this.type="Guide",zot(n)&&(n=zimDefaultFrame?zimDefaultFrame.stage:"stage"),zot(i)&&(i=!0),"stage"==n||n.addChild&&n.getBounds&&n.getBounds()){zot(r)&&(r=!0),zot(t)&&(t="G"),zot(o)&&(o="P");var a,s,l,c,d,u=this,h=80,f=26,g=h/6+h/2,p=2*f;i?((c=C("#00c5af","white","white")).shape.regX=h+h/6,c.shape.regY=f/2,c.label.x=-h/2-h/6):((c=C("#d61fa0","white","white")).shape.regX=h/2,c.shape.regY=f+f/4,c.label.y=3*-f/4),"stage"!=n&&n.addChild(u);var m,z,v,b,y=Je.added(u,function(){"stage"==n?(d=u.stage,n=d):d=n.stage;n.addChild(u),m=n.getBounds().width,z=n.getBounds().height,i?(c.y=z/2,c.label.text="y:"+(u.pixels?Math.round(70*m/100):"70%")):(c.x=m/2,c.label.text="x:"+(u.pixels?Math.round(70*z/100):"70%"));v=new createjs.Shape,u.addChild(v),i?v.x=.7*m:v.y=.7*z,w||(n.addChild(u),k());d.off("stagemousemove",a),a=d.on("stagemousemove",T),d.update()}),w=!1,x={x:0,y:0};Object.defineProperty(this,"pixels",{get:function(){return!r},set:function(e){r=!e,u.resize()}}),window.addEventListener("keydown",A),this.toggled=!0,this.toggle=function(e){return!0===e?u.visible=u.toggled=!0:!1===e?u.visible=u.toggled=!1:(u.visible=!u.visible,u.toggled=u.visible),d.off("stagemousemove",a),u.visible&&(a=d.on("stagemousemove",T,u)),u},this.resize=function(){return!!u&&(d&&(k(),T()),!0)},this.dispose=function(){return!!u&&(Je.noDrag(v),clearInterval(y),u.removeAllChildren(),window.removeEventListener("keydown",A),u.parent&&u.parent.removeChild(u),!(u=null))}}else zog("zim controls - Guide(): Please provide container with bounds for the obj (setBounds())");function C(e,t,o){var n=new Je.Container;return n.shape=new createjs.Shape,n.shape.graphics.s(t).ss(1).f(e).r(0,0,h,f),n.shape.alpha=.9,n.addChild(n.shape),n.label=new createjs.Text("10","16px verdana",o),n.label.textAlign="center",n.label.textBaseline="middle",n.addChild(n.label),n.mouseChildren=!1,n.mouseEnabled=!1,n}function T(e){var t,o;e?(t=n.globalToLocal(e.rawX,e.rawY),x=t):t={x:x.x,y:x.y},r?i?(o=Math.round(Math.abs(t.x-v.x)/m*100),c.label.text="x:"+Math.max(0,Math.min(o,100))+"%",c.y=Math.max(p,Math.min(t.y,l))):(o=Math.round(Math.abs(t.y-v.y)/z*100),c.label.text="y:"+Math.max(0,Math.min(o,100))+"%",c.x=Math.max(g,Math.min(t.x,s))):i?(o=Math.round(Math.abs(t.x-v.x)),c.label.text="x:"+Math.max(0,Math.min(o,Math.round(m))),c.y=Math.max(p,Math.min(t.y,l))):(o=Math.round(Math.abs(t.y-v.y)),c.label.text="y:"+Math.max(0,Math.min(o,Math.round(z))),c.x=Math.max(g,Math.min(t.x,s))),d&&d.update()}function k(){var e;w=!0,m=n.getBounds().width,z=n.getBounds().height,i?(e="ew-resize",b=new createjs.Rectangle(0,0,m,0)):(e="ns-resize",b=new createjs.Rectangle(0,0,0,z)),Je.noDrag(v),setTimeout(function(){Je.drag(v,b,e,e,null,null,!0)},500),d.mouseMoveOutside=!0,d.enableMouseOver(10),s=m-2*h/3,l=z-f-f,v.uncache();var t=v.graphics;i?(t.c().s("rgba(0,255,255,.1)").ss(20).mt(0,0).lt(0,z),t.f().s("white").ss(2).mt(0,0).lt(0,z),t.s("#00c5af").sd([20,20]).mt(0,0).lt(0,z).sd(),v.cache(-10,0,20,z)):(t.c().s("rgba(255,0,255,.1)").ss(20).mt(0,0).lt(m,0),t.f().s("white").ss(2).mt(0,0).lt(m,0),t.s("#d61fa0").sd([20,20]).mt(0,0).lt(m,0).sd(),v.cache(0,-10,m,20)),i?c.x=m:c.y=z,u.addChild(c)}function A(e){e||(e=event),d&&(String.fromCharCode(e.keyCode)==t.toUpperCase()&&u.toggle(),String.fromCharCode(e.keyCode)==o.toUpperCase()&&(u.pixels=!u.pixels))}},Je.extend(Je.Guide,Je.Container,"clone","zimContainer",!1),Je.GuideManager=function(){z_d("77"),Je.Manager.call(this,"GuideManager")},Je.GuideManager.prototype=new Je.Manager,Je.GuideManager.prototype.constructor=Je.GuideManager,Je.Grid=function(i,r,a,t,o){var e;if(e=zob(Je.Grid,arguments,"obj, color, percent, hideKey, pixelKey",this))return e;if(z_d("78"),this.zimContainer_constructor(),this.type="Grid",zot(i)&&(i=zimDefaultFrame?zimDefaultFrame.stage:"stage"),zot(r)&&(r="black"),"stage"==i||i.addChild&&i.getBounds&&i.getBounds()){zot(a)&&(a=!0),zot(t)&&(t="G"),zot(o)&&(o="P");var n,s=this,l=10;this.mouseChildren=!1,this.mouseEnabled=!1;var c=80,d=26,u=T("#dddddd",r,"#333333");u.shape.regX=c/2,u.shape.regY=-d/4,u.label.y=3*d/4;var h=T("#dddddd",r,"#333333");h.shape.regX=-c/6,h.shape.regY=d/2,h.label.x=c/2+c/6;var f,g,p,m=c/6+c/2,z=2*d;u.x=m,h.y=z,u.label.text="x:0",h.label.text="y:0","stage"!=i&&i.addChild(s);var v,b,y,w=Je.added(s,function(){"stage"==i?(p=s.stage,i=p):p=i.stage;x||(A(),i.addChild(s));p.off("stagemousemove",n),n=p.on("stagemousemove",k),p.update()}),x=!1,C={x:0,y:0};Object.defineProperty(this,"pixels",{get:function(){return!a},set:function(e){a=!e,s.resize()}}),window.addEventListener("keydown",E),this.toggled=!0,this.toggle=function(e){return!0===e?s.visible=s.toggled=!0:!1===e?s.visible=s.toggled=!1:(s.visible=!s.visible,s.toggled=s.visible),p.off("stagemousemove",n),s.visible&&(n=p.on("stagemousemove",k,s)),s},this.resize=function(){return!!s&&(s.removeChild(y),y=null,p&&(A(),k(),setTimeout(function(){s.removeChild(y),y=null,A()},200)),!0)},this.dispose=function(){return clearInterval(w),s.removeAllChildren(),window.removeEventListener("keydown",E),s.parent&&s.parent.removeChild(s),!(s=null)}}else zog("zim controls - Grid(): Please provide container with bounds for the obj (setBounds())");function T(e,t,o){var n=new Je.Container;return n.shape=new createjs.Shape,n.shape.graphics.s(t).ss(1).f(e).r(0,0,c,d),n.shape.alpha=.9,n.addChild(n.shape),n.label=new createjs.Text("10","16px verdana",o),n.label.textAlign="center",n.label.textBaseline="middle",n.addChild(n.label),n.mouseChildren=!1,n.mouseEnabled=!1,n}function k(e){var t;e?(t=i.globalToLocal(e.rawX,e.rawY),C=t):t={x:C.x,y:C.y},a?(u.label.text="x:"+Math.max(0,Math.min(Math.round(t.x/v*100),100))+"%",u.x=Math.max(m,Math.min(t.x,f)),h.label.text="y:"+Math.max(0,Math.min(Math.round(t.y/b*100),100))+"%"):(u.label.text="x:"+Math.max(0,Math.min(Math.round(t.x),Math.round(v))),u.x=Math.max(m,Math.min(t.x,f)),h.label.text="y:"+Math.max(0,Math.min(Math.round(t.y),Math.round(b)))),h.y=Math.max(z,Math.min(t.y,g)),p&&p.update()}function A(){x=!0,i&&i.getBounds&&(v=i.getBounds().width,b=i.getBounds().height),p&&(p.mouseMoveOutside=!0,p.enableMouseOver(10)),f=v-2*c/3,g=b-d-d,y=new Je.Container,s.addChild(y);var e=new createjs.Shape;y.addChild(e);var t=e.graphics;t.s(r).ss(1);var o=new createjs.Shape;if(y.addChild(o),a){for(n=1;n<22;n++)t.mt(n*v/20,0).lt(n*v/20,b);for(n=1;n<20;n++)t.mt(0,n*b/20).lt(v,n*b/20);e.alpha=.3,(t=o.graphics).s(r).ss(1);for(n=1;n<10;n++)t.mt(n*v/10,0).lt(n*v/10,b);for(n=1;n<10;n++)t.mt(0,n*b/10).lt(v,n*b/10)}else{for(var n=0;n<v/l;n++)t.mt(n*l,0).lt(n*l,b);for(var n=0;n<b/l;n++)t.mt(0,n*l).lt(v,n*l);e.alpha=.3,(t=o.graphics).s(r).ss(1);for(var n=0;n<v/(10*l);n++)t.mt(n*(10*l),0).lt(n*(10*l),b);for(var n=0;n<b/(10*l);n++)t.mt(0,n*(10*l)).lt(v,n*(10*l))}t.s("#FFFFFF").ss(8),t.mt(v/2,b/2-40).lt(v/2,b/2+40),t.mt(v/2-40,b/2).lt(v/2+40,b/2),t.s("#000000").ss(4),t.mt(v/2,b/2-40).lt(v/2,b/2+40),t.mt(v/2-40,b/2).lt(v/2+40,b/2),t.s(r).ss(3),t.dr(0,0,v,b),o.alpha=.5,y.cache(0,0,v,b),s.addChild(u),s.addChild(h),p&&p.update()}function E(e){e||(e=event),p&&(String.fromCharCode(e.keyCode)==t.toUpperCase()&&s.toggle(),String.fromCharCode(e.keyCode)==o.toUpperCase()&&(s.removeChild(y),y=null,s.pixels=!s.pixels))}},Je.extend(Je.Grid,Je.Container,"clone","zimContainer",!1),Je.GridManager=function(){z_d("79"),Je.Manager.call(this,"GridManager")},Je.GridManager.prototype=new Je.Manager,Je.GridManager.prototype.constructor=Je.GridManager,Je.Layout=function(b,y,w,x,C,T,k,t){var e;if(e=zob(Je.Layout,arguments,"holder, regions, lastMargin, backgroundColor, vertical, regionShape, scalingObject, hideKey",this))return e;if(z_d("80"),this.cjsEventDispatcher_constructor(),!zot(b)&&b.getBounds)if((k=zot(k)?b:k).getBounds&&k.getBounds()){var A=k.getBounds();b.setBounds(0,0,A.width,A.height),zot(w)&&(w=0),zot(C)&&(C=!0),zot(x)&&(x=""),zot(t)&&(t="B");var E,M=new createjs.Shape,I=this;this.active=!0,this.regions=y;var S=0,j="minWidth",B="width",O="height",P="marginLeft",D="maxHeight";C&&(j="minHeight",B="height",O="width",P="marginTop",D="maxWidth","y","x");for(var o=0;o<y.length;o++){if(!(E=y[o]).object||!E.object.getBounds())return void zog("zim controls - Layout(): each region object must have an object with setBounds() set");E[j]||(E[j]=0),E[B]||(E[B]=0),E.backgroundColor||(E.backgroundColor=""),E.given=0,E.maxGiven=0,zot(E[P])&&(E[P]=1e-4),E[D]||(E[D]=100),C?(E.align||(E.align="middle"),E.valign||(0==o?E.valign="top":o==y.length-1?E.valign="bottom":E.valign="middle",1==y.length&&(E.valign="middle"))):(E.valign||(E.valign="top"),E.align||(0==o?E.align="left":o==y.length-1?E.align="right":E.align="middle",1==y.length&&(E.align="middle"))),E[B]&&(E[j]=0),S+=E[B]+E[P]}if(100<(S+=w))zog("zim controls - Layout(): cannot fit regions into 100% bounds");else{var L=100-S;Y(),this.resize=function(){if(I.active){A=k.getBounds(),b.setBounds(0,0,A.width,A.height),M.graphics.clear(),""!=x&&M.graphics.f(x).r(0,0,A.width,A.height);for(var e=0;e<y.length;e++)(E=y[e]).maxGiven=0,E.marginGiven=0;for(var t,o,n,i=!0,r=L;i;){t=!(i=!1);for(e=0;e<y.length;e++)0<(E=y[e]).given&&0==E.maxGiven&&(u=E.object.getBounds()[B],h=E.object.getBounds()[O],o=E.given*A[B]/100,(n=E[D]*A[O]/100)<h/u*o?(E.maxGiven=u/h*n*100/A[B],E.given-E.maxGiven,r-=E.maxGiven):t=!1);if(t)break;for(e=totalPrimaries=0;e<y.length;e++)0==(E=y[e])[B]&&0==E.maxGiven&&(totalPrimaries+=E.object.getBounds()[B]);for(e=0;e<y.length;e++)0==(E=y[e])[B]&&0==E.maxGiven&&(E.given=E.object.getBounds()[B]/totalPrimaries*r)}var a=!0;if(0<(E=y[0]).maxGiven?E.maxGiven<E[j]&&(E[B]=E[j],a=!1):0<E.given&&E.given<E[j]&&(E[B]=E[j],a=!1),0<(E=y[y.length-1]).maxGiven?E.maxGiven<E[j]&&(E[B]=E[j],a=!1):0<E.given&&E.given<E[j]&&(E[B]=E[j],a=!1),!a){for(e=S=0;e<y.length;e++)E=y[e],S+=E[B]+E[P];return 100<(S+=w)?void zog("zim display - Layout(): cannot fit regions into 100% bounds"):(L=100-S,Y(),void I.resize())}var s=!0,l=0,c=0;for(e=0;e<y.length;e++)l+=(E=y[e])[P],0<E[B]?c+=E[B]:0<E.maxGiven?c+=E.maxGiven:0<E.given&&(c+=E.given),0==E[B]&&(s=!1);if(s||t){var d=100-c-(l+=w);if(l-=w+y[0][P],0!=d&&0!=l)for(e=0;e<y.length;e++)0!=e&&((E=y[e]).marginGiven=E[P]/l*(l+d))}var u,h,f,g,p,m=0,z=0;if(T&&T.graphics){var v=T.graphics;v.c()}for(e=0;e<y.length;e++)0<(E=y[e]).marginGiven?m+=E.marginGiven*A[B]/100:m+=E[P]*A[B]/100,u=(u=0<E[B]?E[B]:0<E.maxGiven?E.maxGiven:0<E.given?E.given:0)*A[B]/100,h=E[D]*A[O]/100,z=(A[O]-h)/2,f=C?Je.fit(E.object,z,m,h,u):Je.fit(E.object,m,z,u,h),"top"==E.valign?E.object.y=f.bY:"bottom"==E.valign&&(E.object.y=f.bY+f.bHeight-f.height),"left"==E.align?E.object.x=f.bX:"right"==E.align&&(E.object.x=f.bX+f.bWidth-f.width),T&&T.graphics&&(v.s("white").ss(2).r(f.bX,f.bY,f.bWidth,f.bHeight),v.s("#ff8203").sd([20,20]).r(f.bX,f.bY,f.bWidth,f.bHeight).sd()),p=g=0,0!=m&&m+u!=A[B]||(C?p=1:g=1),h==A[O]&&(C?g=1:p=1),""!=E.backgroundColor&&M.graphics.f(E.backgroundColor).r(f.bX,f.bY,f.bWidth+g,f.bHeight+p),m+=u}},this.resize(),T&&b.addChild(T),b.addChildAt(M,0),window.addEventListener("keydown",n),this.disable=function(){I.active=!1,window.removeEventListener("keydown",n),T&&(T.alpha=0)},this.enable=function(){I.active=!0,window.addEventListener("keydown",n),I.resize(),T&&(T.alpha=1)},this.removeShape=function(){T&&(T.graphics.clear(),b.removeChild(T),T=null,T=!1),window.removeEventListener("keydown",n)},this.toggled=!0,this.toggle=function(e){return T.visible=!0===e||!1!==e&&!T.visible,I.toggled=T.visible,I},this.addShape=function(e,t){I.removeShape(),T=e,window.addEventListener("keydown",n),b.addChild(T),I.resize()},this.dispose=function(){return I.removeShape(),!0}}}else zog("zim controls - Layout(): holder must have bounds set or provide a scalingObject with bounds");else zog("zim controls - Layout(): please provide an object with bounds set that holds the objects being laid out");function Y(){for(var e=0,t=0;t<y.length;t++)((E=y[t]).given=0)==E[B]&&(e+=E.object.getBounds()[B]);for(t=0;t<y.length;t++)0==(E=y[t])[B]&&(E.given=E.object.getBounds()[B]/e*L)}function n(e){e||(e=event),T&&String.fromCharCode(e.keyCode)==t.toUpperCase()&&(I.toggle(),T.stage&&T.stage.update())}},Je.extend(Je.Layout,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.LayoutManager=function(){z_d("81");var t=this;this.items=[],this.add=function(e){t.items.push(e)},this.resize=function(){for(var e=0;e<t.items.length;e++)t.items[e].resize()},this.disable=function(){for(var e=0;e<t.items.length;e++)t.items[e].disable()},this.enable=function(){for(var e=0;e<t.items.length;e++)t.items[e].enable()},this.dispose=function(){for(var e=0;e<t.items.length;e++)t.items[e].removeShape();return!0}},Je.Tile=function(e,t,o,n,i,r,a,s,l,c,d,u,h,f){var g;if(g=zob(Je.Tile,arguments,"obj, cols, rows, spacingH, spacingV, colSize, rowSize, align, valign, count, mirrorH, mirrorV, snapToPixel, clone",this))return g;z_d("66.5"),this.zimContainer_constructor(),this.type="Tile",zot(t)&&(t=1),zot(o)&&(o=1),zot(n)&&(n=0),zot(i)&&(i=0),zot(s)&&(s="left"),zot(l)&&(l="top"),0==c&&(c=null,zon&&zog("ZIM Tile() - count parameter of 0 is ignored - see docs")),zot(d)&&(d=!1),zot(u)&&(u=!1),zot(h)&&(h=!0),h&&(e.stage?e.stage.snapToPixelEnabled=!0:"undefined"!=typeof elem&&zimDefaultFrame&&(zimDefaultFrame.stage.snapToPixelEnabled=!0)),zot(f)&&(f=!0);var p,m,z=this,v=0,b=0,y=0;e:for(var w=0;w<o;w++){for(var x=b=m=0;x<t;x++){if(v++,!zot(c)&&c<v)break e;if(p=f?zik(e).clone():zik(e),0==x&&0==w)var C=p.getBounds(),T=p.regY-C.y,k=p.regX-C.x;var A=r||p.width,E=a||p.height;m<E&&(m=E),p.snapToPixel=h,this.addChild(p),d&&x%2==1?(p.scaleX=-p.scaleX,p.x=b+A-2*p.getBounds().x*p.scaleX):p.x=b,"center"==s||"middle"==s?p.x+=(A-p.width)/2+(p.regX-p.getBounds().x):"right"==s&&(p.x+=A-p.width+(p.regY-p.getBounds().y)),u&&w%2==1?(p.scaleY=-p.scaleY,p.y=y+E-2*p.getBounds().y*p.scaleY):p.y=y,"center"==l||"middle"==l?p.y+=(E-p.height)/2+(p.regY-p.getBounds().y):"bottom"==l&&(p.y+=E-p.height+(p.regY-p.getBounds().y)),b+=A+n,p.x+=k,p.y+=T}y+=m+i}this.clone=function(){return z.cloneProps(new Je.Tile(e,t,o,n,i,r,a,s,l,c,d,u,h,f))}},Je.extend(Je.Tile,Je.Container,"clone","zimContainer",!1),Je.Parallax=function(e,t,a,i){var o;if(o=zob(Je.Parallax,arguments,"layers, damp, auto, stage",this))return o;if(z_d("68"),zot(i))if(e&&e[0]&&e[0].obj&&e[0].obj.stage)i=e[0].obj.stage;else{if(!zimDefaultFrame)return;i=zimDefaultFrame.stage}a=!!zot(a);var s=i.getBounds().width,l=i.getBounds().height,n=this,c=zot(t)?.1:t;this.addLayer=function(e){if(!(zot(e.obj)||zot(e.prop)||zot(e.propChange))){var t={obj:e.obj,prop:e.prop};t[t.prop]=e.propChange,zot(e.input)&&(e.input="mouseX"),t.input=e.input,t.split=zot(e.split)?!("mouseX"!=e.input||!a):e.split;var o=zot(e.inMin)?0:e.inMin,n=zot(e.inMax)?"mouseX"==e.input||"scrollX"==e.input?s:l:e.inMax,i=zot(e.factor)?1:e.factor,r=!zot(e.integer)&&e.integer;return t["p_"+t.prop]=new Je.ProportionDamp(o,n,0,t[t.prop],c,i,r),"scale"==t.prop?t["s_"+t.prop]=t.obj.scaleX:"frame"==t.prop?t["s_"+t.prop]=t.obj.currentFrame:t["s_"+t.prop]=t.obj[t.prop],zot(e.immediate)||t["p_"+t.prop].immediate(e.immediate),d.push(t),d.length-1}},this.removeLayer=function(e){if(!zot(e)){var t=d[e];t["p_"+t.prop].dispose(),d.splice(e,1)}},this.immediate=function(e){for(var t,o=0;o<d.length;o++)(t=d[o])["p_"+t.prop].immediate(e[o])},this.dispose=function(){return d=null,a&&Je.Ticker.remove(u),!0},e=zot(e)?[]:e;for(var d=[],r=0;r<e.length;r++)this.addLayer(e[r]);if(a)var u=Je.Ticker.add(function(e){n.step()},i);this.step=function(e){for(var t,o,n=0;n<d.length;n++)t=d[n],zot(e)?"mouseX"==t.input?o=i.mouseX:"mouseY"==t.input?o=i.mouseY:"scrollX"==t.input?o=Je.scrollX():"scrollY"==t.input&&(o=Je.scrollY()):o=e,"scale"==t.prop?t.obj.scaleX=t.obj.scaleY=t["s_"+t.prop]+t["p_"+t.prop].convert(o):"frame"==t.prop?t.obj.gotoAndStop(t["s_"+t.prop]+t["p_"+t.prop].convert(o)):(t.obj[t.prop]=t["s_"+t.prop]+t["p_"+t.prop].convert(o),t.split&&(t.obj[t.prop]-=t[t.prop]/2))},Object.defineProperty(n,"damp",{get:function(){return c},set:function(e){var t;c=e;for(var o=0;o<d.length;o++)(t=d[o])["p_"+t.prop].damp=c}})},Je.Scroller=function(e,t,o,n,i,r,a){var s;if(s=zob(Je.Scroller,arguments,"backing, speed, direction, horizontal, gapFix, stage, container",this))return s;z_d("69"),this.cjsEventDispatcher_constructor();var l=this.backing1=e;if(!zot(l)&&l.getBounds){var c=this.backing2=e.clone();zot(n)&&(n=!0),zot(i)&&(i=0);var d=this;this.speed=zot(t)?1:t;var u=this.baseSpeed=this.speed;this.direction=zot(o)?1:o;var h=n?l.scaleX:l.scaleY;if(l.getBounds())if(r||l.stage)if(l.parent)if(l.parent.addChildAt(c,l.parent.getChildIndex(l)),r=r||l.stage,zot(a)&&(a=r),a.getBounds()){var f,g,p=l.getBounds().width*h-i,m=l.getBounds().height*h-i;n?c.x=p:c.y=m;var z=!1,v=Je.Ticker.add(function(e){f||(f=a.getBounds().width,g=a.getBounds().height);if(0==d.speed||0==d.direction)return;n?(l.x-=d.speed*d.direction,l.x<c.x?c.x=l.x+p:c.x=l.x-p,0<d.direction*d.speed?c.x<0&&l.x<c.x?l.x=c.x+p:l.x<0&&c.x<l.x&&(c.x=l.x+p):c.x>f&&c.x>l.x?c.x=l.x-p:l.x>f&&l.x>c.x&&(l.x=c.x-p)):(l.y-=d.speed*d.direction,l.y<c.y?c.y=l.y+m:c.y=l.y-m,0<d.direction*d.speed?c.y<0&&l.y<c.y?l.y=c.y+m:l.y<0&&c.y<l.y&&(c.y=l.y+m):c.y>g&&c.y>l.y?c.y=l.y-m:l.y>g&&l.y>c.y&&(l.y=c.y-m))},r);this.paused=!1,this.pause=function(e,t){return zot(e)&&(e=!0),zot(t)&&(t=0),e?(u=d.speed,0<t?(z=!0,Je.animate({target:d,obj:{pausingSpeed:0},ticker:!1,time:t,call:function(){d.speed=0,d.paused=!0,z=!1,d.dispatchEvent("pause")}})):(z=!1,d.speed=0,d.paused=!0,setTimeout(function(){d.dispatchEvent("pause")},10))):(z=!1,0<t?Je.animate({target:d,obj:{pausingSpeed:u},ticker:!1,time:t,call:function(){d.speed=u,d.paused=!1,z=!1}}):(d.speed=u,d.paused=!1)),d},Object.defineProperty(d,"percentSpeed",{get:function(){return 0==d.baseSpeed?NaN:d.speed/d.baseSpeed*100},set:function(e){z||d.paused||(d.speed=d.baseSpeed*e/100)}}),Object.defineProperty(d,"pausingSpeed",{get:function(){return 0==d.baseSpeed?NaN:d.speed/d.baseSpeed*100},set:function(e){d.speed=d.baseSpeed*e/100}}),this.dispose=function(){return zon&&zog("bye from Scroller"),Je.Ticker.remove(v),!0}}else zog("zim display - Scroller(): please setBounds() on container or stage if no container");else zog("zim display - Scroller(): please add object to container or stage before adding to Scroller");else zog("zim display - Scroller(): please pass in stage parameter or add backing objects to stage to start");else zog("zim display - Scroller(): please setBounds() on backing objects")}},Je.extend(Je.Scroller,createjs.EventDispatcher,null,"cjsEventDispatcher"),Je.Dynamo=function(n,e,t,o,i,r,a,s,l){var c;if(c=zob(Je.Dynamo,arguments,"sprite, speed, label, startFrame, endFrame, update, reversible, flip, flipVertical",this))return c;z_d("69.2"),this.cjsEventDispatcher_constructor();var d=this.frames=n.parseFrames(t,o,i,!0);if(0!=d.length){this.totalFrames=d.length;var u=0;zot(e)&&(e=30),zot(a)&&(a=!0);var h=this.baseSpeed=this.speed=e;zot(r)&&(r=!1),zot(s)&&0==a&&(s=!0);var f,g,p,m,z,v=this,b=Date.now(),y=!1;v.scaleX=n.scaleX,v.scaleY=n.scaleY,function e(){if(f=requestAnimationFrame(e),g=d[u].s,0!=v.speed&&0!=g&&(m=1e3/Math.abs(v.speed)*g,p=Date.now(),m<p-b)){b=p;var t=v.frame+(0<v.speed||!a?1:-1),o=!1;t>=d.length&&(o=!0,t=0),t<0&&(o=!0,t=d.length-1),v.frame=t,s&&(v.speed<0?n.scaleX=-v.scaleX:n.scaleX=v.scaleX),l&&(v.speed<0?n.scaleY=-v.scaleY:n.scaleY=v.scaleY),o&&v.dispatchEvent("loop"),v.dispatchEvent("change"),r&&n.stage&&n.stage.update(),zot(z)||z!=v.frame||(y=!1,v.speed=0,v.paused=!0,v.dispatchEvent("pause"))}}(),this.paused=!1,this.pause=function(e,t,o){return zot(e)&&(e=!0),zot(t)&&(t=0),e?(h=v.speed,zot(o)?0<t?(y=!0,Je.animate({target:v,obj:{pausingSpeed:0},ticker:!1,time:t,call:function(){y=!1,v.speed=0,v.paused=!0,v.dispatchEvent("pause")}})):(y=!1,v.speed=0,v.paused=!0,setTimeout(function(){v.dispatchEvent("pause")},10)):(y=!0,z=o)):(z=null,0<t?(y=!0,Je.animate({target:v,obj:{pausingSpeed:h},ticker:!1,time:t,call:function(){y=!1,v.speed=h,v.paused=!1}})):(y=!1,v.speed=h,v.paused=!1)),v},Object.defineProperty(v,"frame",{get:function(){return u},set:function(e){u=Math.round(e)%d.length;var t=d[u];zot(t)||(n.frame=t.f)}}),Object.defineProperty(v,"percentSpeed",{get:function(){return 0==v.baseSpeed?NaN:v.speed/v.baseSpeed*100},set:function(e){y||v.paused||(v.speed=v.baseSpeed*e/100)}}),Object.defineProperty(v,"pausingSpeed",{get:function(){return 0==v.baseSpeed?NaN:v.speed/v.baseSpeed*100},set:function(e){v.speed=v.baseSpeed*e/100}}),this.dispose=function(){cancelAnimationFrame(f)}}},Je.extend(Je.Dynamo,createjs.EventDispatcher,null,"cjsEventDispatcher"),Je.Accelerator=function(e){z_d("69.3"),this.cjsEventDispatcher_constructor();var s=this;this.paused=!1,this.items=[],this.paused=!1,this._percentSpeed=100,this.add=function(e){var t;t=Array.isArray(e)?e:[e];for(var o=0;o<t.length;o++)s.items.indexOf(t[o])<0&&t[o].pause&&s.items.push(t[o]);return s},e&&this.add(e),this.remove=function(e){var t,o;t=Array.isArray(e)?e:[e];for(var n=0;n<t.length;n++)0<=(o=s.items.indexOf(t[n]))&&s.items.splice(o,1);return s},this.pause=function(o,e,t){zot(o)&&(o=!0);var n=[];if(o){zot(t)||(e=null);for(var i=!1,r=0;r<s.items.length;r++)(zot(e)||!zot(t)||s.items[r].totalFrames)&&(!s.items[r].totalFrames||zot(e)&&zot(t))||(s.items[r].pause(!0,e,t),i=!0,n[r]=1,s.items[r].on("pause",function(){s.paused||(a(!0),s.paused=!0,s.dispatchEvent("pause"))},null,!0));i||(a(),s.paused=!0,setTimeout(function(){s.dispatchEvent("pause")},10))}else s.paused=!1,a();function a(e){for(var t=0;t<s.items.length;t++)1!=n[t]&&s.items[t].pause(o)}},Object.defineProperty(s,"percentSpeed",{get:function(){return s._percentSpeed},set:function(e){s._percentSpeed=e;for(var t=0;t<s.items.length;t++)s.items[t].percentSpeed=e}}),this.dispose=function(){for(var e=0;e<s.items.length;e++)s.items[e].dispose();return!0}},Je.extend(Je.Accelerator,createjs.EventDispatcher,null,"cjsEventDispatcher"),Je.Swiper=function(e,t,o,n,i,r,a,s,l,c,d){var u;if(u=zob(Je.Swiper,arguments,"swipeOn, target, property, sensitivity, horizontal, min, max, damp, integer, factor, pauseTime",this))return u;if(z_d("69.5"),this.cjsEventDispatcher_constructor(),!zot(e)&&e.getStage&&e.stage){if(!zot(t)){zot(n)&&(n=1),zot(i)&&(i=!0),zot(s)&&(s=.1),zot(l)&&(l=!1),zot(c)&&(c=1),zot(d)&&(d=200);var h,f,g,p,m,z,v=this,b=e,y=v.desiredValue=t[o];this.target=t,this.property=o;var w=!1;b.canvas?(p=b.on("stagemousedown",function(){w=!0,A(),m=b.on("stagemousemove",E),z=b.on("stagemouseup",function(){w=!1,b.off("stagemousemove",m),b.off("stagemouseup",z),v.dispatchEvent("swipeup")})}),g=b):(g=b.stage,M(),p=b.on("mousedown",A),m=b.on("pressmove",E),z=b.on("pressup",function(){w=!1,v.dispatchEvent("swipeup")}));var x=new Je.Damp(v.target[v.property],s),C=(v.target[v.property],0),T=null;v.target.swiperTicker=Je.Ticker.add(function(){y==C?y!=T&&(v.pauseTimeout&&v.pauseTimeout.clear(),T=y,v.pauseTimeout=Je.timeout(d,function(){v.dispatchEvent("swipepause"),v.pauseTimeout=null})):(T=null,C=y,v.pauseTimeout&&v.pauseTimeout.clear()),v.swiperMoving&&(v.target[v.property]=l?Math.round(x.convert(y)):x.convert(y),!w&&Math.abs(v.target[v.property]-y)<(zot(r)||zot(a)?1:Math.abs(a-r)/1e3)?(v.swiperMoving=!1,v.target[v.property]=y,v.immediate(v.target[v.property]),v.dispatchEvent("swipestop")):v.target[v.property])},g),this.immediate=function(e){x.immediate(e),v.target[v.property]=l?Math.round(e):e,v.desiredValue=y=e};var k=!0;Object.defineProperty(v,"enabled",{get:function(){return k},set:function(e){k!=e&&(e?function(){b.canvas?p=b.on("stagemousedown",p):(p=b.on("mousedown",p),m=b.on("pressmove",m),z=b.on("pressup",z));v.immediate(v.target[v.property]),v.target.swiperTicker=Je.Ticker.add(v.target.swiperTicker,g)}():I(),k=Boolean(e))}}),this.dispose=function(){I(),x=null}}}else zog("zim.Swiper() - please provide container on stage");function A(e){w=!0,h=i?e.stageX:e.stageY,f=v.target[v.property],v.dispatchEvent("swipedown")}function E(e){var t=h-(i?e.stageX:e.stageY);0<Math.abs(t)&&(v.swiperMoving=!0),y=f-t*n*c,zot(r)||(y=Math.max(y,r)),zot(a)||(y=Math.min(y,a)),v.desiredValue=y,v.dispatchEvent("swipemove")}function M(){b.off("mousedown",p),b.off("pressmove",m),b.off("pressup",z)}function I(){b.canvas?(b.off("stagemousedown",p),b.off("stagemousemove",m),b.off("stagemouseup",z)):M(),Je.Ticker.remove(v.target.swiperTicker)}},Je.extend(Je.Swiper,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.MotionController=function(o,n,i,e,t,r,a,s,l,c,d,u,h,f,g,p,m){var z;if(z=zob(Je.MotionController,arguments,"container, target, type, speed, axis, rect, map, diagonal, damp, flip, rotate, constant, firstPerson, turnSpeed, moveThreshold, stickThreshold, localBounds",this))return z;if(z_d("69.7"),this.cjsEventDispatcher_constructor(),!zot(o)&&o.getStage)if(zot(o.stage))zog("zim Controller(): The Container must be on the stage");else{var v=o.stage;zot(n)&&(n=new Je.Container(1,1)),zot(e)&&(e=7),(zot(i)||"mousemove"!=i&&"keydown"!=i&&"gamebutton"!=i&&"gamestick"!=i&&"swipe"!=i&&"manual"!=i)&&(i="mousedown"),zot(t)&&(t="both"),"keydown"==i&&zot(a)&&(a=[[65,37],[68,39],[87,38],[83,40]]),"gamebutton"==i&&zot(a)&&(a=h?[14,15,Je.GamePad.RT,Je.GamePad.LT]:[14,15,12,13]),"gamestick"==i&&zot(a)&&(a=h?[[0,2],[0,2],[1],[1]]:[0,0,1,1]),"gamestick"==i&&zot(a)&&(a=[0,0,1,1]),zot(s)&&(s=!0),"horizontal"!=t&&"vertical"!=t||(s=!1),zot(l)&&(l="keydown"==i||"gamebutton"==i?1:.1),zot(h)&&(h=!1),zot(f)&&(f=.4*e),zot(g)&&(g=4),zot(p)&&(p=.2);var b=this;this.dirX=0,this.dirY=0,this.speed=e,this.turnSpeed=f,this.axis=t,this.target=n,this.moveThreshold=g,this.stickThreshold=p;var y=b.speed,w=b.speed,x=0;b.rotation=0,b.x=this.target.x,b.y=this.target.y;var C=b.scaleX=n.scaleX;b.scaleY=n.scaleY;if("keydown"==i||"gamebutton"==i){for(var T=0;T<4;T++)Array.isArray(a[T])||(a[T]=[a[T]]);var k=[0,0,0,0],A=[],E=["X","X","Y","Y"],M=[-1,1,-1,1],I={dirX:0,dirY:0};if("keydown"==i)var S=frame.on("keydown",B);else var j=(X=b.gamepad=new Je.GamePad).on("buttondown",B);function B(e){var t,o="keydown"==i?e.keyCode:e.buttonCode;for(T=0;T<4;T++)if(-1<a[T].indexOf(o)){if(s||"both"!=b.axis||(I.dirX=I.dirY=0),I["dir"+E[T]]=M[T],k[T]=1,0==(t=A.indexOf(T)))return;return 0<t&&A.splice(t,1),void A.unshift(T)}}if(zot(u))if("keydown"==i)var O=frame.on("keyup",D);else var P=X.on("buttonup",D);function D(e){var t,o="keydown"==i?e.keyCode:e.buttonCode;for(T=0;T<4;T++)if(-1<a[T].indexOf(o)){if((k[T]=0)<=(t=A.indexOf(T))&&A.splice(t,1),"both"!=b.axis||s)I["dir"+E[T]]=-k[2*Math.floor(T/2)]+k[2*Math.floor(T/2)+1];else if(0<A.length){I["dir"+E[T]]=0;var n=A[0];I["dir"+E[n]]=M[n]}else I.dirX=I.dirY=0;return}}var L={rotation:0,speedX:b.speed,speedY:b.speed},Y=Je.Ticker.add(function(){if(h)K(I);else{var e=b.speed,t=b.speed;if("both"==b.axis&&0!=I.dirX&&0!=I.dirY){var o=J(I.dirX,I.dirY);e=o.speedX,t=o.speedY}"horizontal"!=b.axis&&"both"!=b.axis||(b.x+=e*I.dirX),"vertical"!=b.axis&&"both"!=b.axis||(b.y+=t*I.dirY),q()}},v)}else if("mousedown"==i||"mousemove"==i)mouseEvent=v.on("stage"+i,function(e){var t=o.globalToLocal(e.stageX,e.stageY);b.x=t.x,b.y=t.y,q()});else if("gamestick"==i){var X=this.gamepad=new Je.GamePad;for(T=0;T<4;T++)Array.isArray(a[T])||(a[T]=[a[T]]);L={rotation:0,speedX:b.speed,speedY:b.speed};var _=X.on("data",function(e){for(var t={dirX:0,dirY:0},o=0;o<a[0].length;o++){var n=e.axes[a[0][o]];if(Math.abs(n)>b.stickThreshold){t.dirX=n;break}}for(o=0;o<a[2].length;o++){n=e.axes[a[2][o]];if(Math.abs(n)>b.stickThreshold){t.dirY=n;break}}h?K(t):(b.x+=b.speed*t.dirX,b.y+=b.speed*t.dirY,q())})}else if("swipe"==i)var R=new Je.Swiper(v,b,"x",.8),F=new Je.Swiper(v,b,"y",.8,!1),W=R.on("swipemove",function(){q()});var N=this.x=this.target.x,G=this.y=this.target.y;this.dampX=new Je.Damp(N,l),this.dampY=new Je.Damp(G,l),this.dampR=new Je.Damp(this.target.rotation,l);var V=0,H=0,U=Je.Ticker.add(function(){if(r&&(b.x=Je.constrain(b.x,r.x,r.x+r.width),b.y=Je.constrain(b.y,r.y,r.y+r.height)),"horizontal"!=b.axis&&"both"!=b.axis||(b.dirX=Je.sign(b.x-N),Math.abs(b.x-N)<y?N=b.x:N+=b.dirX*y,b.target.x=b.dampX.convert(N)),"vertical"!=b.axis&&"both"!=b.axis||(b.dirY=Je.sign(b.y-G),Math.abs(b.y-G)<w?G=b.y:G+=Je.sign(b.y-G)*w,b.target.y=b.dampY.convert(G)),b.dirX!=V||b.dirY!=H){var e=new createjs.Event("change");if(b.dirX!=V){var t=["left",null,"right"];e.dir=t[b.dirX+1],V=b.dirX,"horizontal"!=c&&"both"!=c||(b.scaleX=n.scaleX=b.dirX?Math.abs(n.scaleX)*b.dirX:n.scaleX,x=0!=C&&-1==Math.round(b.scaleX/C)?180:0)}else{t=["up",null,"down"];e.dir=t[b.dirY+1],H=b.dirY,"vertical"!=c&&"both"!=c||(b.scaleY=n.scaleY=b.dirY?Math.abs(n.scaleY)*b.dirY:n.scaleY)}b.dispatchEvent(e)}b.movingX=Math.abs(N-b.target.x)>b.moveThreshold,b.movingY=Math.abs(G-b.target.y)>b.moveThreshold,b.moving=b.movingX||b.movingY,d&&!zot(b.rotation)&&(b.target.rotation=b.dampR.convert(b.rotation))},v);this.immediate=function(e,t,o){!zot(e)&&b.dampX&&(b.dampX.immediate(e),b.x=b.target.x=N=e,R&&R.immediate(e)),!zot(t)&&b.dampY&&(b.dampY.immediate(t),b.y=b.target.y=G=t,F&&F.immediate(t)),!zot(o)&&b.dampR&&(b.dampR.immediate(o),b.rotation=b.target.rotation=o)},this.convert=function(e,t){zot(e)||(b.x=e),zot(t)||(b.y=t),q()};var Z=!0;Object.defineProperty(b,"enabled",{get:function(){return Z},set:function(e){Z!=e&&(e?function(){"keydown"==i?(S=frame.on("keydown",S),O=frame.on("keyup",O),Y=Je.Ticker.add(Y,v)):"gamebutton"==i?(j=X.on("buttondown",j),P=X.on("buttonup",P),Y=Je.Ticker.add(Y,v)):"gamestick"==i?_=X.on("data",_):"swipe"==i?(R.enabled=!0,F.enabled=!0,W=R.on("swipemove",W)):"mousedown"!=i&&"mousemove"!=i||(mouseEvent=v.on("stage"+i,mouseEvent));U=Je.Ticker.add(U,v)}():$(),Z=Boolean(e))}}),this.dispose=function(){$(),X&&X.dispose(),R&&R.dispose(),F&&R.dispose()}}else zog("zim Controller(): Please pass in a reference to a container as first parameter");function K(e){L.rotation+=e.dirX*b.turnSpeed,b.rotation=L.rotation,L.speedX=Math.sin(L.rotation*Math.PI/180)*b.speed*-e.dirY,L.speedY=-Math.cos(L.rotation*Math.PI/180)*b.speed*-e.dirY,b.x+=L.speedX,b.y+=L.speedY}function q(){var e=J(b.x-b.target.x,b.y-b.target.y);if(y=e.speedX,w=e.speedY,d)if(b.rotation=e.angle,zot(b.rotation))b.rotation=b.target.rotation;else{b.rotation+=x;var t=Q(b.rotation),o=b.target.rotation=Q(b.target.rotation);180<Math.abs(t-o)&&(t<o?o-=360:t-=360),b.dampR.immediate(o),b.target.rotation=o,b.rotation=t}}function Q(e){return(e%360+360)%360}function J(e,t){var o,n=b.speed,i=b.speed,r=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));return 0<r&&(n=Math.abs(e)/r*b.speed,i=Math.abs(t)/r*b.speed,o=90-180*Math.atan2(e,t)/Math.PI),{speedX:n,speedY:i,angle:o}}function $(){"keydown"==i?(frame.off("keydown",S),frame.off("keyup",O),Je.Ticker.remove(Y)):"gamebutton"==i?(X.off("buttondown",j),X.off("buttonup",P),Je.Ticker.remove(Y)):"gamestick"==i?X.off("data",_):"swipe"==i?(R.enabled=!1,F.enabled=!1,R.off("swipemove",W)):"mousedown"!=i&&"mousemove"!=i||v.off("stage"+i,mouseEvent),Je.Ticker.remove(U)}},Je.extend(Je.MotionController,createjs.EventDispatcher,"enabled","cjsEventDispatcher"),Je.GamePad=function(){if(z_d("69.8"),this.cjsEventDispatcher_constructor(),!navigator.getGamepads)return this.error=!0,void(zon&&zog("zim.GamePad() - no browswer support"));var a;window.addEventListener("gamepadconnected",e),this.currentIndex=0;var s=this;function e(e){var t,o,n;s.connected=!0,t="gamepadconnected",o=e,(n=new createjs.Event(t)).index=o.gamepad.index,n.id=o.gamepad.id,n.buttons=o.gamepad.buttons,n.axes=o.gamepad.axes,s.dispatchEvent(n);var i=navigator.getGamepads()[s.currentIndex];s.lastData=[];for(var r=0;r<i.buttons.length;r++)s.lastData[r]=i.buttons[r].pressed;!function e(){if(a=requestAnimationFrame(e),s.data=navigator.getGamepads()[s.currentIndex],s.data){for(var t=s.buttons=[],o=0;o<s.data.buttons.length;o++)if(t[o]=s.data.buttons[o].pressed,t[o]!=s.lastData[o]){if(s.lastData[o]=t[o],t[o])var n=new createjs.Event("buttondown");else n=new createjs.Event("buttonup");n.buttonCode=o,n.button=l[o],s.dispatchEvent(n)}(n=new createjs.Event("data")).axes=s.axes=s.data.axes,n.buttons=s.buttons,s.dispatchEvent(n)}}()}var t=setInterval(function(){navigator.getGamepads&&navigator.getGamepads()[0]&&(s.connected||e(),clearInterval(t))},500);var o=window.addEventListener("gamepaddisconnected",function(e){e.gamepad.index==s.currentIndex&&(cancelAnimationFrame(a),connected=!1,s.dispatchEvent("gamepaddisconnected"))});this.dispose=function(){window.removeEventListener("gamepadconnected",e),window.addEventListener("gamepaddisconnected",o),cancelAnimationFrame(a),clearInterval(t),s.connected=!1}};for(var l=["A","B","X","Y","LB","RB","LT","RT","BACK","START","LS","RS","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT"],s=0;s<l.length;s++)Je.GamePad[l[s]]=s;var e=["LSX","LSY","RSX","RSY"];for(s=0;s<e.length;s++)Je.GamePad[e[s]]=s;return Je.extend(Je.GamePad,createjs.EventDispatcher,null,"cjsEventDispatcher"),Je.Emitter=function(p,m,z,t,e,o,n,i,r,a,s,l,v,b,c,d,u,h,f,g,y,w,x,C,T,k,A,E,M,I){var S;if(S=zob(Je.Emitter,arguments,"obj, width, height, interval, num, life, fade, shrink, decayTime, decayStart, trace, traceFadeTime, traceShiftX, traceShiftY, angle, force, gravity, wind, layers, animation, random, horizontal, vertical, sink, sinkForce, cache, events, startPaused, pool, poolMin",this))return S;z_d("69.9"),zot(p)&&(p=[]),zot(m)&&(m=300),zot(z)&&(z=300),zot(t)&&(t=20),"number"==typeof t&&(t=Math.max(10,t)),zot(e)&&(e=1),zot(s)&&(s=!1),zot(l)&&(l=r),zot(v)&&(v=0),zot(b)&&(b=0),zot(o)&&(o=1e3),zot(n)&&(n=!0),zot(i)&&(i=!s),zot(r)&&(r=1e3),zot(c)&&(c={min:0,max:360}),zot(d)&&(d=5),zot(u)&&(u=9.8),zot(h)&&(h=0),zot(f)&&(f="top"),zot(m)&&(m=100),zot(z)&&(z=100),zot(w)&&(w=!1),zot(x)&&(x=!1),!zot(C)&&zot(T)&&(T=10),zot(A)&&(A=!1),zot(E)&&(E=!1),zot(M)&&(M=!0),zot(I)&&(I=0),this.zimContainer_constructor(m,z),this.type="Emitter";var j=this;j.obj=p,j.interval=t,j.num=e,j.life=o,j.fade=n,j.shrink=i,j.decayTime=r,j.decayStart=a,j.trace=s,j.traceFadeTime=l,j.traceShiftX=v,j.traceShiftY=b,j.angle=c,j.force=d,j.gravity=u,j.wind=h,j.layers=f,j.animation=g,j.random=y,j.horizontal=w,j.vertical=x,j.sink=C,j.sinkForce=T,j.events=A,j.startPaused=E,j.pool=M,j.poolMin=I,j.particlesEmitted=0;var B,O,P=[],D=0,L=0;function Y(e){if(j.events&&X("fizzed",e),(e.trace?e.getChildAt(0).endSpurt:e.endSpurt)&&(X("spurtfizzed",e),j.spurting=!1),j.pool&&"end"!=e.pooled)return e.pooled||(e.pooled=!0,P.push(e)),void(e.visible=!1);j.removeChild(e),j.trace&&e.uncache(),e=null}function X(e,t){var o=new createjs.Event(e);o.particle=t.trace?t.getChildAt(0):t,j.dispatchEvent(o)}function _(e){j.pause(),j.spurtCount=j.spurtNum=null,X("spurted",e),e.endSpurt=!0}Je.added(j,function(e){O=e,zot(k)&&(k=!O.isWebGL&&Je.mobile());k&&(O.snapToPixelEnabled=!0);if(O){w||x||j.centerReg(null,null,!1),j.zimInterval=Je.interval(j.interval,function(){var f,g;j.startPaused?j.pause():(p=Array.isArray(j.obj)?j.obj:[j.obj]).length<=0||(Array.isArray(j.interval)?(j.interval.sort(e),f=j.interval[0]):f=j.interval.constructor=={}.constructor?j.interval.min:j.interval,Array.isArray(j.num)?(j.num.sort(e),g=j.num[j.num.length-1]):g=j.num.constructor=={}.constructor?j.num.max:j.num,Je.loop(zik(j.num),function(){if(0<j.decayTime){var e={};j.shrink&&(e.scale=0),j.fade&&(e.alpha=0)}if(j.pool&&0<P.length&&L>=Math.max(j.poolMin,(j.life/f+5)*g)){var o=P[D++%P.length];o.visible=!0;var n=o.trace?o.getChildAt(0):o;if(n.emitShape){var t=n.template;n.graphics.c().s(t.s?zik(t.s):null).ss(t.ss?zik(t.ss):null).sd(t.sd?zik(t.sd):null,t.offset?zik(t.offset):null)}o.trace&&o.updateCache(),"top"==j.layers?n.emitShape?o.addTo(j,null,!1):o.centerReg(j):n.emitShape?o.addTo(j,"bottom"==j.layers?0:Je.rand(j.numChildren),!1):o.centerReg(j,"bottom"==j.layers?0:Je.rand(j.numChildren)),o.alpha=1,o.scaleX=1,o.scaleY=1,n.alpha=n.originalAlpha,n.scaleX=n.originalScaleX,n.scaleY=n.originalScaleY,n.endSpurt=!1}else{L++,j.trace&&((o=new Je.Container(m,z)).trace=!0);var i=zik(Je.shuffle(p)[0]);if("shape"==i.type){var t=i,n=new Je.Shape(1,1);n.emitShape=!0,n.template=t,n.graphics.s(t.s?zik(t.s):null).ss(t.ss?zik(t.ss):null).sd(t.sd?zik(t.sd):null,t.offset?zik(t.offset):null),j.trace?n.addTo(o,null,!1):"top"==j.layers?n.addTo(j,null,!1):n.addTo(j,"bottom"==j.layers?0:Je.rand(j.numChildren),null,!1)}else{var n=i.clone();n.centerReg||zimify(n),j.trace?n.centerReg(o).pos(-1e3,-1e3):"top"==j.layers?n.centerReg(j):n.centerReg(j,"bottom"==j.layers?0:Je.rand(j.numChildren))}j.trace&&("top"==j.layers?o.addTo(j,null,!1):o.addTo(j,"bottom"==j.layers?0:Je.rand(j.numChildren),!1),o.cache(v,b,m,z)),j.trace||(o=n),(o.particle=n).originalAlpha=n.alpha,n.originalScaleX=n.scaleX,n.originalScaleY=n.scaleY}j.currentParticle=n,j.particlesEmitted++,o.particleNormal=!0,o.particleDecaying=!1,o.particleFizzing=!1;var r=zik(j.angle),a=zik(j.force),s=a*Math.cos(r*Math.PI/180),l=a*Math.sin(r*Math.PI/180);n.info={position:{x:m/2,y:z/2},velocity:{x:s,y:l}},j.horizontal&&(n.info.position={x:Je.rand(0,m),y:j.vertical?z/2:0}),j.vertical&&(n.info.position={x:j.horizontal?m/2:0,y:Je.rand(0,z)}),n.emitShape?n.graphics.mt(n.info.position.x,n.info.position.y):n.pos(n.info.position.x,n.info.position.y),j.random&&Je.loop(j.random,function(e,t){val=zik(t),"scale"==e?n.sca(val):("x"==e?n.info.position.x=j.horizontal||j.vertical?val:val+m/2:"y"==e&&(n.info.position.y=j.horizontal||j.vertical?val:val+z/2),"x"!=e&&"y"!=e||!n.emitShape||n.graphics.mt(n.info.position.x,n.info.position.y),n[e]=val,n.emitShape&&n.pos(0,0))}),k&&!n.emitShape&&n.cache(n.getBounds().x-10,n.getBounds().y-10,n.getBounds().width+20,n.getBounds().height+20);var c,d=!n.emitShape&&j.shrink;if(0<j.decayTime&&(j.fade||d||j.trace&&0<j.traceFadeTime)){if(j.trace&&0<j.traceFadeTime&&o.animate({obj:{alpha:0},time:j.traceFadeTime,wait:j.life-j.traceFadeTime,waitedCall:function(e){e.particleNormal=!1,e.particleFizzing=!0},call:Y,override:!1,id:"decay"}),j.fade||d){var u={};j.fade&&(u.alpha=0),d&&(u.scaleX=0,u.scaleY=0),n.animate({obj:u,time:j.decayTime,wait:zot(j.decayStart)?j.life-j.decayTime:j.decayStart,waitedCall:function(e){e.parent!=j&&(e=e.parent),e.particleNormal=!1,e.particleDecaying=!0},call:function(e){var t;j.events&&X("decayed",e),e.endSpurt&&X("spurtdecayed",e),j.trace&&0<j.traceFadeTime||(zot(j.decayStart)||j.decayStart+j.decayTime>j.life?Y(e.parent.trace?e.parent:e):(t=o,Je.timeout(j.life-(j.decayStart+j.decayTime),function(){Y(t)})))},override:!1,id:"decay"})}}else 0<j.life&&((c=o).timeOut=Je.timeout(j.life,function(){Y(c)}));if(j.events&&X("emitted",o),function(e){if(zot(j.spurtCount)&&zot(j.spurtNum))return;j.spurtCount++,j.spurtCount>=j.spurtNum&&_(e)}(n),j.animation){var h=zik(j.animation);zot(h.override)&&(h.override=!1),n.animate(Je.copy(h))}}));function e(e,t){return e-t}},null,!0);B=j.emitterTicker=Je.Ticker.add(function(){Je.loop(j,function(e){if(e.trace){var t=e;e=e.getChildAt(0)}var o=e.info,n=0,i=0;if(!zot(j.sink)){var r=j.localToGlobal(o.position.x,o.position.y);if(j.sink.parent&&j.sink.parent.localToGlobal)var a=j.sink.parent.localToGlobal(j.sink.x,j.sink.y);else a=new createjs.Point(zik(j.sink.x),zik(j.sink.y));var s=Je.angle(r.x,r.y,a.x,a.y),n=j.sinkForce*Math.cos(s*Math.PI/180),i=j.sinkForce*Math.sin(s*Math.PI/180)}var l=j.wind+n,c=j.gravity+i;o.velocity.x+=l*frameRate,o.velocity.y+=c*frameRate,o.position.x+=o.velocity.x*frameRate*100,o.position.y+=o.velocity.y*frameRate*100,e.emitShape?e.graphics.lt(o.position.x,o.position.y):(e.x=o.position.x,e.y=o.position.y),j.trace&&t&&t.updateCache(e.emitShape?null:"source-over")})},O),frameRate=1/Je.Ticker.framerate}}),Object.defineProperty(j,"interval",{get:function(){return t},set:function(e){t=e,j.zimInterval&&(j.zimInterval.time=t)}}),this.spurting=!1,this.spurt=function(e,t,o){var n;if(n=zob(j.spurt,arguments,"num, time, restart"))return n;zot(t)||(Je.timeout(zik(t),function(){_(j.currentParticle)}),j.spurting=!0),zot(e)||(j.spurtNum=zik(e),j.spurtCount=0,j.spurting=!0),j.pause(!1,o,null,!0)},this.clearPool=function(){Je.loop(j,function(e){e.pooled="end",e.visible||j.removeChild(e)},!0),D=L=0,P=[]},j.startPaused||(this.paused=!1),this.pause=function(e,t,o,n){if(j.startPaused=null,zot(e)&&(e=!0),zot(t)&&(t=!1),zot(o)&&(o=!1),e){if(j.paused)return j;o&&(B&&Je.Ticker.remove(B),Je.loop(j,function(e){e.pauseAnimate(),e.trace&&e.getChildAt(0).pauseAnimate(),e.timeOut&&e.timeOut.pause()})),j.zimInterval.pause(),j.paused=!0}else{if(!j.paused)return j;t&&(Je.loop(j,function(e){e.stopAnimate(),e.timeOut&&e.timeOut.clear(),e.trace&&e.getChildAt(0).pauseAnimate()}),j.removeAllChildren()),O&&B&&!Je.Ticker.has(O,B)&&(Je.Ticker.add(B,O),Je.loop(j,function(e){e.pauseAnimate(!1),e.timeOut&&e.timeOut.pause(!1),e.trace&&e.getChildAt(0).pauseAnimate(!1)})),j.zimInterval.pause(!1,n),j.paused=!1}return j},this.resize=function(e,t){zot(e)||(m=e),zot(t)||(z=t),j.setBounds(0,0,m,z),w||x||j.centerReg(),j.clearPool()},this.clone=function(){var e;return e=Array.isArray(j.obj)||j.obj.constructor=={}.constructor?Je.copy(j.obj):j.obj.clone?j.obj.clone():j.obj,j.cloneProps(new Je.Emitter(e,m,z,j.interval,j.num,j.life,j.fade,j.shrink,j.decayTime,j.decayStart,j.trace,j.traceFadeTime,j.traceShiftX,j.traceShiftY,j.angle,j.force,j.gravity,j.wind,j.layers,j.animation,Je.copy(j.random),j.horizontal,j.vertical,j.sink,j.sinkForce,k,j.events,E,j.pool,j.poolMin))},this.dispose=function(){return B&&Je.Ticker.remove(B),Je.loop(j,function(e){e.stopAnimate()}),j.zimInterval&&j.zimInterval.clear(),!0}},Je.extend(Je.Emitter,Je.Container,"clone","zimContainer",!1),Je.SoundWave=function(e,r,a,t,o,n,s,i,l,c){var d;if(d=zob(Je.SoundWave,arguments,"num, input, include, smoothing, min, max, operation, baseline, magnify, reduce",this))return d;z_d("69.95"),zot(e)&&(e=120),zot(r)&&(r="mic"),zot(a)&&(a=.1171875),zot(t)&&(t=.85),zot(o)&&(o="mic"==r?-80:-100),zot(n)&&(n="mic"==r?-40:-10),zot(s)&&(s=function(e,t){return e*(.5+1*t/Math.pow(Je.SoundWave.bufferLength,.95))}),zot(i)&&(i="mic"==r?0:30),zot(l)&&(l="mic"==r?1:10),zot(c)&&(c=0),Je.SoundWave.bufferLength=1024,_num=e;var u=this;u.baseline=i,u.magnify=l,u.reduce=c;var h=new(window.AudioContext||window.webkitAudioContext),f=u.analyser=h.createAnalyser();if(f.minDecibels=o,f.maxDecibels=n,f.smoothingTimeConstant=t,Object.defineProperty(this,"smoothing",{get:function(){return f.smoothingTimeConstant},set:function(e){f.smoothingTimeConstant=e}}),Object.defineProperty(this,"num",{get:function(){return _num},set:function(e){_num=e,(m=Math.floor(a*Je.SoundWave.bufferLength/_num))<1&&zog("ZIM SoundWave: num is too big")}}),"mic"==r)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,void(navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(e){z(u.source=h.createMediaStreamSource(e))},function(e){zog("ZIM SoundWave: Error occured: "+e)}):zog("ZIM SoundWave: Sorry, mic not supported"));if(r.type&&"sound"==r.type)zog("ZIM SoundWave: pass in the result of a zim.asset('somesound').play() for the input");else{if(r.playbackResource)var g=r.playbackResource,p=h.createMediaElementSource(g);else g=r,p=h.createMediaElementSource(g);var m;z(p)}function z(e){if(e.connect(f),"mic"!=r&&f.connect(h.destination),f.fftSize=2*Je.SoundWave.bufferLength,(m=Math.floor(a*Je.SoundWave.bufferLength/_num))<1)zog("ZIM SoundWave: include param is too small or num param is too big");else{var t=f.frequencyBinCount,i=new Uint8Array(t);u.calculate=function(){f.getByteFrequencyData(i);var e=i.map(s);if(1==m)return e;for(var t=[],o=0,n=0;n<=a*Je.SoundWave.bufferLength;n++)o+=e[n],0!=n&&n%m==0&&(t.push(Math.max(0,(o/m-u.baseline)*u.magnify-u.reduce)),o=0);return"mic"!=r&&(t[0]*=.75,t[1]*=.85,t[2]*=.9,t[t.length-2]*=.8,t[t.length-1]*=.75),t[t.length-1]*=1.3,t[t.length-2]*=1.2,t[t.length-3]*=1.1,t},setTimeout(function(){u.dispatchEvent("ready")},50)}}},Je.extend(Je.SoundWave,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.Portal=function(t,o){var e;if(e=zob(Je.Portal,arguments,"obj, lands",this))return e;if(z_d("69.96"),!zot(t)&&t.stage){var n=this,i=o&&o.numChildren&&0<o.numChildren;if(i){var r=o.getChildAt(o.numChildren-1),a=o.getChildAt(o.numChildren-2);o.setChildIndex(a,o.numChildren-1),a.setMask(t)}t.on(mobile()?"mousedown":"mouseover",function(){n._enabled&&(i&&s(),n.dispatchEvent("enter"))}),t.on(mobile()?"pressup":"mouseout",function(){n._enabled&&n.dispatchEvent("exit")}),Object.defineProperty(this,"portal",{get:function(){return t},set:function(e){!zot(e)&&e.stage||!zon?a.setMask(t):zog("zim.Portal() - please provide a Display Object to act as the portal")}}),Object.defineProperty(this,"currentLand",{get:function(){return r},set:function(e){if(o.contains(e))for(;e!=r;)s()}}),Object.defineProperty(this,"nextLand",{get:function(){return a},set:function(e){zon&&zog("zim.Portal() - nextLand is read only - remake Portal to change")}}),this._enabled=!0,Object.defineProperty(n,"enabled",{get:function(){return n._enabled},set:function(e){n._enabled=e}}),this.dispose=function(){}}function s(){o.setChildIndex(r,0),r=a,a=o.getChildAt(o.numChildren-2),o.setChildIndex(a,o.numChildren-1),r.setMask(null),a.setMask(t),t.stage.update()}},Je.extend(Je.Portal,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.VR=function(o,n,i,r,a,e,s,t,l,c,d,u){var h;if(h=zob(Je.VR,arguments,"content, angle, distance, parallax, parallaxAngle, damp, parallaxDamp, startAngle, negativeParallax, boundaryMarkers, swiper, holder",this))return h;if(z_d("69.98"),this.type="VR",zimDefaultFrame){var f=zimDefaultFrame;if(zot(u)||!u.getBounds||!u.getBounds().width)u=f.stage;zot(n)&&(n=0),zot(i)&&(i=100),zot(e)&&(e=.5),zot(r)&&(r=0),zot(a)&&(a=60),zot(s)&&(s=.1),zot(t)&&(t=0),zot(l)&&(l=!1),zot(c)&&(c=!0),zot(d)&&(d=!0),this.angle=n,this.currentAngle=t,Je.mobile()&&(d=!1);var g=this,p=u.width,m=u.height;g.zimContainer_constructor();var z=g.left=new Je.Container(p/2,m),v=new Je.Rectangle(p/2,m,"rgba(0,0,0,.01)");z.addChild(v);var b=g.right=z.clone();g.addChild(z,b),b.x=p/2;var y=g.contentLeft=g.content=o,w=g.contentRight=o.clone();if(0!=t)var x=setTimeout(V,100);else V();var C=[],T=[];if(H(y,w),U(C,"left"),U(T,"right"),0!=n&&0!=i){var k=new Je.Damp(180+t,e);k.immediate(180+t);var A=!1,E=!1;function M(e){g.currentAngle=e;var t=-g.currentAngle*i/n;if(g.contentLeft.x=t,g.contentRight.x=t,Math.round(g.currentAngle)<=-n/2&&!A)(o=new createjs.Event("boundaryout")).boundary="left",A=!0,g.dispatchEvent(o);else if(Math.round(g.currentAngle)>=n/2&&!E){(o=new createjs.Event("boundaryout")).boundary="right",E=!0,g.dispatchEvent(o)}else if(Math.round(g.currentAngle)>-n/2&&Math.round(g.currentAngle)<n/2){var o=new createjs.Event("boundaryin");A?(o.boundary="left",g.dispatchEvent(o),A=!1):E&&(o.boundary="right",g.dispatchEvent(o),E=!1)}}function I(e){var t=e.parent.localToLocal(e.vrStartX,0,u),o=e.vrParallaxDamp.convert("left"==e.vrChannel?g.contentLeft.x+t.x-p/4:g.contentRight.x+t.x-p/2-p/4);e.depth<=0&&!l&&(o=0),e.vrParallaxDistance=Math.max(-i/n*a/2,Math.min(i/n*a/2,o)),e.dep(e.depth)}f.on("deviceorientation",function(e){M(k.convert((180<e.rotation.z?-180:180)+e.rotation.z+t)-180)}),Je.Ticker.always()}if(0!=r&&0!=i){var S=new ProportionDamp(180-a/2,180+a/2,-a/2,a/2,s);if(S.immediate(180),0==n)function j(e,t){e.vrParallaxDistance=e.depth<=0&&!l?0:t,e.dep(e.depth)}function B(t){0!=n&&0!=i?(loop(C,I),loop(T,I)):(loop(C,function(e){j(e,t)}),loop(T,function(e){j(e,t)}))}f.on("deviceorientation",function(e){var t=0;0==n&&0!=r&&0!=i&&(t=S.convert((180<e.rotation.z?-180:180)+e.rotation.z)),B(t)}),Je.Ticker.always()}!d||0==i||0==n&&0==r||g.added(function(){var e={swipeAngle:0};g.swiper=new Je.Swiper({swipeOn:g,target:e,property:"swipeAngle",sensitivity:.2,damp:.05,factor:-1,min:-330,max:330});Ticker.add(function(){0!=n&&0!=i&&M(e.swipeAngle),0!=r&&0!=i&&B(S.convert(e.swipeAngle+180))})});var O=localStorage&&localStorage.zimEyeAdjust?Number(localStorage.zimEyeAdjust):0,P=O,D=!1;y.startRegX=y.regX,w.startRegX=w.regX;var L=this.adjuster=new Je.Container(800,300),Y=(v=L.backing=new Je.Rectangle(L.width,L.height,f.lighter).center(L).alp(1).sha("rgba(0,0,0,.2)",0,0,30),L.strip=new Je.Rectangle(L.width,L.height/3,f.white).center(L).alp(1),L.label=new Je.Label({text:"slide to adjust center of left and right",size:28,color:f.dark,align:"center",valign:"center"}).center(L).pos(null,50),L.close=new Je.Rectangle(50,50,f.light).addTo(L).mov(L.width-70,26)),X=new Je.Shape(-40,-40,80,80);X.graphics.f(f.dark).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),X.center(Y).sca(.3),Y.cursor="pointer",Y.on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){g.hideAdjuster(),F.currentValue=(F.max-F.min)/2+P,g.dispatchEvent("closed")});var _=new Je.Circle(30,f.dark).center(L).pos(L.width/4);_.shape.alpha=.2,new Je.Circle(12,f.dark).center(_);var R=new Je.Circle(30,f.dark).center(L).pos(L.width/4*3);R.shape.alpha=.2,new Je.Circle(12,f.dark).center(R);var F=L.slider=new Je.Slider({min:0,max:30,step:1,useTicks:!0}).centerReg(L).pos(null,L.height-40);F.currentValue=(F.max-F.min)/2+O;var W=new Je.Proportion(F.min,F.max,_.x-L.width/4,_.x+L.width/4,-1),N=new Je.Proportion(F.min,F.max,R.x-L.width/4,R.x+L.width/4);F.on("change",function(){_.x=W.convert(F.currentValue),R.x=N.convert(F.currentValue)}),new Je.Label("closer",24,null,f.silver).centerReg(L).pos(F.x-220,F.y),new Je.Label("farther",24,null,f.silver).centerReg(L).pos(F.x+220,F.y),(g.ok=new Je.Button({label:"OK",width:90,height:60,corner:0,color:f.blue,rollColor:f.green,shadowColor:-1}).centerReg(L).sca(.8).pos(L.width-58,F.y)).on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){localStorage&&(localStorage.zimEyeAdjust=F.currentValue-(F.max-F.min)/2),Z(),g.hideAdjuster(),g.dispatchEvent("saved"),g.dispatchEvent("closed")}),(g.zero=new Je.Button({label:">|<",width:90,height:60,corner:0,color:f.yellow,rollColor:f.green,shadowColor:-1}).centerReg(L).sca(.8).pos(58,F.y)).on((zns?"mousedown"==Je.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){F.currentValue=(F.max-F.min)/2,_.x=W.convert(F.currentValue),R.x=N.convert(F.currentValue)});var G=new Proportion(0,30,-u.width/4,u.width/4);Z(),this.showAdjuster=function(){if(D)return g;D=!0,_.x=W.convert(F.currentValue),R.x=N.convert(F.currentValue),P=F.currentValue-(F.max-F.min)/2,L.scaleTo(u).center(this),u.stage.update()},this.hideAdjuster=function(){if(!D)return g;D=!1,L.removeFrom(this),u.stage.update()},this.position=function(e,t,o){function n(e){e.vrStartX=t,e.vrParallaxDamp&&e.vrParallaxDamp.immediate(t),e.mov(t,o)}return n(e),n(e.vrMatch),e},this.register=function(e){if(!e.parent||!e.parent.vrMatch)return zon&&zog("ZIM VR() - please only register objects already inside content container"),e;var t=[],o=[];return H(e,e.clone().addTo(e.parent.vrMatch),t,o),U(t,"left"),U(o,"right"),e},0!=n&&0!=i&&c&&(g.boundaryRight=new Container,new Circle(24,f.light).addTo(g.boundaryRight).dep(-2),new Triangle(16,16,16,f.yellow,f.grey,null,null,-3).rot(-90).center(g.boundaryRight).dep(-6),g.boundaryRight.center(o).mov(i/2+24),g.boundaryLeft=new Container,new Circle(24,f.light).addTo(g.boundaryLeft).dep(-2),new Triangle(16,16,16,f.yellow,f.grey,null,null,-3).rot(90).center(g.boundaryLeft).dep(-6),g.boundaryLeft.center(o).mov(-i/2-24),g.register(g.boundaryRight),g.register(g.boundaryLeft)),this.remove=function(e){return loop(arguments,function(e,t){o.contains(t)&&(!function t(e){var o=C.indexOf(e);0<=C.indexOf(e)&&(C.splice(o,1),T.splice(o,1)),loop(e,function(e){t(e)})}(t),t.parent.removeChild(t),t.vrMatch.parent.removeChild(t.vrMatch))}),g},this.resize=function(){p=u.width,m=u.height,z.getChildAt(0).widthOnly=b.getChildAt(0).widthOnly=p/2,z.getChildAt(0).heightOnly=b.getChildAt(0).heightOnly=m,b.x=p/2,z.setBounds(0,0,p/2,m),b.setBounds(0,0,p/2,m),0!=t?(clearTimeout(x),x=setTimeout(V,100)):V(),L.scaleTo(u).center(this,null,!1)}}else zon&&zog("zim.VR() - please use ZIM Frame");function V(){y.addTo(z,null,!1).setMask(z.getChildAt(0)).pos(null,(u.height-y.height)/2),w.addTo(b,null,!1).setMask(b.getChildAt(0)).pos(null,(u.height-y.height)/2)}function H(e,o,n,i){((e.vrMatch=o).vrMatch=e).cacheCanvas&&o.cache(),e.dep&&!zot(e.depth)&&(C.push(e),T.push(o),zot(n)||n.push(e),zot(i)||i.push(o),o.dep(e.depth)),loop(e,function(e,t){H(e,o.getChildAt(t),n,i)})}function U(e,t){loop(e,function(e){e.vrChannel=t,e.vrStartX=e.x,0!=n&&0!=i&&(e.vrAngle=n,e.vrDistance=i),0!=r&&0!=i&&(e.vrParallax=r/100,(e.vrParallaxDistance=0)!=n&&(e.vrParallaxDamp=new Je.Damp(0,s))),e.dep(e.depth)})}function Z(){var e=G.convert(F.currentValue);y.regX=y.startRegX+e,w.regX=w.startRegX-e}},Je.extend(Je.VR,Je.Container,"clone","zimContainer",!1),zon&&zog("ZIM FRAME"),Je.Frame=function(r,t,o,n,i,a,s,l,e,c,d,u,h,f,g,p,m,z,v,b,y,w,x,C){var T;if(T=zob(Je.Frame,arguments,"scaling, width, height, color, outerColor, assets, path, progress, rollover, touch, scrollTop, align, valign, canvasID, rollPerSecond, delay, canvasCheck, gpu, gpuObj, nextFrame, nextStage, allowDefault, loadFailObj, sensors",this))return T;z_d("83"),this.cjsEventDispatcher_constructor();var X=this;if("undefined"==typeof zimDefaultFrame&&(zimDefaultFrame=this),zot(m)&&(m=!0),!!window.HTMLCanvasElement||!m){var k=Je.mobile();zot(r)&&(r="full"),zot(e)&&(e=!k),zot(c)&&(c=!0),zot(d)&&(d=!0),zot(u)&&(u="center"),zot(h)&&(h="center");var A="";zot(f)&&(zimDefaultFrame!=this?(A=Je.makeID(5),f="myCanvas"+A):f="myCanvas"),zot(g)&&(g=20),zot(p)&&(p=0),zot(z)&&(z=!1),zot(w)&&(w=!1),zot(x)&&(x="circles"),this.loadFailObj=x,zot(C)&&(C=!1);var _,E=!1,M=["fit","outside","full"];this.scale=1,this.x=0,this.y=0;var I,S,j,B,O,P=t,D=o,L=!1,Y=!1;"interactive"===document.readyState||"complete"===document.readyState?setTimeout(function(){U()},200):document.addEventListener("DOMContentLoaded",U);var R,F=!1,W="full"==r&&"undefined"!=typeof InstallTrigger;window.addEventListener("resize",function(){W?F||(F=!0,O=Je.Ticker.update,Je.Ticker.update=!1,setTimeout(function(){F=!1,_==zimDefaultFrame.stage&&(Je.Ticker.update=O)},40),setTimeout(function(){Q(),$()},20)):(Q(),$(),0<p&&k&&setTimeout(function(){Q(),$()},p))}),this.loadAssets=function(e,s,t,o,n,i,r,a,l,c){if(!zot(e)){if(zot(e.src)){var d;if(d=zob(X.loadAssets,arguments,"assets, path, progress, xhr, time, loadTimeout, outputAudioSprite, crossOrigin, fileType, queueOnly"))return d}if(!zot(t)&&"ProgressBar"==t.type&&zot(o)&&(o=!0),Array.isArray(e)||(e=[e]),0!=e.length){zot(n)&&(n=0),zot(i)&&(i=8e3),zot(r)&&(r=!1),zot(a)&&(a="anonymous"),zot(c)&&(c=!1);var u,h,f,g=!1,p=[],m=/\.([^.]+)$/i,z=[],v=[],b=0,y=!0;for(S=0;S<e.length;S++){if((u=e[S]).constructor=={}.constructor)if(u.audioSprite){D(u=(C=Je.copy(u)).src);var w,x=[];for(f=0;f<C.audioSprite.length;f++)w=C.audioSprite[f],x.push({id:w[0],startTime:Math.round(1e3*w[1]),duration:Math.round(1e3*(w[2]-w[1]))});delete C.audioSprite,C.data={audioSprite:x},r&&zog(JSON.stringify(C)),p.push(C)}else if(u.data&&u.data.audioSprite){var C;D(u=(C=Je.copy(u)).src),p.push(C)}else if(u.id){X.assetIDs[u.id]=u.src,D(u=u.src);var T={src:u,loadTimeout:i};zot(l)||(T.type=l),p.push(T)}else u.src.match(/fonts\.googleapis\.com/)?v.push(u):z.push(u);else{D(u);T={src:u,loadTimeout:i};zot(l)||(T.type=l),p.push(T)}if(g&&y){var k=document.createElement("audio");k.setAttribute("src",(zot(s)?"":s)+u),document.body.appendChild(k),y=!1}}X.loadAssetsCount++,X.isLoading=!0;var A=new Je.Queue;if(A.isLoading=!0,A.loadAssetsCount=0,!zot(t)&&t.show&&(t.zimActiveLoader=A,t.show()),0<z.length){for(var E,M,I=[],S=0;S<z.length;S++)E={src:"url("+((M=z[S]).src.match(/^http/i)?"":s||"")+M.src+")"+(M.type?" format('"+M.type+"')":""),family:M.font},M.weight&&(E.weight=M.weight),M.style&&(E.style=M.style),I.push(E);(j=new createjs.FontLoader({src:I},!0)).on("complete",L),j.on("error",L),j.load(),A.loadAssetsCount++}if(0<v.length){var j;for(S=0;S<v.length;S++)E={src:(M=v[S]).src,type:"fontcss"},A.loadAssetsCount++,(j=new createjs.FontLoader(E,!0)).on("complete",L),j.on("error",L),j.load()}var B=Date.now(),O=new createjs.Event("complete");if(0<b){A.loadAssetsCount++;var P=A.preload=X.preload=new createjs.LoadQueue(o,s,a);g&&P.installPlugin(createjs.Sound),P.on("progress",function(e){A.dispatchEvent(e),c||X.dispatchEvent(e)}),P.on("error",function(e){A.dispatchEvent(e),c||X.dispatchEvent(e)}),P.on("fileload",function(e){var t,o=e.item,n=e.item.type;o.id.match(m);if(n&&"sound"==n){var i=[];if(o.data&&o.data.audioSprite)for(var r=0;r<o.data.audioSprite.length;r++)i.push(o.data.audioSprite[r].id);else i.push(o.id);for(r=0;r<i.length;r++)!function(){var o=i[r];t=X.assets[i[r]]={type:"sound",path:s,id:o,play:function(e){var t=createjs.Sound.play(o,e);return t.getStage=function(){return _},t}}}()}else t=X.assets[o.id]="image"==n?new Je.Bitmap(e.result,e.result.width,e.result.height,o.id):e.result;var a=new createjs.Event("assetload");a.item=o,a.asset=t,A.dispatchEvent(e),c||X.dispatchEvent(a)}),X.preloadEvent=P.on("complete",function(e){O=e,A.loadAssetsCount--,0==A.loadAssetsCount&&Y()});try{P.loadManifest(p)}catch(e){}}return A}}function D(e){b++,(h=e.match(m))&&0<=createjs.Sound.SUPPORTED_EXTENSIONS.indexOf(h[1])&&(g=!0)}function L(){A.loadAssetsCount--,0==A.loadAssetsCount&&Y()}function Y(){var e=Date.now();n=Math.max(0,n-(e-B)),setTimeout(function(){X.loadAssetsCount--,X.loadAssetsCount<=0&&(X.isLoading=!1),A.isLoading=!1,A.dispatchEvent(O),c||X.dispatchEvent(O)},n)}},this.asset=function(e){if(!zot(e)){var t=X.assetIDs[e];if(t&&(e=t),X.assets[e])return X.assets[e];if("circles"==X.loadFailObj)var o=frame.makeCircles(14);else o=X.loadFailObj;return o&&(o.type="EmptyAsset",o.id=e,o.play=function(){if(zon)return zog("zim.Frame - asset("+e+") not found"),{}}),o}},Object.defineProperty(X,"stage",{get:function(){return _},set:function(e){zog("zim.Frame(): stage is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(X,"width",{get:function(){return P},set:function(e){zog("zim.Frame(): width is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(X,"height",{get:function(){return D},set:function(e){zog("zim.Frame(): height is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(this,"color",{get:function(){return n},set:function(e){zot(n=e)?zid(f).style.backgroundColor="default":!zot(zid(f).style.backgroundColor=n)&&z&&_.setClearColor(Je.convertColor(n))}}),Object.defineProperty(this,"outerColor",{get:function(){return R},set:function(e){R=e,zet("body").css({backgroundColor:R})}});var N=w;Object.defineProperty(X,"allowDefault",{get:function(){return N},set:function(e){e?(_.preventSelection=!1,document.body.style.overflow="visible",X.zil&&(window.removeEventListener("keydown",X.zil[0]),window.removeEventListener("wheel",X.zil[1]),window.removeEventListener("DOMMouseScroll",X.zil[2]),X.zil=null)):(_.preventSelection=!0,document.body.style.overflow="hidden",zot(X.zil)&&(X.zil=zil())),N=e}});var G=new createjs.Event("keydown");if(this.eventRemove=G.remove,window.addEventListener("keydown",function(e){e.remove=X.eventRemove,X.altKey=e.altKey,X.ctrlKey=e.ctrlKey,X.metaKey=e.metaKey,X.shiftKey=e.shiftKey,X.dispatchEvent(e)}),window.addEventListener("keyup",function(e){X.altKey=e.altKey,X.ctrlKey=e.ctrlKey,X.metaKey=e.metaKey,X.shiftKey=e.shiftKey,e.remove=X.eventRemove,X.dispatchEvent(e)}),C&&window.DeviceMotionEvent&&window.addEventListener("devicemotion",function(e){e.remove=X.eventRemove,X.dispatchEvent(e)}),C&&window.DeviceOrientationEvent){var V=0,H=0;window.addEventListener("deviceorientation",function(e){e.remove=X.eventRemove;var t=360-e.alpha;135<Math.abs(t-V)&&Math.abs(t-V)<225&&(H=0==H?180:0),V=t,e.rotation={x:e.beta,y:e.gamma,z:(t+H)%360},X.dispatchEvent(e)})}this.remakeCanvas=function(e,t){"full"!=r&&(zot(e)&&(e=P),zot(t)&&(t=D),zid(f)&&zid(f).parentNode.removeChild(zid(f)),P=e,D=t,K(),q())},this.dispose=function(){return window.removeEventListener("resize",Q),function e(t){t.removeAllEventListeners();if(t.numChildren)for(var o=t.numChildren-1;0<=o;o--)e(t.getChildAt(o));t.parent&&t.parent.removeChild(t)}(_),zid(f)&&zid(f).parentNode.removeChild(zid(f)),!(X=_=null)},this.orange="#f58e25",this.green="#acd241",this.pink="#e472c4",this.blue="#50c4b7",this.brown="#d1a170",this.yellow="#ebcb35",this.purple="#993399",this.red="#fb4758",this.silver="#999999",this.tin="#777777",this.grey="#555555",this.gray="#555555",this.lighter="#eeeeee",this.light="#cccccc",this.dark="#333333",this.darker="#111111",this.black="#000000",this.white="#ffffff",this.clear="rgba(0,0,0,0)",this.faint="rgba(0,0,0,.01)",this.makeCircles=function(e,t){zot(e)&&(e=100);var o=[X.orange,X.green,X.pink,X.blue,X.brown,X.dark];if(t){(i=new Je.Container).radius=e;for(var n=0;n<o.length;n++)i.addChild(new Circle(i.radius/o.length*(o.length-n),o[n]))}else{var i,r=(i=new Je.Shape).graphics;i.radius=e;for(n=0;n<o.length;n++)r.f(o[n]).dc(0,0,i.radius/o.length*(o.length-n));i.setBounds(-i.radius,-i.radius,2*i.radius,2*i.radius)}return i}}else setTimeout(function(){X.dispatchEvent("failed")},100);function U(){if(!Y){if(Y=!0,-1==M.indexOf(r)){if(zot(zid(j=r)))return void zog("zim.Frame - scaling: HTML tag with id="+r+" must exist");B=this.tag=zid(j),r=zot(t)||zot(o)?"tag":"inline",0==f.indexOf("myCanvas")&&(f=j+"Canvas")}var e;if(X.canvasID=f,zot(t)&&(t=500),zot(o)&&(o=500),zot(i)||(X.outerColor=i),K(),q(),k?(d&&setTimeout(function(){window.scrollTo(0,0)},50),setTimeout(function(){Q(),Z()},100),100<p&&setTimeout(function(){Q(),Z()},p)):Z(),X.loadAssetsCount=0,X.assets={},X.assetIDs={},zot(a))Z();else zot(e=a.constructor=={}.constructor?X.loadAssets(Je.merge(a,{progress:l,queueOnly:!0})):X.loadAssets({assets:a,path:s,progress:l,queueOnly:!0}))||!e.on?(zon&&zog("ZIM Frame - load failed"),Z()):e.on("complete",function(){Z()})}}function Z(){E?(!zot(l)&&l.show&&l.hide(),X.dispatchEvent("ready"),L=!0,$()):E=!0}function K(){var e=X.canvas=document.createElement("canvas");e.setAttribute("id",f),e.setAttribute("tabindex",0),"full"==r||"tag"==r?(e.setAttribute("width",Je.windowWidth()),e.setAttribute("height",Je.windowHeight())):(e.setAttribute("width",P),e.setAttribute("height",D)),"tag"==r||"inline"==r?B.appendChild(e):document.body.appendChild(e),zot(n)||(e.style.backgroundColor=n),"full"!=r&&"fit"!=r&&"outside"!=r||(e.style.position="absolute",w||(document.body.style.overflow="hidden"))}function q(){Q(),-1==M.indexOf(r)||w||(X.zil=zil()),_=z?new Je.StageGL(f,v):new Je.Stage(f),!zot(n)&&z&&_.setClearColor(Je.convertColor(n)),_.setBounds(0,0,P,D),_.width=P,_.height=D,e&&_.enableMouseOver(10),c&&createjs.Touch.enable(_,!1,w),w&&(_.preventSelection=!1),b&&(_.nextStage=b.stage),y&&(_.nextStage=y)}function Q(){var e,t,o=zid(f),n=Je.windowWidth(),i=Je.windowHeight();if((I=X.orientation=i<n?"horizontal":"vertical")!=S&&(S=I,X.dispatchEvent("orientation")),k&&d&&setTimeout(function(){window.scrollTo(0,0)},100),o){if("fit"==r)X.scale=P/D<=n/i?i/D:n/P;else if("outside"==r)X.scale=P/D<=n/i?n/P:i/D;else{if("full"==r)return o.style.left=o.style.top="0px",o.width=P=n,o.height=D=i,_&&(_.setBounds(0,0,P,D),_.width=P,_.height=D,z&&_.updateViewport(P,D)),void J();if("tag"==r)return P=""==B.style.width?B.getAttribute("width")||B.offsetWidth:B.style.width,D=""==B.style.height?B.getAttribute("height")||B.offsetHeight:B.style.height,_&&(_.setBounds(0,0,P,D),_.width=P,_.height=D,z&&_.updateViewport(P,D)),B.style.overflow="hidden",o.width=P,o.height=D,o.style.left=o.style.top="0px",void J();if("inline"==r)return _&&(_.setBounds(0,0,P,D),_.width=P,_.height=D,z&&_.updateViewport(P,D)),o.style.left=o.style.top="0px",void J()}t=D*X.scale,e=P*X.scale,o.style.width=e+"px",o.style.height=t+"px",X.x="left"==u?0:"right"==u?n-e:(n-e)/2,X.y="top"==h?0:"bottom"==h?i-t:(i-t)/2,o.style.left=X.x+"px",o.style.top=X.y+"px",J()}}function J(){if("outside"==r){var e=(zum(frame.canvas.style.width)-windowWidth())/2;"left"==u?(X.visibleLeft=0,X.visibleRight=windowWidth()/(windowWidth()+2*e)*P):"right"==u?(X.visibleLeft=2*e/(windowWidth()+2*e)*P,X.visibleRight=P):(X.visibleLeft=e/(windowWidth()+2*e)*P,X.visibleRight=(windowWidth()+e)/(windowWidth()+2*e)*P);var t=(zum(frame.canvas.style.height)-windowHeight())/2;"top"==h?(X.visibleTop=0,X.visibleBottom=windowHeight()/(windowHeight()+2*t)*D):"bottom"==h?(X.visibleTop=2*t/(windowHeight()+2*t)*D,X.visibleBottom=D):(X.visibleTop=t/(windowHeight()+2*t)*D,X.visibleBottom=(windowHeight()+t)/(windowHeight()+2*t)*D)}else X.visibleLeft=X.visibleTop=0,X.visibleRight=P,X.visibleBottom=D}function $(){L&&(X.dispatchEvent("resize"),Je.OPTIMIZE||!zns&&OPTIMIZE||!_||"full"!=r&&"tag"!=r||_.update())}},Je.extend(Je.Frame,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),Je.Queue=function(){this.cjsEventDispatcher_constructor(),this.isLoading=!0},Je.extend(Je.Queue,createjs.EventDispatcher,null,"cjsEventDispatcher"),DISTILL=!1,Je.distillery=[],Je.distill=function(){!window.zns&&Je&&(Je.DISTILL||window.DISTILL)&&Je.distillery.push("83.3","83.35"),zog("zim.distill() - go to http://zimjs.com/distill and enter the following:"),zog(0<Je.distillery.length?Je.distillery.join(" "):"must set zim.DISTILL = true;")},Je.parseAudioSprite=function(e,t){if(z_d("83.25"),!(zot(e)||zot(e.resources)||zot(e.spritemap))){var o,n=e.resources[0],i=e.spritemap,r=[],a={src:n,data:{}};for(s in i)o=i[s],r.push({id:s,startTime:Math.round(1e3*o.start),duration:Math.round(1e3*(o.end-o.start))});return a.data.audioSprite=r,t&&zog(JSON.stringify(a)),a}},Je.previewAudioSprite=function(e,t,o){if(z_d("83.26"),!zot(e)){if(zot(t)&&(t=3),zot(o)){if(zot(zimDefaultFrame))return;o=zimDefaultFrame,stage=o.stage}var n=e,i=[],r=[];if(n.constructor=={}.constructor){n.resources&&(n=Je.parseAudioSprite(n)),n.audioSprite?loop(n.audioSprite,function(e){i.push(e[0].substr(0,t)),r.push(e[0])}):n.data&&n.data.audioSprite&&loop(n.data.audioSprite,function(e){i.push(e.id.substr(0,t)),r.push(e.id)});var a=new Tabs({tabs:i,width:stageW,currentEnabled:!0}).addTo(stage);return a.on("change",function(){o.asset(r[a.selectedIndex]).play()}),a}}},Je.svgToBitmap=function(e,t){if(z_d("83.27"),XMLSerializer||!zon){var o="string"==typeof e?e:(new XMLSerializer).serializeToString(e);o.match(/xmlns/i)||(o=o.replace(/svg /i,"svg  xmlns='http://www.w3.org/2000/svg' "));var n=self.URL||self.webkitURL||self,i=new Image;i.onload=function(){var e=new Bitmap(i);t(e)},i.src=n.createObjectURL(new document.Blob([o],{type:"image/svg+xml;charset=utf-8"}))}else zog("ZIM svgToBitmap() - sorry, not supported in Browser")},Je}(zim||{}))||{});window.zns||zimplify();